{"version":3,"file":"Index-9d37b521.mjs","sources":["../../../resources/js/Repositories/ImagesRepository.js","../../../resources/js/Pages/Admin/Content/Images/Index.vue"],"sourcesContent":["export default {\n    async fetch(params) {\n        try {\n            const response = await axios.get(route('api.images.index', params));\n            return response.data;\n        } catch (error) {\n            throw new Error(error.response.data);\n        }\n    },\n    async destroy(id) {\n        try {\n            const response = await axios.delete(route('api.images.destroy', id));\n            return response.data;\n        } catch (error) {\n            throw new Error(error.response.data);\n        }\n    },\n    async update(item) {\n        try {\n            const response = await axios.put(route('api.images.update', item.id), item)\n            return response.data;\n        } catch (error) {\n            throw new Error(error.response.data);\n        }\n    },\n};\n","<script setup>\nimport Loader from '@/Components/Loader.vue';\nimport Button from '@/Components/Button.vue';\nimport Paginate from '@/Components/Paginate.vue';\nimport UploadImagesModal from '@/Components/UploadImagesModal.vue';\nimport List from '@/Pages/Admin/Content/Images/List.vue';\nimport ImageModal from '@/Pages/Admin/Content/Images/Modal.vue';\nimport ContentLayout from '@/Pages/Admin/Content/ContentLayout.vue'\nimport {swal} from \"@/Includes/swal\";\n\nimport {onMounted, inject, ref, computed} from \"vue\";\nimport ImagesRepository from \"@/Repositories/ImagesRepository\";\nimport {useI18n} from 'vue-i18n'\n\nconst can = inject('$can');\nconst {t} = useI18n();\n\nconst state = ref({\n    imagesList: [],\n    isActiveUploadModal: false,\n    isActiveImageModal: false,\n    imageUploadModal: [],\n    imageModal: {\n        id: null,\n        src: null,\n        alt: null,\n    },\n    currentPage: 1,\n    isLoading: true,\n});\n\nconst imagesUploadModal = computed(() => state.value.isActiveUploadModal ? UploadImagesModal : null);\nconst imageModal = computed(() => state.value.isActiveImageModal ? ImageModal : null);\n\nonMounted(async() => await fetch());\n\nconst modalUploadImagesFunction = () => {\n    state.value.isActiveUploadModal = !state.value.isActiveUploadModal;\n}\n\nconst modalImagesFunction = () => {\n    state.value.isActiveImageModal = !state.value.isActiveImageModal;\n}\n\nconst openImageModal = (image) => {\n    modalImagesFunction();\n    state.value.imageModal = image;\n}\n\nconst updateImage = async () => {\n    if (can('edit-images')) {\n        const {success} = await ImagesRepository.update(state.value.imageModal);\n        if (success) {\n            modalImagesFunction();\n            await swal({\n                icon: 'success',\n                title: t('swal.updated')\n            })\n        }\n    }\n}\n\nconst destroyImageFromModal = async (id) => {\n    await destroyImage(id);\n    modalImagesFunction();\n}\n\nconst destroyImage = async (id) => {\n    if (can('destroy-images')) {\n        const result = await swal({\n            title: t('swal.sure'),\n            icon: 'warning',\n            showCancelButton: true,\n        });\n\n        if (result.isConfirmed) {\n            state.value.isLoading = true;\n            const {success} = await ImagesRepository.destroy(id);\n            if (success) {\n                await fetch();\n                await swal({\n                    icon: 'success',\n                    title: t('swal.destroyed')\n                });\n            }\n            state.value.isLoading = false;\n        }\n    }\n}\n\nconst fetch = async (page) => {\n    state.value.isLoading = true;\n    if (page) {\n        state.value.currentPage = page;\n    }\n    const data = await ImagesRepository.fetch({'page': state.value.currentPage});\n    state.value.imagesList = data.success ? data.result : [];\n    state.value.isLoading = false;\n}\n</script>\n\n<template>\n    <ContentLayout :title=\"$t('images.page_title')\">\n        <template #header>{{ $t('images.page_title') }}</template>\n\n        <Loader v-if=\"state.isLoading\"/>\n\n        <div v-if=\"!state.isLoading && can('show-images')\" class=\"grid grid-cols-1 gap-4\">\n            <div>\n                <Button type=\"btn\" @click.prevent=\"modalUploadImagesFunction\"\n                        v-if=\"can('create-images')\">\n                    {{ $t('add') }}\n                </Button>\n            </div>\n\n            <List :images=\"state.imagesList\"\n                  @clickImage=\"openImageModal\"\n                  @fetch=\"fetch\"\n                  @destroyImage=\"destroyImage\"\n            />\n\n            <div class=\"text-center\">\n                <Paginate :pagination=\"state.imagesList\"\n                          :click-handler=\"fetch\"\n                          v-model=\"state.currentPage\"\n                />\n            </div>\n        </div>\n\n        <component :is=\"imageModal\"\n                   @closeModal=\"modalImagesFunction\"\n                   @submitForm=\"updateImage\"\n                   @declineForm=\"destroyImageFromModal\"\n                   :image=\"state.imageModal\"\n                   size=\"large\"\n        ></component>\n\n        <component :is=\"imagesUploadModal\"\n                   @closeModal=\"modalUploadImagesFunction\"\n                   @onUpload=\"fetch\"\n        ></component>\n    </ContentLayout>\n</template>\n"],"names":["UploadImagesModal","ImageModal"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAe,mBAAA;AAAA,EACX,MAAM,MAAM,QAAQ;AAChB,QAAI;AACA,YAAM,WAAW,MAAM,MAAM,IAAI,MAAM,oBAAoB,MAAM,CAAC;AAClE,aAAO,SAAS;AAAA,IACnB,SAAQ,OAAP;AACE,YAAM,IAAI,MAAM,MAAM,SAAS,IAAI;AAAA,IACtC;AAAA,EACJ;AAAA,EACD,MAAM,QAAQ,IAAI;AACd,QAAI;AACA,YAAM,WAAW,MAAM,MAAM,OAAO,MAAM,sBAAsB,EAAE,CAAC;AACnE,aAAO,SAAS;AAAA,IACnB,SAAQ,OAAP;AACE,YAAM,IAAI,MAAM,MAAM,SAAS,IAAI;AAAA,IACtC;AAAA,EACJ;AAAA,EACD,MAAM,OAAO,MAAM;AACf,QAAI;AACA,YAAM,WAAW,MAAM,MAAM,IAAI,MAAM,qBAAqB,KAAK,EAAE,GAAG,IAAI;AAC1E,aAAO,SAAS;AAAA,IACnB,SAAQ,OAAP;AACE,YAAM,IAAI,MAAM,MAAM,SAAS,IAAI;AAAA,IACtC;AAAA,EACJ;AACL;;;;;ACXA,UAAM,MAAM,OAAO,MAAM;AACzB,UAAM,EAAC,EAAC,IAAI;AAEZ,UAAM,QAAQ,IAAI;AAAA,MACd,YAAY,CAAE;AAAA,MACd,qBAAqB;AAAA,MACrB,oBAAoB;AAAA,MACpB,kBAAkB,CAAE;AAAA,MACpB,YAAY;AAAA,QACR,IAAI;AAAA,QACJ,KAAK;AAAA,QACL,KAAK;AAAA,MACR;AAAA,MACD,aAAa;AAAA,MACb,WAAW;AAAA,IACf,CAAC;AAED,UAAM,oBAAoB,SAAS,MAAM,MAAM,MAAM,sBAAsBA,cAAoB,IAAI;AACnG,UAAM,aAAa,SAAS,MAAM,MAAM,MAAM,qBAAqBC,cAAa,IAAI;AAEpF,cAAU,YAAW,MAAM,MAAK,CAAE;AAElC,UAAM,4BAA4B,MAAM;AACpC,YAAM,MAAM,sBAAsB,CAAC,MAAM,MAAM;AAAA,IACnD;AAEA,UAAM,sBAAsB,MAAM;AAC9B,YAAM,MAAM,qBAAqB,CAAC,MAAM,MAAM;AAAA,IAClD;AAEA,UAAM,iBAAiB,CAAC,UAAU;AAC9B;AACA,YAAM,MAAM,aAAa;AAAA,IAC7B;AAEA,UAAM,cAAc,YAAY;AAC5B,UAAI,IAAI,aAAa,GAAG;AACpB,cAAM,EAAC,QAAO,IAAI,MAAM,iBAAiB,OAAO,MAAM,MAAM,UAAU;AACtE,YAAI,SAAS;AACT;AACA,gBAAM,KAAK;AAAA,YACP,MAAM;AAAA,YACN,OAAO,EAAE,cAAc;AAAA,UACvC,CAAa;AAAA,QACJ;AAAA,MACJ;AAAA,IACL;AAEA,UAAM,wBAAwB,OAAO,OAAO;AACxC,YAAM,aAAa,EAAE;AACrB;IACJ;AAEA,UAAM,eAAe,OAAO,OAAO;AAC/B,UAAI,IAAI,gBAAgB,GAAG;AACvB,cAAM,SAAS,MAAM,KAAK;AAAA,UACtB,OAAO,EAAE,WAAW;AAAA,UACpB,MAAM;AAAA,UACN,kBAAkB;AAAA,QAC9B,CAAS;AAED,YAAI,OAAO,aAAa;AACpB,gBAAM,MAAM,YAAY;AACxB,gBAAM,EAAC,QAAO,IAAI,MAAM,iBAAiB,QAAQ,EAAE;AACnD,cAAI,SAAS;AACT,kBAAM,MAAK;AACX,kBAAM,KAAK;AAAA,cACP,MAAM;AAAA,cACN,OAAO,EAAE,gBAAgB;AAAA,YAC7C,CAAiB;AAAA,UACJ;AACD,gBAAM,MAAM,YAAY;AAAA,QAC3B;AAAA,MACJ;AAAA,IACL;AAEA,UAAM,QAAQ,OAAO,SAAS;AAC1B,YAAM,MAAM,YAAY;AACxB,UAAI,MAAM;AACN,cAAM,MAAM,cAAc;AAAA,MAC7B;AACD,YAAM,OAAO,MAAM,iBAAiB,MAAM,EAAC,QAAQ,MAAM,MAAM,YAAW,CAAC;AAC3E,YAAM,MAAM,aAAa,KAAK,UAAU,KAAK,SAAS;AACtD,YAAM,MAAM,YAAY;AAAA,IAC5B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}