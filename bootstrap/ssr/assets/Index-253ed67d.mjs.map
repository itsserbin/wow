{"version":3,"file":"Index-253ed67d.mjs","sources":["../../../resources/js/Pages/Admin/Statistics/Index.vue"],"sourcesContent":["<script setup>\nimport StatisticLayout from '@/Pages/Admin/Statistics/StatisticLayout.vue'\nimport Chart from '@/Pages/Admin/Statistics/Chart.vue'\nimport Datepicker from '@/Pages/Admin/Statistics/Datepicker.vue'\n\nimport {computed, inject, onMounted, ref} from \"vue\";\nimport {endOfMonth, startOfMonth} from \"date-fns\";\n\nconst params = ref({\n    date: [],\n    page: 1,\n});\n\nconst can = inject('$can');\nconst state = ref({\n    costs: null,\n    profits: null,\n    orders: null,\n    marketing: null,\n});\n\nonMounted(async () => {\n    params.value.date[0] = startOfMonth(new Date());\n    params.value.date[1] = endOfMonth(new Date());\n    await fetch();\n});\n\nconst getParams = computed(() => {\n    const data = {};\n    if (params.value.date.length === 2) {\n        data.date_start = params.value.date[0].toLocaleDateString();\n        data.date_end = params.value.date[1].toLocaleDateString();\n    }\n    data.page = params.value.page;\n    return data;\n});\n\nconst fetch = async () => {\n    state.value.isLoading = true;\n\n    await axios.get(route('api.statistics.costs.chart', getParams.value))\n        .then(({data}) => state.value.costs = data.result)\n        .catch((errors) => console.log(errors));\n\n    await axios.get(route('api.statistics.profits.chart', getParams.value))\n        .then(({data}) => state.value.profits = data.result)\n        .catch((response) => console.log(response))\n\n    await axios.get(route('api.statistics.orders.chart', getParams.value))\n        .then(({data}) => state.value.orders = data.result)\n        .catch((response) => console.log(response))\n\n    await axios.get(route('api.statistics.marketing.chart', getParams.value))\n        .then(({data}) => state.value.marketing = data.result)\n        .catch((response) => console.log(response))\n}\n</script>\n\n<template>\n    <StatisticLayout title=\"Статистика\">\n        <template #header>\n            Статистика\n        </template>\n\n        <div class=\"grid grid-cols-1 gap-4\">\n            <Datepicker v-model=\"params.date\" @update:modelValue=\"fetch\"/>\n\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div class=\"block\" v-if=\"can('show-bookkeeping-costs')\">\n                    <div class=\"text-lg text-gray-800 leading-tight dark:text-gray-300\">Витрати</div>\n                    <hr class=\"my-1\">\n                    <Chart v-if=\"state.costs\" :chartData=\"state.costs\"/>\n                </div>\n\n                <div class=\"div\" v-if=\"can('show-bookkeeping-profits')\">\n                    <div class=\"text-lg text-gray-800 leading-tight dark:text-gray-300\">Прибуток</div>\n                    <hr class=\"my-1\">\n                    <Chart v-if=\"state.profits\" :chartData=\"state.profits\"/>\n                </div>\n            </div>\n\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div class=\"div\" v-if=\"can('show-bookkeeping-orders')\">\n                    <div class=\"text-lg text-gray-800 leading-tight dark:text-gray-300\">Заявки</div>\n                    <hr class=\"my-1\">\n                    <Chart v-if=\"state.orders\" :chartData=\"state.orders\"/>\n                </div>\n\n                <div class=\"div\" v-if=\"can('show-bookkeeping-marketing')\">\n                    <div class=\"text-lg text-gray-800 leading-tight dark:text-gray-300\">Маркетинг</div>\n                    <hr class=\"my-1\">\n                    <Chart v-if=\"state.marketing\" :chartData=\"state.marketing\"/>\n                </div>\n            </div>\n        </div>\n    </StatisticLayout>\n</template>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAQA,UAAM,SAAS,IAAI;AAAA,MACf,MAAM,CAAE;AAAA,MACR,MAAM;AAAA,IACV,CAAC;AAED,UAAM,MAAM,OAAO,MAAM;AACzB,UAAM,QAAQ,IAAI;AAAA,MACd,OAAO;AAAA,MACP,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,WAAW;AAAA,IACf,CAAC;AAED,cAAU,YAAY;AAClB,aAAO,MAAM,KAAK,CAAC,IAAI,aAAa,oBAAI,KAAI,CAAE;AAC9C,aAAO,MAAM,KAAK,CAAC,IAAI,WAAW,oBAAI,KAAI,CAAE;AAC5C,YAAM,MAAK;AAAA,IACf,CAAC;AAED,UAAM,YAAY,SAAS,MAAM;AAC7B,YAAM,OAAO,CAAA;AACb,UAAI,OAAO,MAAM,KAAK,WAAW,GAAG;AAChC,aAAK,aAAa,OAAO,MAAM,KAAK,CAAC,EAAE;AACvC,aAAK,WAAW,OAAO,MAAM,KAAK,CAAC,EAAE;MACxC;AACD,WAAK,OAAO,OAAO,MAAM;AACzB,aAAO;AAAA,IACX,CAAC;AAED,UAAM,QAAQ,YAAY;AACtB,YAAM,MAAM,YAAY;AAExB,YAAM,MAAM,IAAI,MAAM,8BAA8B,UAAU,KAAK,CAAC,EAC/D,KAAK,CAAC,EAAC,KAAI,MAAM,MAAM,MAAM,QAAQ,KAAK,MAAM,EAChD,MAAM,CAAC,WAAW,QAAQ,IAAI,MAAM,CAAC;AAE1C,YAAM,MAAM,IAAI,MAAM,gCAAgC,UAAU,KAAK,CAAC,EACjE,KAAK,CAAC,EAAC,KAAI,MAAM,MAAM,MAAM,UAAU,KAAK,MAAM,EAClD,MAAM,CAAC,aAAa,QAAQ,IAAI,QAAQ,CAAC;AAE9C,YAAM,MAAM,IAAI,MAAM,+BAA+B,UAAU,KAAK,CAAC,EAChE,KAAK,CAAC,EAAC,KAAI,MAAM,MAAM,MAAM,SAAS,KAAK,MAAM,EACjD,MAAM,CAAC,aAAa,QAAQ,IAAI,QAAQ,CAAC;AAE9C,YAAM,MAAM,IAAI,MAAM,kCAAkC,UAAU,KAAK,CAAC,EACnE,KAAK,CAAC,EAAC,KAAI,MAAM,MAAM,MAAM,YAAY,KAAK,MAAM,EACpD,MAAM,CAAC,aAAa,QAAQ,IAAI,QAAQ,CAAC;AAAA,IAClD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}