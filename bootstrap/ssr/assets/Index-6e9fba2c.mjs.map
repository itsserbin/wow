{"version":3,"file":"Index-6e9fba2c.mjs","sources":["../../../resources/js/Pages/Admin/Statistics/CostCategories/Index.vue"],"sourcesContent":["<script setup>\nimport {reactive, onMounted, inject, ref, computed} from \"vue\";\nimport {swal} from \"@/Includes/swal\";\n\nimport Paginate from '@/Components/Paginate.vue';\nimport Loader from '@/Components/Loader.vue';\nimport Button from '@/Components/Button.vue';\nimport Table from '@/Components/Table.vue';\nimport XCircle from '@/Components/Icons/XCircle.vue';\nimport CostCategoryModal from '@/Pages/Admin/Statistics/CostCategories/Modal.vue';\nimport StatisticLayout from '@/Pages/Admin/Statistics/StatisticLayout.vue'\n\nconst can = inject('$can');\n\nconst item = ({\n    title: null,\n    slug: null,\n    code: null,\n})\n\nconst state = ref({\n    categories: [],\n    isLoading: true,\n    isActiveModal: false,\n    modalAction: '',\n    item: {},\n    currentPage: 1,\n\n});\n\nonMounted(async () => await fetch());\n\nconst activeModal = computed(() => state.value.isActiveModal ? CostCategoryModal : null)\n\nconst headings = reactive([\n    {\n        label: 'ID',\n        key: 'id'\n    },\n    {\n        label: 'Код ',\n        key: 'code'\n    },\n    {\n        label: 'Назва',\n        key: 'title'\n    },\n    {\n        label: 'Slug',\n        key: 'slug'\n    },\n    {\n        label: \"Оновлено<hr class='my-1'>Створено\",\n        key: 'timestamps'\n    },\n    {\n        label: '#',\n        key: 'actions'\n    }\n]);\n\nconst fetch = async (page) => {\n    state.value.isLoading = true;\n    if (page) {\n        state.value.currentPage = page;\n    }\n    await axios.get(route('api.statistics.costs.categories.index', {\n        page: state.value.currentPage\n    }))\n        .then(({data}) => {\n            state.value.categories = data.result\n            state.value.isLoading = false;\n        })\n        .catch((response) => {\n            console.log(response);\n            state.value.isLoading = false;\n        })\n\n}\n\nfunction onDestroy(id) {\n    if (can('show-bookkeeping-costs')) {\n        swal({\n            title: 'Видалити?',\n            icon: 'warning',\n            showCancelButton: true,\n        }).then((result) => {\n            if (result.isConfirmed) {\n                axios.delete(route('api.statistics.costs.categories.destroy', id))\n                    .then(() => {\n                        fetch();\n                        if (state.value.isActiveModal) {\n                            modalFunction();\n                        }\n                        swal({\n                            icon: 'success',\n                            title: 'Destroyed!'\n                        })\n                    })\n                    .catch(errors => {\n                        console.log(errors);\n                        swal({\n                            icon: 'error',\n                            title: 'Error!'\n                        })\n                    })\n            }\n        })\n\n    }\n}\n\nfunction modalFunction() {\n    state.value.isActiveModal = !state.value.isActiveModal;\n}\n\nfunction onEdit(id, i) {\n    axios.get(route('api.statistics.costs.categories.edit', id))\n        .then(({data}) => {\n            state.value.item = data.result;\n            state.value.modalAction = 'edit';\n            state.value.item.index = i;\n            modalFunction();\n        })\n        .catch((response) => console.log(response))\n}\n\nfunction onUpdate() {\n    axios.put(route('api.statistics.costs.categories.update', state.value.item.id), state.value.item)\n        .then(() => {\n            modalFunction();\n            fetch();\n            swal({\n                title: 'Success!',\n                icon: 'success'\n            })\n        })\n        .catch((response) => {\n            console.log(response);\n            swal({\n                title: 'Error!',\n                icon: 'error'\n            })\n        })\n}\n\nfunction onCreate() {\n    axios.post(route('api.statistics.costs.categories.create'), state.value.item)\n        .then(() => {\n            modalFunction();\n            state.value.item = item;\n            fetch();\n            swal({\n                title: 'Success!',\n                icon: 'success'\n            })\n        })\n        .catch((response) => {\n            console.log(response);\n            swal({\n                title: 'Error!',\n                icon: 'error'\n            })\n        })\n}\n\nfunction submitForm() {\n    if (state.value.modalAction === 'edit') {\n        onUpdate();\n    } else if (state.value.modalAction === 'create') {\n        onCreate();\n    }\n}\n\nfunction create() {\n    Object.assign(state.value.item, item);\n    state.value.modalAction = 'create';\n    modalFunction();\n}\n</script>\n\n<template>\n    <StatisticLayout title=\"Категорії витрат\">\n        <template #header>\n            Категорії витрат\n        </template>\n\n        <Loader v-if=\"state.isLoading\"/>\n        <div v-if=\"!state.isLoading && can('show-bookkeeping-costs')\">\n            <Button type=\"btn\" @click=\"create\">\n                Додати\n            </Button>\n\n            <Table :headings=\"headings\"\n                   :rows=\"state.categories.data\"\n                   :isSlotMode=\"true\"\n            >\n                <template #id=\"{data}\">\n                    <a href=\"javascript:\" @click=\"onEdit(data.row.id,data.i)\">\n                        {{ data.row.id }}\n                    </a>\n                </template>\n\n                <template #timestamps=\"{data}\">\n                    {{ $filters.dateFormat(data.row.updated_at) }}\n                    <hr class=\"my-1\">\n                    {{ $filters.dateFormat(data.row.created_at) }}\n                </template>\n\n                <template #actions=\"{data}\">\n                    <a href=\"javascript:\" @click=\"onDestroy(data.row.id)\">\n                        <XCircle/>\n                    </a>\n                </template>\n            </Table>\n\n            <Paginate :pagination=\"state.categories\"\n                      :click-handler=\"fetch\"\n                      v-model=\"state.currentPage\"\n            />\n\n            <component :is=\"activeModal\"\n                       :item=\"state.item\"\n                       @closeModal=\"modalFunction\"\n                       @submitForm=\"submitForm\"\n                       @declineForm=\"onDestroy\"\n            ></component>\n        </div>\n    </StatisticLayout>\n</template>\n"],"names":["CostCategoryModal"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAYA,UAAM,MAAM,OAAO,MAAM;AAEzB,UAAM,OAAQ;AAAA,MACV,OAAO;AAAA,MACP,MAAM;AAAA,MACN,MAAM;AAAA,IACV;AAEA,UAAM,QAAQ,IAAI;AAAA,MACd,YAAY,CAAE;AAAA,MACd,WAAW;AAAA,MACX,eAAe;AAAA,MACf,aAAa;AAAA,MACb,MAAM,CAAE;AAAA,MACR,aAAa;AAAA,IAEjB,CAAC;AAED,cAAU,YAAY,MAAM,MAAK,CAAE;AAEnC,UAAM,cAAc,SAAS,MAAM,MAAM,MAAM,gBAAgBA,cAAoB,IAAI;AAEvF,UAAM,WAAW,SAAS;AAAA,MACtB;AAAA,QACI,OAAO;AAAA,QACP,KAAK;AAAA,MACR;AAAA,MACD;AAAA,QACI,OAAO;AAAA,QACP,KAAK;AAAA,MACR;AAAA,MACD;AAAA,QACI,OAAO;AAAA,QACP,KAAK;AAAA,MACR;AAAA,MACD;AAAA,QACI,OAAO;AAAA,QACP,KAAK;AAAA,MACR;AAAA,MACD;AAAA,QACI,OAAO;AAAA,QACP,KAAK;AAAA,MACR;AAAA,MACD;AAAA,QACI,OAAO;AAAA,QACP,KAAK;AAAA,MACR;AAAA,IACL,CAAC;AAED,UAAM,QAAQ,OAAO,SAAS;AAC1B,YAAM,MAAM,YAAY;AACxB,UAAI,MAAM;AACN,cAAM,MAAM,cAAc;AAAA,MAC7B;AACD,YAAM,MAAM,IAAI,MAAM,yCAAyC;AAAA,QAC3D,MAAM,MAAM,MAAM;AAAA,MAC1B,CAAK,CAAC,EACG,KAAK,CAAC,EAAC,KAAI,MAAM;AACd,cAAM,MAAM,aAAa,KAAK;AAC9B,cAAM,MAAM,YAAY;AAAA,MACpC,CAAS,EACA,MAAM,CAAC,aAAa;AACjB,gBAAQ,IAAI,QAAQ;AACpB,cAAM,MAAM,YAAY;AAAA,MACpC,CAAS;AAAA,IAET;AAEA,aAAS,UAAU,IAAI;AACnB,UAAI,IAAI,wBAAwB,GAAG;AAC/B,aAAK;AAAA,UACD,OAAO;AAAA,UACP,MAAM;AAAA,UACN,kBAAkB;AAAA,QAC9B,CAAS,EAAE,KAAK,CAAC,WAAW;AAChB,cAAI,OAAO,aAAa;AACpB,kBAAM,OAAO,MAAM,2CAA2C,EAAE,CAAC,EAC5D,KAAK,MAAM;AACR;AACA,kBAAI,MAAM,MAAM,eAAe;AAC3B;cACH;AACD,mBAAK;AAAA,gBACD,MAAM;AAAA,gBACN,OAAO;AAAA,cACnC,CAAyB;AAAA,YACzB,CAAqB,EACA,MAAM,YAAU;AACb,sBAAQ,IAAI,MAAM;AAClB,mBAAK;AAAA,gBACD,MAAM;AAAA,gBACN,OAAO;AAAA,cACnC,CAAyB;AAAA,YACzB,CAAqB;AAAA,UACR;AAAA,QACb,CAAS;AAAA,MAEJ;AAAA,IACL;AAEA,aAAS,gBAAgB;AACrB,YAAM,MAAM,gBAAgB,CAAC,MAAM,MAAM;AAAA,IAC7C;AAEA,aAAS,OAAO,IAAI,GAAG;AACnB,YAAM,IAAI,MAAM,wCAAwC,EAAE,CAAC,EACtD,KAAK,CAAC,EAAC,KAAI,MAAM;AACd,cAAM,MAAM,OAAO,KAAK;AACxB,cAAM,MAAM,cAAc;AAC1B,cAAM,MAAM,KAAK,QAAQ;AACzB;MACZ,CAAS,EACA,MAAM,CAAC,aAAa,QAAQ,IAAI,QAAQ,CAAC;AAAA,IAClD;AAEA,aAAS,WAAW;AAChB,YAAM,IAAI,MAAM,0CAA0C,MAAM,MAAM,KAAK,EAAE,GAAG,MAAM,MAAM,IAAI,EAC3F,KAAK,MAAM;AACR;AACA;AACA,aAAK;AAAA,UACD,OAAO;AAAA,UACP,MAAM;AAAA,QACtB,CAAa;AAAA,MACb,CAAS,EACA,MAAM,CAAC,aAAa;AACjB,gBAAQ,IAAI,QAAQ;AACpB,aAAK;AAAA,UACD,OAAO;AAAA,UACP,MAAM;AAAA,QACtB,CAAa;AAAA,MACb,CAAS;AAAA,IACT;AAEA,aAAS,WAAW;AAChB,YAAM,KAAK,MAAM,wCAAwC,GAAG,MAAM,MAAM,IAAI,EACvE,KAAK,MAAM;AACR;AACA,cAAM,MAAM,OAAO;AACnB;AACA,aAAK;AAAA,UACD,OAAO;AAAA,UACP,MAAM;AAAA,QACtB,CAAa;AAAA,MACb,CAAS,EACA,MAAM,CAAC,aAAa;AACjB,gBAAQ,IAAI,QAAQ;AACpB,aAAK;AAAA,UACD,OAAO;AAAA,UACP,MAAM;AAAA,QACtB,CAAa;AAAA,MACb,CAAS;AAAA,IACT;AAEA,aAAS,aAAa;AAClB,UAAI,MAAM,MAAM,gBAAgB,QAAQ;AACpC;MACH,WAAU,MAAM,MAAM,gBAAgB,UAAU;AAC7C;MACH;AAAA,IACL;AAEA,aAAS,SAAS;AACd,aAAO,OAAO,MAAM,MAAM,MAAM,IAAI;AACpC,YAAM,MAAM,cAAc;AAC1B;IACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}