{"version":3,"file":"AddToCart-c4dcb8d4.mjs","sources":["../../../resources/js/Pages/Public/Product/AddToCart.vue"],"sourcesContent":["<script setup>\nimport {ref} from \"vue\";\nimport {useStore} from \"vuex\";\nimport BuyIn1Click from '@/Pages/Public/Product/BuyIn1ClickModal.vue';\nimport {useGtm} from \"@gtm-support/vue-gtm\";\nimport Button from '@/Pages/Public/Components/Button.vue'\nimport {swal} from '@/Includes/swal';\nimport eventTracking from \"@/Includes/eventTracking\";\n\nconst gtm = useGtm();\nconst store = useStore();\n\nconst props = defineProps([\n    'product',\n    'eventIdAddToCard',\n    'eventIdPurchaseIn1Click',\n]);\n\n\nconst item = ref({\n    count: 1,\n    size: [],\n    color: [],\n    item_id: props.product.id,\n    // src: route(route().current(), route().params),\n    src: typeof window !== 'undefined' ? window.location.href : null,\n    event_id: props.eventIdAddToCard\n});\n\n\nconst state = ref({\n    product: {\n        id: null,\n        discount_price: null,\n        price: null,\n        h1: null,\n        sizes: [],\n        colors: [],\n    },\n    isActiveBuyIn1ClickModal: false,\n    isAddToCart: false,\n})\n\nfunction showBuyIn1ClickModal() {\n    state.value.isActiveBuyIn1ClickModal = !state.value.isActiveBuyIn1ClickModal;\n}\n\nfunction addToCart() {\n    if (!state.value.isAddToCart) {\n        axios.post(route('api.v1.cart.add', item.value))\n            .then(() => {\n                state.value.isAddToCart = true;\n                if (import.meta.env.MODE === 'production') {\n                    try {\n                        eventTracking(\n                            'AddToCart',\n                            {\n                                \"value\": props.product.discount_price ? props.product.discount_price : props.product.price,\n                                \"currency\": \"UAH\",\n                                \"content_type\": \"product\",\n                                \"content_ids\": [item.value.item_id],\n                                \"content_name\": props.product.h1\n                            },\n                            item.value.event_id\n                        );\n\n                        gtm.trackEvent({\n                            event: 'add_product_to_cart',\n                            ecommerce: {\n                                items: [{\n                                    item_name: props.product.h1,\n                                    item_id: item.value.item_id,\n                                    price: props.product.discount_price ? props.product.discount_price : props.product.price,\n                                    quantity: 1\n                                }]\n                            }\n                        });\n                    } catch (e) {\n                        console.log(e);\n                    }\n                }\n                store.commit('loadCart');\n                swal({\n                    icon: 'success',\n                    title: 'Товар додано до вашого кошика!',\n                    text: 'Ви можете оформити замовлення або продовжити покупки :)',\n                    showCancelButton: true,\n                    confirmButtonText: 'Оформити замовлення',\n                    cancelButtonText: 'Продовжити покупки',\n\n                }).then((result) => {\n                    if (result.isConfirmed && typeof window !== 'undefined') {\n                        window.location.href = route('checkout');\n                    }\n                })\n\n            })\n            .catch(() => {\n                swal({\n                    icon: 'error',\n                    title: 'Виникла помилка',\n                    text: 'Перевірте корректність данних'\n                })\n            });\n    }\n}\n</script>\n\n<template>\n    <div class=\"pt-[5%]\">\n        <hr class=\"mb-4\">\n        <div class=\"grid grid-cols-1 md:grid-cols-2 font-subheading\">\n            <div class=\"mb-4 mb-md-0 flex items-center justify-evenly flex-col\">\n                <div class=\"text-center\" v-if=\"product.discount_price\">\n                    <div class=\"text-lg font-medium text-[#A5A5A5] line-through\">\n                        {{ product.price }} грн.\n                    </div>\n                    <div class=\"font-bold text-[#ff0000] text-4xl\">{{ product.discount_price }} грн.</div>\n                </div>\n                <div class=\"text-center\" v-if=\"!product.discount_price\">\n                    <div class=\"text-lg font-bold font-medium text-[#A5A5A5] text-[2.5rem]\">\n                        {{ product.price }} грн.\n                    </div>\n                </div>\n            </div>\n            <div class=\"grid gap-4\">\n                <Button @click=\"addToCart\" type=\"button\">\n                    До кошика\n                </Button>\n                <Button @click=\"showBuyIn1ClickModal\" type=\"button\">\n                    Купити в 1 клік\n                </Button>\n            </div>\n        </div>\n        <hr class=\"mt-4\">\n    </div>\n    <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-5 font-subheading\">\n        <div v-if=\"product.sizes.length\">\n            <div class=\"w-full mb-2\">Доступні розміри</div>\n            <ul class=\"flex pb-[20px]\">\n                <li v-for=\"size in product.sizes\" class=\"mx-1\">\n                    <input type=\"checkbox\"\n                           :value=\"size.title\"\n                           :id=\"size.title\"\n                           class=\"hidden peer\"\n                           v-model=\"item.size\"\n                    >\n                    <label :for=\"size.title\"\n                           class=\"\n                                inline-flex\n                                justify-center\n                                items-center\n                                mx-auto\n                                text-gray-500\n                                bg-white rounded-lg border-2\n                                border-gray-200\n                                cursor-pointer\n                                peer-checked:border-blue-600\n                                hover:text-gray-600\n                                peer-checked:text-gray-600\n                                hover:bg-gray-50\n                                w-[40px]\n                                h-[40px]\n                            \"\n                    >\n                        {{ size.title }}\n                    </label>\n                </li>\n            </ul>\n        </div>\n        <div v-if=\"product.colors.length\">\n            <div class=\"w-100 mb-2\">Доступні кольори</div>\n            <div class=\"flex\">\n                <div v-for=\"color in product.colors\">\n                    <input type=\"checkbox\"\n                           :id=\"color.name\"\n                           :value=\"color.name\"\n                           class=\"hidden peer\"\n                           v-model=\"item.color\"\n                    >\n                    <label :for=\"color.name\"\n                           :style=\"'background-color:' + color.hex\"\n                           class=\"\n                                inline-flex\n                                justify-center\n                                items-center\n                                mx-auto\n                                text-black-500\n                                rounded-lg\n                                border-2\n                                border-gray-200\n                                cursor-pointer\n                                peer-checked:border-blue-600\n                                hover:text-black\n                                peer-checked:text-gray-600\n                                hover:bg-black\n                                w-[40px]\n                                h-[40px]\n                            \"\n                    >\n                    </label>\n                </div>\n            </div>\n        </div>\n    </div>\n    <BuyIn1Click v-if=\"state.isActiveBuyIn1ClickModal\"\n                 @closeModal=\"showBuyIn1ClickModal\"\n                 :item=\"item\"\n                 :product=\"product\"\n                 :cart=\"store.state.list\"\n                 :eventIdPurchaseIn1Click=\"props.eventIdPurchaseIn1Click\"\n                 :eventIdAddToCard=\"props.eventIdAddToCard\"\n                 :isAddToCart=\"state.isAddToCart\"\n    />\n</template>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AASA,UAAM,MAAM,OAAM;AAClB,UAAM,QAAQ,SAAQ;AAStB,UAAM,OAAO,IAAI;AAAA,MACb,OAAO;AAAA,MACP,MAAM,CAAE;AAAA,MACR,OAAO,CAAE;AAAA,MACT,SAAS,MAAM,QAAQ;AAAA;AAAA,MAEvB,KAAK,OAAO,WAAW,cAAc,OAAO,SAAS,OAAO;AAAA,MAC5D,UAAU,MAAM;AAAA,IACpB,CAAC;AAGD,UAAM,QAAQ,IAAI;AAAA,MACd,SAAS;AAAA,QACL,IAAI;AAAA,QACJ,gBAAgB;AAAA,QAChB,OAAO;AAAA,QACP,IAAI;AAAA,QACJ,OAAO,CAAE;AAAA,QACT,QAAQ,CAAE;AAAA,MACb;AAAA,MACD,0BAA0B;AAAA,MAC1B,aAAa;AAAA,IACjB,CAAC;AAED,aAAS,uBAAuB;AAC5B,YAAM,MAAM,2BAA2B,CAAC,MAAM,MAAM;AAAA,IACxD;AAEA,aAAS,YAAY;AACjB,UAAI,CAAC,MAAM,MAAM,aAAa;AAC1B,cAAM,KAAK,MAAM,mBAAmB,KAAK,KAAK,CAAC,EAC1C,KAAK,MAAM;AACR,gBAAM,MAAM,cAAc;AACiB;AACvC,gBAAI;AACA;AAAA,gBACI;AAAA,gBACA;AAAA,kBACI,SAAS,MAAM,QAAQ,iBAAiB,MAAM,QAAQ,iBAAiB,MAAM,QAAQ;AAAA,kBACrF,YAAY;AAAA,kBACZ,gBAAgB;AAAA,kBAChB,eAAe,CAAC,KAAK,MAAM,OAAO;AAAA,kBAClC,gBAAgB,MAAM,QAAQ;AAAA,gBACjC;AAAA,gBACD,KAAK,MAAM;AAAA,cACvC;AAEwB,kBAAI,WAAW;AAAA,gBACX,OAAO;AAAA,gBACP,WAAW;AAAA,kBACP,OAAO,CAAC;AAAA,oBACJ,WAAW,MAAM,QAAQ;AAAA,oBACzB,SAAS,KAAK,MAAM;AAAA,oBACpB,OAAO,MAAM,QAAQ,iBAAiB,MAAM,QAAQ,iBAAiB,MAAM,QAAQ;AAAA,oBACnF,UAAU;AAAA,kBAC9C,CAAiC;AAAA,gBACJ;AAAA,cAC7B,CAAyB;AAAA,YACJ,SAAQ,GAAP;AACE,sBAAQ,IAAI,CAAC;AAAA,YAChB;AAAA,UACJ;AACD,gBAAM,OAAO,UAAU;AACvB,eAAK;AAAA,YACD,MAAM;AAAA,YACN,OAAO;AAAA,YACP,MAAM;AAAA,YACN,kBAAkB;AAAA,YAClB,mBAAmB;AAAA,YACnB,kBAAkB;AAAA,UAEtC,CAAiB,EAAE,KAAK,CAAC,WAAW;AAChB,gBAAI,OAAO,eAAe,OAAO,WAAW,aAAa;AACrD,qBAAO,SAAS,OAAO,MAAM,UAAU;AAAA,YAC1C;AAAA,UACrB,CAAiB;AAAA,QAEjB,CAAa,EACA,MAAM,MAAM;AACT,eAAK;AAAA,YACD,MAAM;AAAA,YACN,OAAO;AAAA,YACP,MAAM;AAAA,UAC1B,CAAiB;AAAA,QACjB,CAAa;AAAA,MACR;AAAA,IACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}