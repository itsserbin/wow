{"version":3,"file":"Index-ac0b33f2.mjs","sources":["../../../resources/js/Pages/Admin/Options/Characteristics/Index.vue"],"sourcesContent":["<script setup>\nimport {onMounted, inject, ref, computed} from \"vue\";\nimport {CharacteristicsRepository} from \"@/Repositories/CharacteristicsRepository.js\";\nimport {swal} from \"@/Includes/swal\";\n\nimport Button from '@/Components/Button.vue';\nimport Loader from '@/Components/Loader.vue';\nimport Paginate from '@/Components/Paginate.vue';\nimport Modal from '@/Pages/Admin/Options/Characteristics/Modal.vue';\nimport OptionsLayout from '@/Pages/Admin/Options/OptionsLayout.vue'\nimport Table from '@/Pages/Admin/Options/Characteristics/Table.vue'\n\nconst can = inject('$can');\n\nconst params = ref({\n    currentPage: 1,\n})\n\nconst item = {\n    title: {\n        ua: null,\n        ru: null\n    },\n    values: [\n        {\n            title: {\n                ua: null,\n                ru: null\n            }\n        }\n    ]\n};\n\nconst state = ref({\n    data: [],\n    isLoading: true,\n    isActiveModal: false,\n    modalAction: '',\n    item: {},\n});\n\nonMounted(() => {\n    fetch(1);\n})\n\nconst activeModal = computed(() => state.value.isActiveModal ? Modal : null)\n\nasync function fetch() {\n    try {\n        const data = await CharacteristicsRepository().fetch(params.value);\n        if (data.success) {\n            state.value.data = data.result;\n        }\n        state.value.isLoading = false;\n    } catch (e) {\n        console.error(e);\n        state.value.isLoading = false;\n    }\n}\n\nasync function onDestroy(id) {\n    try {\n        if (can('destroy-characteristics')) {\n            const confirm = await swal({\n                title: 'Видалити?',\n                icon: 'warning',\n                showCancelButton: true,\n            });\n            if (confirm.isConfirmed) {\n                await CharacteristicsRepository().destroy(id);\n                state.value.isLoading = false;\n                await fetch();\n                if (state.value.isActiveModal) {\n                    modalFunction();\n                }\n                await swal({\n                    title: 'Success!',\n                    icon: 'success'\n                });\n            }\n        }\n    } catch (errors) {\n        console.error(errors);\n        await swal({\n            title: 'Error!',\n            icon: 'error',\n            text: errors.response.data.message || 'An error occurred, please try again later'\n        });\n    }\n}\n\nfunction modalFunction() {\n    state.value.isActiveModal = !state.value.isActiveModal;\n}\n\nasync function onEdit(id, i) {\n    try {\n        const {result, success} = await CharacteristicsRepository().edit(id);\n        if (success) {\n            state.value.item.index = i;\n            state.value.item = result;\n            state.value.modalAction = 'edit';\n            modalFunction();\n            state.value.isLoading = false;\n        }\n    } catch (error) {\n        state.value.isLoading = false;\n        console.error(error);\n        await swal({\n            title: 'Error!',\n            icon: 'error',\n            text: error.response.data.message || 'An error occurred, please try again later'\n        });\n    }\n}\n\nasync function onUpdate() {\n    try {\n        if (can('edit-characteristics')) {\n            const {success} = await CharacteristicsRepository().update(state.value.item.id, state.value.item);\n            if (success) {\n                modalFunction();\n                await fetch();\n                await swal({\n                    title: 'Success!',\n                    icon: 'success'\n                })\n            }\n        }\n    } catch (error) {\n        state.value.isLoading = false;\n        console.error(error);\n        await swal({\n            title: 'Error!',\n            icon: 'error',\n            text: error.response.data.message || 'An error occurred, please try again later'\n        });\n    }\n}\n\nasync function onCreate() {\n    try {\n        if (can('create-characteristics')) {\n            const {success} = await CharacteristicsRepository().create(state.value.item);\n            if (success) {\n                state.value.item = {};\n                modalFunction();\n                await fetch();\n                await swal({\n                    title: 'Success!',\n                    icon: 'success'\n                })\n            }\n        }\n    } catch (error) {\n        state.value.isLoading = false;\n        console.error(error);\n        await swal({\n            title: 'Error!',\n            icon: 'error',\n            text: error || 'An error occurred, please try again later'\n        });\n    }\n}\n\nfunction submitForm() {\n    if (state.value.modalAction === 'edit' && can('edit-characteristics')) {\n        onUpdate();\n    } else if (state.value.modalAction === 'create' && can('create-characteristics')) {\n        onCreate();\n    }\n}\n\nfunction create() {\n    if (can('create-characteristics')) {\n        state.value.item = JSON.parse(JSON.stringify(item));\n        state.value.modalAction = 'create';\n        modalFunction();\n    }\n}\n</script>\n\n<template>\n    <OptionsLayout title=\"Характеристики товарів\">\n        <template #header>\n            Характеристики товарів\n        </template>\n\n        <Loader v-if=\"state.isLoading\"/>\n        <div v-if=\"!state.isLoading && can('show-characteristics')\" class=\"grid grid-cols-1 gap-4\">\n            <div>\n                <Button type=\"btn\" @click=\"create\" v-if=\"can('create-characteristics')\">\n                    Додати\n                </Button>\n            </div>\n\n            <Table :data=\"state.data.data\"\n                   @onEdit=\"onEdit\"\n                   @onDestroy=\"onDestroy\"\n                   :canDestroy=\"can('destroy-characteristics')\"\n            />\n\n            <div class=\"text-center\">\n                <Paginate :pagination=\"state.data\"\n                          :click-handler=\"fetch\"\n                          v-model=\"params.currentPage\"\n                />\n            </div>\n        </div>\n        <component :is=\"activeModal\"\n                   :item=\"state.item\"\n                   @closeModal=\"modalFunction\"\n                   @submitForm=\"submitForm\"\n                   @declineForm=\"onDestroy\"\n                   :canDestroy=\"can('destroy-characteristics')\"\n        ></component>\n    </OptionsLayout>\n</template>\n"],"names":["Modal"],"mappings":"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"}