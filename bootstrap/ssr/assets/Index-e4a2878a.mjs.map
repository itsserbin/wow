{"version":3,"file":"Index-e4a2878a.mjs","sources":["../../../resources/js/Pages/Public/Category/Index.vue"],"sourcesContent":["<script setup>\nimport {isLoading} from \"@/Pages/Public/load\";\nimport {computed, onMounted, ref} from \"vue\";\n\nimport Support from '../Components/Support.vue';\nimport Consultation from '../Components/Consultation.vue';\nimport Content from '../Components/Content.vue';\nimport Banners from '../Components/Banners.vue';\nimport Products from './Products.vue';\nimport Sort from './Sort.vue';\nimport Filter from './Filter.vue';\nimport ProductsRepository from \"@/Repositories/ProductsRepository\";\nimport Button from '@/Pages/Public/Components/Button.vue'\nimport MasterLayout from '@/Layouts/MasterLayout.vue'\nimport Breadcrumbs from './Breadcrumbs.vue'\nimport Head from './Head.vue';\n\ndefineOptions({layout: MasterLayout})\n\nconst props = defineProps([\n    'banners',\n    'lang',\n    'title',\n    'characteristics',\n    'text',\n    'consultation',\n    'products',\n    'categories',\n    'category',\n    'options',\n    'pages',\n    'eventIdPageView',\n]);\n\nconst state = ref({\n    products: [],\n    isLoadingMore: false,\n    isShowLoadMore: true,\n    isShowFilter: false\n});\n\nconst params = ref({\n    currentPage: 1,\n    sort: null,\n    filter: null,\n});\n\nconst getParams = computed(() => {\n    const {currentPage, sort, filter} = params.value;\n    return {\n        page: currentPage,\n        sort: sort,\n        filter: filter,\n        slug: (route().params).slug\n    };\n});\n\nonMounted(async () => {\n    state.value.products = props.products.data;\n    isLoading.value = false;\n})\n\nconst onSort = async () => {\n    params.value.currentPage = 0;\n    state.value.products = [];\n    await fetch();\n}\n\nconst filter = async (val) => {\n    params.value.filter = val;\n    params.value.currentPage = 0;\n    state.value.products = [];\n    if (state.value.isShowFilter) {\n        toggleFilter();\n    }\n    await fetch();\n}\n\nconst fetch = async () => {\n    params.value.currentPage += 1;\n    try {\n        const data = await ProductsRepository.v1().category(getParams.value);\n        if (data.success) {\n            params.value.currentPage = data.result.current_page;\n            state.value.products = state.value.products.concat(data.result.data);\n            state.value.isShowLoadMore = (data.result.to !== data.result.total);\n        }\n    } catch (e) {\n        console.error(e);\n        state.value.isLoading = false;\n    }\n}\n\nconst toggleFilter = () => {\n    state.value.isShowFilter = !state.value.isShowFilter;\n}\n\n</script>\n\n<template>\n    <Head :category=\"category\" :lang=\"lang\"/>\n\n    <Breadcrumbs :currentUrl=\"route().current\" :options=\"options\" :lang=\"lang\" :title=\"category.title[lang]\"/>\n\n    <div class=\"grid grid-cols-1 gap-4\">\n\n        <Banners v-if=\"banners.length\" :lang=\"lang\" :data=\"banners\"/>\n\n        <div class=\"flex justify-between md:justify-end items-center\">\n            <div class=\"block md:hidden mr-2\">\n                <Button type=\"button\" @click=\"toggleFilter\">Фільтрувати</Button>\n            </div>\n\n            <Sort v-model=\"params.sort\" @sort=\"onSort\"/>\n        </div>\n\n        <div class=\"grid grid-cols-12 gap-4\">\n            <div :class=\"{'!block fixed h-full w-full z-50 overflow-y-scroll top-0 right-0' : state.isShowFilter}\"\n                 class=\"filter hidden md:col-span-3 md:block\"\n            >\n                <Filter v-if=\"Object.keys(characteristics).length\"\n                        :characteristics=\"characteristics\"\n                        :lang=\"lang\"\n                        @fetch=\"filter\"\n                        @close=\"toggleFilter\"\n                        :isShow=\"state.isShowFilter\"\n                />\n            </div>\n            <div class=\"products col-span-12 md:col-span-9\">\n                <Products :lang=\"lang\"\n                          :title=\"title\"\n                          :data=\"state.products\"\n                          :isLoadingMore=\"state.isLoadingMore\"\n                          :isShowLoadMore=\"state.isShowLoadMore\"\n                          @fetch=\"fetch\"\n                          v-if=\"state.products.length\"\n                />\n            </div>\n        </div>\n\n        <Content v-if=\"text\" :data=\"text\"/>\n\n        <Consultation v-if=\"consultation\"/>\n        <Support v-if=\"!isLoading\"/>\n    </div>\n</template>\n"],"names":["__MACROS_defineComponent","MasterLayout","filter"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiBc,MAAA,cAAAA,gBAAA,EAAC,QAAQC,YAAY,CAAA;;;;;;;;;;;;;;;;;;;;AAiBnC,UAAM,QAAQ,IAAI;AAAA,MACd,UAAU,CAAE;AAAA,MACZ,eAAe;AAAA,MACf,gBAAgB;AAAA,MAChB,cAAc;AAAA,IAClB,CAAC;AAED,UAAM,SAAS,IAAI;AAAA,MACf,aAAa;AAAA,MACb,MAAM;AAAA,MACN,QAAQ;AAAA,IACZ,CAAC;AAED,UAAM,YAAY,SAAS,MAAM;AAC7B,YAAM,EAAC,aAAa,MAAM,QAAAC,QAAM,IAAI,OAAO;AAC3C,aAAO;AAAA,QACH,MAAM;AAAA,QACN;AAAA,QACA,QAAQA;AAAA,QACR,MAAO,QAAQ,OAAQ;AAAA,MAC/B;AAAA,IACA,CAAC;AAED,cAAU,YAAY;AAClB,YAAM,MAAM,WAAW,MAAM,SAAS;AACtC,gBAAU,QAAQ;AAAA,IACtB,CAAC;AAED,UAAM,SAAS,YAAY;AACvB,aAAO,MAAM,cAAc;AAC3B,YAAM,MAAM,WAAW;AACvB,YAAM,MAAK;AAAA,IACf;AAEA,UAAM,SAAS,OAAO,QAAQ;AAC1B,aAAO,MAAM,SAAS;AACtB,aAAO,MAAM,cAAc;AAC3B,YAAM,MAAM,WAAW;AACvB,UAAI,MAAM,MAAM,cAAc;AAC1B;MACH;AACD,YAAM,MAAK;AAAA,IACf;AAEA,UAAM,QAAQ,YAAY;AACtB,aAAO,MAAM,eAAe;AAC5B,UAAI;AACA,cAAM,OAAO,MAAM,mBAAmB,GAAI,EAAC,SAAS,UAAU,KAAK;AACnE,YAAI,KAAK,SAAS;AACd,iBAAO,MAAM,cAAc,KAAK,OAAO;AACvC,gBAAM,MAAM,WAAW,MAAM,MAAM,SAAS,OAAO,KAAK,OAAO,IAAI;AACnE,gBAAM,MAAM,iBAAkB,KAAK,OAAO,OAAO,KAAK,OAAO;AAAA,QAChE;AAAA,MACJ,SAAQ,GAAP;AACE,gBAAQ,MAAM,CAAC;AACf,cAAM,MAAM,YAAY;AAAA,MAC3B;AAAA,IACL;AAEA,UAAM,eAAe,MAAM;AACvB,YAAM,MAAM,eAAe,CAAC,MAAM,MAAM;AAAA,IAC5C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}