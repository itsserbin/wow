{"version":3,"file":"Index-fabede51.mjs","sources":["../../../resources/js/Pages/Admin/Options/Faqs/Index.vue"],"sourcesContent":["<script setup>\nimport {reactive, onMounted, inject, ref, computed} from \"vue\";\nimport {swal} from \"@/Includes/swal\";\n\nimport Loader from '@/Components/Loader.vue';\nimport Button from '@/Components/Button.vue';\nimport Paginate from '@/Components/Paginate.vue';\nimport Modal from '@/Pages/Admin/Options/Faqs/Modal.vue';\nimport OptionsLayout from '@/Pages/Admin/Options/OptionsLayout.vue'\nimport Table from '@/Pages/Admin/Options/Faqs/Table.vue';\n\n\nconst can = inject('$can');\n\nconst item = reactive({\n  question: {\n    ua: null,\n    ru: null,\n  },\n  answer: {\n    ua: null,\n    ru: null,\n  },\n  published: 0\n})\n\nconst state = ref({\n  data: [],\n  currentPage: 1,\n  isLoading: true,\n  isActiveModal: false,\n  modalAction: '',\n  item: item,\n});\n\nonMounted(() => {\n  fetch(1);\n})\n\nconst activeModal = computed(() => state.value.isActiveModal ? Modal : null)\n\nfunction fetch(page) {\n  state.value.isLoading = true;\n  if (page) {\n    state.value.currentPage = page;\n  }\n  axios.get(route('api.faqs.index', {'page': state.value.currentPage}))\n      .then(response => {\n        Object.assign(state.value.data, response.data.result);\n        state.value.isLoading = false;\n      })\n      .catch(errors => {\n        console.log(errors);\n        state.value.isLoading = false;\n      })\n}\n\nfunction onDestroy(id) {\n  if (can('destroy-faq')) {\n    swal({\n      title: 'Видалити?',\n      icon: 'warning',\n      showCancelButton: true,\n    }).then((result) => {\n      if (result.isConfirmed) {\n        axios.delete(route('api.faqs.destroy', id))\n            .then(() => {\n              fetch();\n              if (state.value.isActiveModal) {\n                modalFunction();\n              }\n              swal({\n                icon: 'success',\n                title: 'Destroyed!'\n              })\n            })\n            .catch(errors => {\n              console.log(errors);\n              swal({\n                icon: 'error',\n                title: 'Error!'\n              })\n            })\n      }\n    })\n\n  }\n}\n\nfunction modalFunction() {\n  state.value.isActiveModal = !state.value.isActiveModal;\n}\n\nfunction onEdit(id, i) {\n  if (can('edit-faq')) {\n    axios.get(route('api.faqs.edit', id))\n        .then(({data}) => {\n          state.value.item = data.result;\n          state.value.modalAction = 'edit';\n          state.value.item.index = i;\n          modalFunction();\n        })\n        .catch((response) => console.log(response))\n  }\n}\n\nfunction onUpdate() {\n  if (can('edit-faq')) {\n    axios.put(route('api.faqs.update', state.value.item.id), state.value.item)\n        .then(() => {\n          modalFunction();\n          fetch();\n          swal({\n            title: 'Success!',\n            icon: 'success'\n          })\n        })\n        .catch((response) => {\n          console.log(response);\n          swal({\n            title: 'Error!',\n            icon: 'error'\n          })\n        })\n  }\n}\n\nfunction onCreate() {\n  if (can('create-faq')) {\n    axios.post(route('api.faqs.create'), state.value.item)\n        .then(() => {\n          modalFunction();\n          state.value.item = item;\n          fetch();\n          swal({\n            title: 'Success!',\n            icon: 'success'\n          })\n        })\n        .catch((response) => {\n          console.log(response);\n          swal({\n            title: 'Error!',\n            icon: 'error'\n          })\n        })\n  }\n}\n\nfunction submitForm() {\n  if (state.value.modalAction === 'edit' && can('edit-faq')) {\n    onUpdate();\n  } else if (state.value.modalAction === 'create' && can('create-faq')) {\n    onCreate();\n  }\n}\n\nfunction create() {\n  if (can('create-faq')) {\n    Object.assign(state.value.item, item);\n    state.value.modalAction = 'create';\n    modalFunction();\n  }\n}\n\n</script>\n\n<template>\n  <OptionsLayout title=\"FAQ\">\n    <template #header>\n      FAQ\n    </template>\n\n    <Loader v-if=\"state.isLoading\"/>\n    <div v-if=\"!state.isLoading && can('show-faq')\">\n      <Button type=\"btn\" @click=\"create\" v-if=\"can('create-faq')\">\n        Додати\n      </Button>\n\n\n      <Table :data=\"state.data.data\"\n             @onEdit=\"onEdit\"\n             @onDestroy=\"onDestroy\"\n             :canDestroy=\"can('destroy-faq')\"\n      />\n\n      <Paginate :pagination=\"state.data\"\n                :click-handler=\"fetch\"\n                v-model=\"state.currentPage\"\n      />\n\n      <component :is=\"activeModal\"\n                 :item=\"state.item\"\n                 @closeModal=\"modalFunction\"\n                 @submitForm=\"submitForm\"\n                 @declineForm=\"onDestroy\"\n                 :canDestroy=\"can('destroy-faq')\"\n      ></component>\n    </div>\n  </OptionsLayout>\n</template>\n"],"names":["Modal"],"mappings":"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"}