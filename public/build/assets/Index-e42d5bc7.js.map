{"version":3,"file":"Index-e42d5bc7.js","sources":["../../../resources/js/Pages/Admin/Options/Faqs/Index.vue"],"sourcesContent":["<script setup>\nimport {reactive, onMounted, inject, ref, computed} from \"vue\";\nimport {swal} from \"@/Includes/swal\";\n\nimport Loader from '@/Components/Loader.vue';\nimport Button from '@/Components/Button.vue';\nimport Paginate from '@/Components/Paginate.vue';\nimport Modal from '@/Pages/Admin/Options/Faqs/Modal.vue';\nimport OptionsLayout from '@/Pages/Admin/Options/OptionsLayout.vue'\nimport Table from '@/Pages/Admin/Options/Faqs/Table.vue';\n\n\nconst can = inject('$can');\n\nconst item = reactive({\n  question: {\n    ua: null,\n    ru: null,\n  },\n  answer: {\n    ua: null,\n    ru: null,\n  },\n  published: 0\n})\n\nconst state = ref({\n  data: [],\n  currentPage: 1,\n  isLoading: true,\n  isActiveModal: false,\n  modalAction: '',\n  item: item,\n});\n\nonMounted(() => {\n  fetch(1);\n})\n\nconst activeModal = computed(() => state.value.isActiveModal ? Modal : null)\n\nfunction fetch(page) {\n  state.value.isLoading = true;\n  if (page) {\n    state.value.currentPage = page;\n  }\n  axios.get(route('api.faqs.index', {'page': state.value.currentPage}))\n      .then(response => {\n        Object.assign(state.value.data, response.data.result);\n        state.value.isLoading = false;\n      })\n      .catch(errors => {\n        console.log(errors);\n        state.value.isLoading = false;\n      })\n}\n\nfunction onDestroy(id) {\n  if (can('destroy-faq')) {\n    swal({\n      title: 'Видалити?',\n      icon: 'warning',\n      showCancelButton: true,\n    }).then((result) => {\n      if (result.isConfirmed) {\n        axios.delete(route('api.faqs.destroy', id))\n            .then(() => {\n              fetch();\n              if (state.value.isActiveModal) {\n                modalFunction();\n              }\n              swal({\n                icon: 'success',\n                title: 'Destroyed!'\n              })\n            })\n            .catch(errors => {\n              console.log(errors);\n              swal({\n                icon: 'error',\n                title: 'Error!'\n              })\n            })\n      }\n    })\n\n  }\n}\n\nfunction modalFunction() {\n  state.value.isActiveModal = !state.value.isActiveModal;\n}\n\nfunction onEdit(id, i) {\n  if (can('edit-faq')) {\n    axios.get(route('api.faqs.edit', id))\n        .then(({data}) => {\n          state.value.item = data.result;\n          state.value.modalAction = 'edit';\n          state.value.item.index = i;\n          modalFunction();\n        })\n        .catch((response) => console.log(response))\n  }\n}\n\nfunction onUpdate() {\n  if (can('edit-faq')) {\n    axios.put(route('api.faqs.update', state.value.item.id), state.value.item)\n        .then(() => {\n          modalFunction();\n          fetch();\n          swal({\n            title: 'Success!',\n            icon: 'success'\n          })\n        })\n        .catch((response) => {\n          console.log(response);\n          swal({\n            title: 'Error!',\n            icon: 'error'\n          })\n        })\n  }\n}\n\nfunction onCreate() {\n  if (can('create-faq')) {\n    axios.post(route('api.faqs.create'), state.value.item)\n        .then(() => {\n          modalFunction();\n          state.value.item = item;\n          fetch();\n          swal({\n            title: 'Success!',\n            icon: 'success'\n          })\n        })\n        .catch((response) => {\n          console.log(response);\n          swal({\n            title: 'Error!',\n            icon: 'error'\n          })\n        })\n  }\n}\n\nfunction submitForm() {\n  if (state.value.modalAction === 'edit' && can('edit-faq')) {\n    onUpdate();\n  } else if (state.value.modalAction === 'create' && can('create-faq')) {\n    onCreate();\n  }\n}\n\nfunction create() {\n  if (can('create-faq')) {\n    Object.assign(state.value.item, item);\n    state.value.modalAction = 'create';\n    modalFunction();\n  }\n}\n\n</script>\n\n<template>\n  <OptionsLayout title=\"FAQ\">\n    <template #header>\n      FAQ\n    </template>\n\n    <Loader v-if=\"state.isLoading\"/>\n    <div v-if=\"!state.isLoading && can('show-faq')\">\n      <Button type=\"btn\" @click=\"create\" v-if=\"can('create-faq')\">\n        Додати\n      </Button>\n\n\n      <Table :data=\"state.data.data\"\n             @onEdit=\"onEdit\"\n             @onDestroy=\"onDestroy\"\n             :canDestroy=\"can('destroy-faq')\"\n      />\n\n      <Paginate :pagination=\"state.data\"\n                :click-handler=\"fetch\"\n                v-model=\"state.currentPage\"\n      />\n\n      <component :is=\"activeModal\"\n                 :item=\"state.item\"\n                 @closeModal=\"modalFunction\"\n                 @submitForm=\"submitForm\"\n                 @declineForm=\"onDestroy\"\n                 :canDestroy=\"can('destroy-faq')\"\n      ></component>\n    </div>\n  </OptionsLayout>\n</template>\n"],"names":["can","inject","item","reactive","state","ref","onMounted","fetch","activeModal","computed","Modal","page","response","errors","onDestroy","id","swal","result","modalFunction","onEdit","i","data","onUpdate","onCreate","submitForm","create"],"mappings":"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"}