import{r as V,f as y,o as F,s as r,v as g,y as _,p as i,k as M,l as h,j as p,u as d,g as P,i as I,P as B,z as L,a2 as k}from"./app-dd6fef3b.js";import{L as D,b as E,e as N}from"./app-f66cc5fa.js";import{_ as b}from"./UploadImagesModal-bada041c.js";import j from"./List-f969e482.js";import z from"./Modal-55fa1cba.js";import S from"./ContentLayout-4ddac8c4.js";import{u as O}from"./vue-i18n.esm-bundler-239abee1.js";import"./moment-fbc5633a.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Logo-31eea3db.js";import"./Form-0e8aad29.js";const v={async fetch(t){try{return(await axios.get(route("api.images.index",t))).data}catch(s){throw new Error(s.response.data)}},async destroy(t){try{return(await axios.delete(route("api.images.destroy",t))).data}catch(s){throw new Error(s.response.data)}},async update(t){try{return(await axios.put(route("api.images.update",t.id),t)).data}catch(s){throw new Error(s.response.data)}}},R={key:1,class:"grid grid-cols-1 gap-4"},T={class:"text-center"},ae={__name:"Index",setup(t){const s=_("$swal"),l=_("$can"),{t:u}=O(),e=V({imagesList:[],isActiveUploadModal:!1,isActiveImageModal:!1,imageUploadModal:[],imageModal:{id:null,src:null,alt:null},currentPage:1,isLoading:!0}),$=y(()=>e.value.isActiveUploadModal?b:null),C=y(()=>e.value.isActiveImageModal?z:null);F(()=>n());const f=()=>{e.value.isActiveUploadModal=!e.value.isActiveUploadModal},c=()=>{e.value.isActiveImageModal=!e.value.isActiveImageModal},U=a=>{c(),e.value.imageModal=a},A=async()=>{if(l("edit-images")){const{success:a}=await v.update(e.value.imageModal);a&&(c(),await s({icon:"success",title:u("swal.updated")}))}},x=async a=>{await w(a),c()},w=async a=>{if(l("destroy-images")&&(await s({title:u("swal.sure"),icon:"warning",showCancelButton:!0})).isConfirmed){e.value.isLoading=!0;const{success:m}=await v.destroy(a);m&&(await n(),await s({icon:"success",title:u("swal.destroyed")})),e.value.isLoading=!1}},n=async a=>{e.value.isLoading=!0,a&&(e.value.currentPage=a);const o=await v.fetch({page:e.value.currentPage});e.value.imagesList=o.success?o.result:[],e.value.isLoading=!1};return(a,o)=>(i(),r(S,{title:a.$t("images.page_title")},{header:g(()=>[M(h(a.$t("images.page_title")),1)]),default:g(()=>[e.value.isLoading?(i(),r(D,{key:0})):p("",!0),!e.value.isLoading&&d(l)("show-images")?(i(),P("div",R,[I("div",null,[d(l)("create-images")?(i(),r(E,{key:0,type:"btn",onClick:B(f,["prevent"])},{default:g(()=>[M(h(a.$t("add")),1)]),_:1},8,["onClick"])):p("",!0)]),L(j,{images:e.value.imagesList,onClickImage:U,onFetch:n,onDestroyImage:w},null,8,["images"]),I("div",T,[L(N,{pagination:e.value.imagesList,"click-handler":n,modelValue:e.value.currentPage,"onUpdate:modelValue":o[0]||(o[0]=m=>e.value.currentPage=m)},null,8,["pagination","modelValue"])])])):p("",!0),(i(),r(k(d(C)),{onCloseModal:c,onSubmitForm:A,onDeclineForm:x,image:e.value.imageModal,size:"large"},null,40,["image"])),(i(),r(k(d($)),{onCloseModal:f,onOnUpload:n},null,32))]),_:1},8,["title"]))}};export{ae as default};
