{"version":3,"file":"Index-9a09ec8a.js","sources":["../../../resources/js/Pages/Public/Category/Index.vue"],"sourcesContent":["<script setup>\nimport {computed, reactive} from \"vue\";\n\nimport Support from '../Components/Support.vue';\nimport Consultation from '../Components/Consultation.vue';\nimport Content from '../Components/Content.vue';\nimport Banners from '../Components/Banners.vue';\nimport Products from './Products.vue';\nimport Sort from './Sort.vue';\nimport Filter from './Filter.vue';\nimport ProductsRepository from \"@/Repositories/ProductsRepository\";\nimport Button from '@/Pages/Public/Components/Button.vue'\nimport MasterLayout from '@/Layouts/MasterLayout.vue'\nimport Breadcrumbs from './Breadcrumbs.vue'\nimport Head from './Head.vue';\n\ndefineOptions({layout: MasterLayout})\n\nconst props = defineProps([\n    'banners',\n    'lang',\n    'title',\n    'characteristics',\n    'text',\n    'consultation',\n    'products',\n    'categories',\n    'category',\n    'options',\n    'pages',\n    'eventIdPageView',\n]);\n\nconst state = reactive({\n    products: props.products.data,\n    isLoadingMore: false,\n    isShowLoadMore: props.products.to !== props.products.total,\n    isShowFilter: false\n});\n\nconst params = reactive({\n    currentPage: 1,\n    sort: null,\n    filter: null,\n});\n\nconst getParams = computed(() => {\n    const {currentPage, sort, filter} = params;\n    return {\n        page: currentPage,\n        sort: sort,\n        filter: filter,\n        slug: (route().params).slug\n    };\n});\n\nconst onSort = async () => {\n    params.currentPage = 0;\n    state.products = [];\n    await fetch();\n}\n\nconst filter = async (val) => {\n    params.filter = val;\n    params.currentPage = 0;\n    state.products = [];\n    if (state.isShowFilter) {\n        toggleFilter();\n    }\n    await fetch();\n}\n\nconst fetch = async () => {\n    params.currentPage += 1;\n    try {\n        const data = await ProductsRepository.v1().category(getParams.value);\n        if (data.success) {\n            params.currentPage = data.result.current_page;\n            state.products = state.products.concat(data.result.data);\n            state.isShowLoadMore = (data.result.to !== data.result.total);\n        }\n    } catch (e) {\n        console.error(e);\n        state.isLoading = false;\n    }\n}\n\nconst toggleFilter = () => {\n    state.isShowFilter = !state.isShowFilter;\n}\n\n</script>\n\n<template>\n    <Head :category=\"category\" :lang=\"lang\"/>\n\n    <Breadcrumbs :currentUrl=\"route().current\" :options=\"options\" :lang=\"lang\" :title=\"category.title[lang]\"/>\n\n    <div class=\"grid grid-cols-1 gap-4\">\n\n        <Banners v-if=\"banners.length\" :lang=\"lang\" :data=\"banners\"/>\n\n        <div class=\"flex justify-between md:justify-end items-center\">\n            <div class=\"block md:hidden mr-2\">\n                <Button type=\"button\" @click=\"toggleFilter\">Фільтрувати</Button>\n            </div>\n\n            <Sort v-model=\"params.sort\" @sort=\"onSort\"/>\n        </div>\n\n        <div class=\"grid grid-cols-12 gap-4\">\n            <div :class=\"{'!block fixed h-full w-full z-50 overflow-y-scroll top-0 right-0' : state.isShowFilter}\"\n                 class=\"filter hidden md:col-span-3 md:block\"\n            >\n                <Filter v-if=\"Object.keys(characteristics).length\"\n                        :characteristics=\"characteristics\"\n                        :lang=\"lang\"\n                        @fetch=\"filter\"\n                        @close=\"toggleFilter\"\n                        :isShow=\"state.isShowFilter\"\n                />\n            </div>\n            <div class=\"products col-span-12 md:col-span-9\">\n                <Products :lang=\"lang\"\n                          :title=\"title\"\n                          :data=\"state.products\"\n                          :isLoadingMore=\"state.isLoadingMore\"\n                          :isShowLoadMore=\"state.isShowLoadMore\"\n                          @fetch=\"fetch\"\n                          v-if=\"state.products.length\"\n                />\n            </div>\n        </div>\n\n        <Content v-if=\"text\" :data=\"text\"/>\n        <Consultation v-if=\"options.consultation_status === 'on'\"/>\n        <Support/>\n\n    </div>\n</template>\n"],"names":["__default__","__MACROS_defineComponent","MasterLayout","state","reactive","props","params","getParams","computed","currentPage","sort","filter","onSort","fetch","val","toggleFilter","data","ProductsRepository"],"mappings":"8pDAgBcA,EAAAC,EAAA,CAAC,OAAQC,CAAY,CAAA,wMAiB7BC,EAAQC,EAAS,CACnB,SAAUC,EAAM,SAAS,KACzB,cAAe,GACf,eAAgBA,EAAM,SAAS,KAAOA,EAAM,SAAS,MACrD,aAAc,EAClB,CAAC,EAEKC,EAASF,EAAS,CACpB,YAAa,EACb,KAAM,KACN,OAAQ,IACZ,CAAC,EAEKG,EAAYC,EAAS,IAAM,CAC7B,KAAM,CAAC,YAAAC,EAAa,KAAAC,EAAM,OAAAC,CAAM,EAAIL,EACpC,MAAO,CACH,KAAMG,EACN,KAAMC,EACN,OAAQC,EACR,KAAO,QAAQ,OAAQ,IAC/B,CACA,CAAC,EAEKC,EAAS,SAAY,CACvBN,EAAO,YAAc,EACrBH,EAAM,SAAW,GACjB,MAAMU,EAAK,CACf,EAEMF,EAAS,MAAOG,GAAQ,CAC1BR,EAAO,OAASQ,EAChBR,EAAO,YAAc,EACrBH,EAAM,SAAW,GACbA,EAAM,cACNY,IAEJ,MAAMF,EAAK,CACf,EAEMA,EAAQ,SAAY,CACtBP,EAAO,aAAe,EACtB,GAAI,CACA,MAAMU,EAAO,MAAMC,EAAmB,GAAI,EAAC,SAASV,EAAU,KAAK,EAC/DS,EAAK,UACLV,EAAO,YAAcU,EAAK,OAAO,aACjCb,EAAM,SAAWA,EAAM,SAAS,OAAOa,EAAK,OAAO,IAAI,EACvDb,EAAM,eAAkBa,EAAK,OAAO,KAAOA,EAAK,OAAO,MAE9D,OAAQ,EAAP,CACE,QAAQ,MAAM,CAAC,EACfb,EAAM,UAAY,EACrB,CACL,EAEMY,EAAe,IAAM,CACvBZ,EAAM,aAAe,CAACA,EAAM,YAChC"}