import j from"./Modal.5d425b00.js";import z from"./Table.aaf76cb2.js";import"./app.ec138a24.js";import{A as h,B as b,G,V as p,S as m,X as s,R as r,_ as y,P as k,L,M as g,K as _,F as K,U as R,Y as E,O as T,bc as X,x as A}from"./moment.fb372146.js";import"./Form.18e1037f.js";import"./ItemsModal.1b556625.js";import"./ItemsForm.131342c3.js";import"./ItemsTable.03ef8c88.js";const Y=E(" \u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F "),q={key:1},H={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},J={class:"md:col-span-1"},Q={class:"w-full md:col-span-4 grid gap-4 grid-cols-1"},W={class:"text-center"},le={__name:"Index",props:["statuses","payment_methods"],setup(M){const f=M,e=h({orders:[],currentPage:1,isLoading:!0,isActiveEditModal:!1,sidebarActive:"all",orderModal:{}}),d=h([]),c=A("$swal"),u=A("$can"),a=h({status:null,currentPage:1}),P=b(()=>{const t={};return t.page=a.value.currentPage,a.value.status&&(t.status=a.value.status),t});G(()=>{n(),d.value.push({title:"\u0412\u0441\u0456 \u0437\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F",key:"all"});for(const[t,o]of Object.entries(f.statuses))d.value.push({title:o,key:t})});const S=b(()=>e.value.isActiveEditModal?j:null);function V(t){u("edit-orders")&&(axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal),axios.get(route("api.orders.edit",t.order_id)).then(({data:o})=>e.value.orderModal=o.result).catch(o=>console.log(o)))}function C(t){a.value.status=t,e.value.sidebarActive=t,n()}function F(t){t&&(a.value.currentPage=t),n()}function B(t){axios.get(route("api.orders.search",t)).then(({data:o})=>{e.value.sidebarActive=null,a.value.currentPage=1,e.value.orders=o.result,e.value.isLoading=!1}).catch(o=>{console.log(o),e.value.isLoading=!1})}function n(){axios.get(route("api.orders.index",P.value)).then(({data:t})=>{e.value.orders=t.result,e.value.isLoading=!1}).catch(t=>{console.log(t),e.value.isLoading=!1})}function x(t){u("destroy-orders")&&(e.value.isLoading=!0,axios.delete(route("api.orders.destroy",t)).then(()=>{e.value.isLoading=!1,n(),e.value.isActiveEditModal&&v(),c({title:"Success!",icon:"success"})}).catch(o=>{console.log(o),c({title:"Error!",icon:"error"})}))}function w(t,o){axios.get(route("api.orders.edit",t)).then(({data:i})=>{e.value.orderModal.index=o,e.value.orderModal=i.result,v()}).catch(i=>console.log(i))}function $(){u("edit-orders")&&axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal).then(()=>{v(),n(),c({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),c({title:"Error!",icon:"error"})})}function v(){e.value.isActiveEditModal=!e.value.isActiveEditModal}return(t,o)=>{const i=s("loader-component"),D=s("sidebar-item"),N=s("sidebar-component"),O=s("search-component"),I=s("pagination"),U=s("auth-layout");return r(),p(U,{title:"\u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F"},{header:m(()=>[Y]),default:m(()=>[e.value.isLoading?(r(),p(i,{key:0})):y("",!0),!e.value.isLoading&&k(u)("show-orders")?(r(),L("div",q,[g("div",H,[g("div",J,[_(N,null,{default:m(()=>[d.value.length?(r(!0),L(K,{key:0},R(d.value,l=>(r(),p(D,{onClick:Z=>C(l.key),active:e.value.sidebarActive===l.key},{default:m(()=>[E(T(l.title),1)]),_:2},1032,["onClick","active"]))),256)):y("",!0)]),_:1})]),g("div",Q,[_(O,{onSearch:B,clear:!0,placeholder:"\u0406\u043C\u02BC\u044F, \u043F\u0440\u0456\u0437\u0432\u0438\u0449\u0435, \u0442\u0435\u043B\u0435\u0444\u043E\u043D, \u043D\u0430\u043A\u043B\u0430\u0434\u043A\u0430, \u043A\u043E\u043C\u0435\u043D\u0442\u0430\u0440..."}),_(z,{data:e.value.orders.data,onOnEdit:w,onOnDestroy:x,statuses:M.statuses},null,8,["data","statuses"]),g("div",W,[_(I,{pagination:e.value.orders,"click-handler":F,modelValue:e.value.currentPage,"onUpdate:modelValue":o[0]||(o[0]=l=>e.value.currentPage=l)},null,8,["pagination","modelValue"])])])]),(r(),p(X(k(S)),{order:e.value.orderModal,statuses:f.statuses,paymentMethods:f.payment_methods,size:"extralarge",onCloseModal:v,onDeclineForm:x,onSubmitForm:$,onSubmitItemForm:V},null,40,["order","statuses","paymentMethods"]))])):y("",!0)]),_:1})}}};export{le as default};
