import{p as E,q as P,m as h,w as F,E as L,a8 as k,o as f,i as l,x as y,g as N,s as I,u as T,F as W,j as w,I as O}from"./vendor.aefaaf5e.js";import S from"./Loader.45f9d1a7.js";import D from"./PersonalData.d4c3bb04.js";import U from"./Delivery.b3b93d82.js";import B from"./Payment.1fdb0ad1.js";import M from"./OrderItem.eeacdc95.js";import R from"./Comment.d9f9034d.js";import q from"./CheckoutTotal.b3981900.js";import{i as V,_ as H}from"./load.a7bf59d5.js";import{C as b,h as $}from"./index.898db34c.js";import{s as j}from"./swal.1147426a.js";import"./__commonjsHelpers__.488ed5c2.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./Label.7d866754.js";import"./Input.f9018368.js";import"./InputError.c3ba17e3.js";import"./maska.esm.2315e0de.js";import"./Button.8ea31d3d.js";import"./Header.696833fd.js";import"./vue.m.8e70aa70.js";import"./CartIcon.562737bb.js";import"./Langs.a251c5f0.js";import"./Logo.9cbb3071.js";import"./HeaderCategories.c53a540e.js";import"./create-element-if-not-defined.26147364.js";import"./pagination.44308c03.js";import"./lazy.2bfe2e68.js";import"./autoplay.88899761.js";import"./swiper-slide.63205cf8.js";import"./Footer.8749869b.js";import"./FixedBanner.a21fb294.js";import"./ScrollToTop.055414eb.js";function o(){}var v=null;o.prototype.build=54;o.prototype.name="WFPWidget";o.prototype.defaultTarget="https://secure.wayforpay.com";o.prototype.getTargetHost=function(){var t=document.getElementById("widget-wfp-script"),i,e;return this.target?this.target:t?(t.getAttribute.length!==void 0?i=t.src:i=t.getAttribute("src"),e=document.createElement("a"),e.href=i,e.hostname=="secure.wayforpay.com"?this.target=this.defaultTarget:this.target=e.protocol+"//"+e.hostname,this.target):this.defaultTarget};o.prototype.isVerify=function(){return this.requestType=="VERIFY"};o.prototype.getPayUrl=function(){return this.isVerify()?this.getTargetHost()+"/verify"+(this.skin?"/"+this.skin:""):this.getTargetHost()+"/pay"+(this.skin?"/"+this.skin:"")};o.prototype.run=function(t,i,e,n,a){var u=this,m=t.hasOwnProperty("theme")?t.theme:!1;this.uuid=_(),v=this.uuid,this.postFields=t,this.straightWidget=t.hasOwnProperty("straightWidget")?t.straightWidget:!1,this.makeRedirect=t.hasOwnProperty("makeRedirect")?t.makeRedirect:!1,this.requestType=t.hasOwnProperty("requestType")?t.requestType:!1,this.skin=m||(this.makeRedirect?"":this.isVerify()?"verify_compact":"compact"),this.postFields.clientStartTime=Date.now(),this.isMobile=/Android|webOS|iPhone|iPod|BlackBerry|BB10|IEMobile|Opera Mini/i.test(navigator.userAgent),this.isSafari=navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")<0,this.makeRedirect?this.submitData("pre"):this.isMobile&&!this.straightWidget?this.submitData("page"):(this.createContainer(),this.createOverlay(),this.createFrame(),u.frame.contentWindow.focus(),this.onApproved=i,this.onDeclined=e,this.onPending=n,this.onUnknown=a,window.addEventListener("message",function(g){u.widgetListener(u,g)}))};o.prototype.invoice=function(t,i){var e=this;this.uuid=_(),v=this.uuid,this.isMobile=/Android|webOS|iPhone|iPod|BlackBerry|BB10|IEMobile|Opera Mini/i.test(navigator.userAgent),this.isSafari=navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")<0,this.isMobile&&!i?window.location.href=t:(this.createContainer(),this.createOverlay(),this.createFrameUrl(t),e.frame.contentWindow.focus(),window.addEventListener("message",function(n){e.widgetListener(e,n)}))};o.prototype.widgetListener=function(t,i){var e;if(i.origin!=t.getTargetHost(),v===t.uuid){if(i.data=="WfpWidgetEventClose"){var n=document.getElementById("wfp-container");n&&n.parentNode.removeChild(n),document.body.classList.remove("wfp-widget-open")}else if(i.data=="WfpWidgetEventLoaded")t.overlay.classList.remove("loader"),t.isMobile&&t.isSafari&&(t.overlay.style.display="none");else if(i.data=="WfpWidgetEventFadeOutOverlay")t.frame.classList.add("secure");else if(i.data=="WfpWidgetEventFadeInOverlay")t.frame.classList.remove("secure"),t.overlay.classList.add("loader");else if(i.data=="WfpWidgetEventComplete3d")t.frame.classList.remove("secure"),t.overlay.classList.add("loader"),J(t.frame);else if(i.data!="WfpWidgetEventApproved"){if(i.data!="WfpWidgetEventDeclined"){if(i.data!="WfpWidgetEventPending")try{if(e=JSON.parse(i.data),"reasonCode"in e){if(e.clientStartTime&&e.clientStartTime!=this.postFields.clientStartTime)return;e.reasonCode==1100?typeof this.onApproved=="function"&&this.onApproved(e):e.reasonCode==1134||e.reasonCode==1131?typeof this.onPending=="function"&&this.onPending(e):typeof this.onDeclined=="function"&&(this.onDeclined(e),console.log(e.reasonCode+" "+e.reason))}else"pay_way"in e&&e.pay_way=="privat24"?this.submitForm("https://api.privatbank.ua/p24api/ishop",e):"paytype"in e&&e.paytype=="privat24New"?this.submitForm("https://www.liqpay.ua/api/checkout",e):"paytype"in e&&e.paytype=="lpTerminal"?this.submitForm("https://www.liqpay.ua/api/checkout",e):typeof this.onUnknown=="function"&&this.onUnknown(data)}catch{}}}}};o.prototype.closeit=function(){this.container&&this.container.parentNode&&(this.container.parentNode.removeChild(this.container),this.container=null,document.body.classList.remove("wfp-widget-open"))};o.prototype.createContainer=function(){var t=document.getElementById("wfp-container"),i=document.getElementById("wfp-styles");if(!i){var e=document.createElement("link");e.href=this.getTargetHost()+"/server/pay-widget.min.css?b="+this.build,e.setAttribute("id","wfp-styles"),e.type="text/css",e.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(e)}t&&t.parentNode.removeChild(t),this.container=document.createElement("div"),this.container.setAttribute("id","wfp-container"),this.container.classList.add("wfp-widget-container"),this.isMobile&&this.isSafari&&this.container.classList.add("wfp-container-scroll-fix"),document.body.appendChild(this.container),document.body.classList.add("wfp-widget-open")};o.prototype.createOverlay=function(){this.overlay=document.createElement("div"),this.overlay.classList.add("wfp-widget-overlay"),this.overlay.classList.add("loader"),this.container.appendChild(this.overlay)};o.prototype.createFrame=function(){this.frame=document.createElement("iframe"),this.frame.setAttribute("name",this.name+"Frame"),this.frame.setAttribute("src","about:blank"),this.frame.setAttribute("allowpaymentrequest","true"),this.frame.setAttribute("frameborder","0"),this.frame.classList.add("wfp-widget-frame"),this.isMobile&&this.isSafari&&this.frame.classList.add("wfp-frame-scroll-fix"),this.container.appendChild(this.frame),this.submitData("frame")};o.prototype.createFrameUrl=function(t){this.frame=document.createElement("iframe"),this.frame.setAttribute("name",this.name+"Frame"),this.frame.setAttribute("src",t+"?behavior=frame&build="+this.build),this.frame.setAttribute("allowpaymentrequest","true"),this.frame.setAttribute("frameborder","0"),this.frame.classList.add("wfp-widget-frame"),this.isMobile&&this.isSafari&&this.frame.classList.add("wfp-frame-scroll-fix"),this.container.appendChild(this.frame)};o.prototype.submitData=function(t){var i=document.createElement("form"),e,n,a,u,m=document.getElementsByTagName("body")[0];i.style.cssText="display: none;",i.setAttribute("name",this.name+"Form"),i.setAttribute("action",this.getPayUrl()+(t?"?behavior="+t+"&build="+this.build:"?build="+this.build)),i.setAttribute("method","POST"),i.setAttribute("accept-charset","utf-8"),t==="frame"&&i.setAttribute("target",this.name+"Frame"),e=document.createElement("input"),e.setAttribute("type","submit"),i.appendChild(e);for(n in this.postFields)if(this.postFields.hasOwnProperty(n))if(this.postFields[n]instanceof Array){a=this.postFields[n];for(u in a)a.hasOwnProperty(u)&&(e=document.createElement("input"),e.setAttribute("type","text"),e.setAttribute("name",n+"[]"),e.setAttribute("value",a[u]),i.appendChild(e))}else e=document.createElement("input"),e.setAttribute("type","text"),e.setAttribute("name",n),e.setAttribute("value",this.postFields[n]),i.appendChild(e);t==="frame"?this.container.appendChild(i):m.appendChild(i),i.submit()};o.prototype.submitForm=function(t,i){var e=document.createElement("form"),n,a,u=document.getElementsByTagName("body")[0];e.setAttribute("name",this.name+"FreeForm"),e.setAttribute("action",t),e.setAttribute("method","POST"),e.setAttribute("accept-charset","UTF-8"),n=document.createElement("input"),n.setAttribute("type","submit"),e.appendChild(n);for(a in i)i.hasOwnProperty(a)&&(n=document.createElement("input"),n.setAttribute("type","text"),n.setAttribute("name",a),n.setAttribute("value",i[a]),e.appendChild(n));u.appendChild(e),e.submit()};function J(t){t.style.display="none",setTimeout(function(){t.style.display="block",t.classList.add("redraw")},500)}function _(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=Math.random()*16|0,e=t=="x"?i:i&3|8;return e.toString(16)})}const z=["onSubmit"],G={class:"grid grid-cols-1 md:grid-cols-2 relative gap-4"},Y={class:""},K={class:"cart-item__right row mb-3"},Q=l("h3",{class:"text-2xl font-heading mb-[1rem]"},"\u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F",-1),X={class:"grid gap-4"},Ie={__name:"Index",props:["lang","eventIdInitiateCheckout","eventIdPurchase","categories","options","pages","eventIdPageView"],setup(t){const i=t,e=L(),n=k(),a=E({order:{name:null,last_name:null,middle_name:null,email:null,comment:null,phone:null,city:null,postal_office:null,payment_method:null,event_id:i.eventIdPurchase},errors:[],contentIds:[],ga4ProductsArray:[],isLoading:!1});P(()=>{{e.state.list.forEach(r=>{a.value.contentIds.push(r.id),a.value.ga4ProductsArray.push({item_name:r.name.ua?r.name.ua:r.name.ru,item_id:r.id,price:r.discount_price?r.discount_price:r.price,quantity:r.count})});try{fbq("track","InitiateCheckout",{value:e.state.totalPrice,currency:"UAH",num_items:e.state.totalCount,content_ids:a.value.contentIds,content_type:"product"},i.eventIdInitiateCheckout),n.trackEvent({event:"start_checkout",ecommerce:{items:a.value.ga4ProductsArray}})}catch(r){console.log(r)}}V.value=!1});function u(r){const p=new o,c={names:[],prices:[],counts:[],amount:null};r.items.forEach(d=>{c.names.push(d.product.h1.ua?d.product.h1.ua:d.product.h1.ru),c.counts.push(d.count)}),r.payment_method==="minimum_prepayment"?(c.amount=r.total_price*.1,r.items.forEach(d=>{c.prices.push(d.sale_price*.1)})):r.payment_method==="full_prepayment"&&(c.amount=r.total_price,r.items.forEach(d=>{c.prices.push(d.sale_price)}));let s={merchantAccount:"dabango_store",merchantDomainName:"dabango.store",orderReference:"loc"+r.id,orderDate:Math.floor(new Date(r.created_at).getTime()/1e3),amount:c.amount,currency:"UAH",productName:c.names,productPrice:c.prices,productCount:c.counts,clientFirstName:r.client.name,clientLastName:r.client.last_name,clientPhone:r.client.phone,language:"UA",deliveryList:"nova",returnUrl:route("api.v1.orders.set-prepayment")},x=Object.values({merchantAccount:s.merchantAccount,merchantDomainName:s.merchantDomainName,orderReference:s.orderReference,orderDate:s.orderDate,amount:s.amount,currency:s.currency,productName:s.productName.join(";"),productCount:s.productCount.join(";"),productPrice:s.productPrice.join(";")}).join(";"),C=b.enc.Utf8.stringify(b.enc.Utf8.parse($(x,"4acdf560d56f56cde24ec0278a7f2676c5020f94")));p.run({merchantAccount:s.merchantAccount,merchantDomainName:s.merchantDomainName,authorizationType:"SimpleSignature",merchantSignature:C,orderReference:s.orderReference,orderDate:s.orderDate,amount:s.amount,currency:s.currency,productName:s.productName,productPrice:s.productPrice,productCount:s.productCount,clientFirstName:s.clientFirstName,clientLastName:s.clientLastName,clientPhone:s.clientPhone,language:s.language,returnUrl:s.returnUrl},function(d){m(d,r)},function(d){},function(d){})}function m(r,p){window.addEventListener("message",function(){event.data==="WfpWidgetEventApproved"&&axios.post(route("api.v1.orders.set-prepayment",r)).then(({data:c})=>{window.location.href=route("thanks",p.id)})},!1)}const g=async()=>{a.value.isLoading=!0,a.value.errors=[],await axios.post(route("api.v1.orders.create"),a.value.order).then(async({data:r})=>{try{fbq("track","Purchase",{value:e.state.totalPrice,currency:"UAH",content_type:"product",num_items:e.state.totalCount,content_ids:a.value.contentIds},i.eventIdPurchase),n.trackEvent({event:"send_order",ecommerce:{transaction_id:r.order.id,value:r.order.total_price,currency:"UAH",items:a.value.ga4ProductsArray}})}catch(p){console.log(p)}await axios.post(route("sms.new.order"),{order_id:r.order.id,phone:r.order.client.phone}),r.order.payment_method==="minimum_prepayment"||r.order.payment_method==="full_prepayment"?u(r.order):window.location.href=route("thanks",r.order.id),a.value.isLoading=!1}).catch(({response:r})=>{console.log(r),a.value.errors=r.data,a.value.isLoading=!1,j({icon:"error",title:"\u0412\u0438\u043D\u0438\u043A\u043B\u0430 \u043F\u043E\u043C\u0438\u043B\u043A\u0430",text:"\u041F\u0435\u0440\u0435\u0432\u0456\u0440\u0442\u0435 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u0456\u0442\u044C \u0434\u0430\u043D\u043D\u0438\u0445"})})};function A(){}return(r,p)=>(f(),h(H,{categories:t.categories,options:t.options,lang:t.lang,pages:t.pages,eventIdPageView:t.eventIdPageView},{default:F(()=>[l("form",{onSubmit:O(g,["prevent"])},[l("div",G,[l("div",null,[y(D,{order:a.value.order,errors:a.value.errors},null,8,["order","errors"]),y(U,{order:a.value.order},null,8,["order"]),y(B,{order:a.value.order},null,8,["order"]),y(R,{order:a.value.order},null,8,["order"])]),l("div",Y,[l("div",K,[Q,l("div",X,[(f(!0),N(W,null,I(T(e).state.list,c=>(f(),h(M,{item:c,onRemoveFromCart:A},null,8,["item"]))),256))]),a.value.isLoading?(f(),h(S,{key:0})):w("",!0),a.value.isLoading?w("",!0):(f(),h(q,{key:1}))])])])],40,z)]),_:1},8,["categories","options","lang","pages","eventIdPageView"]))}};export{Ie as default};
