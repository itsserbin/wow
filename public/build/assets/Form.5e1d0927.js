import{az as $,y as X,C as Y,z as O,L as f,M as l,K as d,X as M,_ as V,ac as j,a0 as c,bg as E,P as I,O as U,Y as k,B as A,V as h,S as r}from"./___vite-browser-external_commonjs-proxy.f18235ae.js";import q from"./ItemsModal.fddb9cee.js";import G from"./ItemsTable.20f7a276.js";import H from"./ClientOrders.f70d97ed.js";import J from"./Table.81121d83.js";import Q from"./Modal.6de2bc9d.js";import"./ItemsForm.f2dfd632.js";import"./Form.a91698b7.js";const Z={class:"grid gap-4"},_={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ee={class:"block"},oe={class:"block"},te={class:"block"},le={class:"block"},de=k(" \u041A\u0430\u0440\u0442\u043A\u0430 \u043A\u043B\u0456\u0454\u043D\u0442\u0430 "),se={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ie={class:"block"},ne={class:"block"},ae={key:0,class:"block"},re=l("hr",null,null,-1),ue={class:"grid grid-cols-1 md:grid-cols-4 mb-5"},me={class:"block mb-5 md:mr-5"},ce={class:"block mb-5 md:mr-5"},ve={class:"block mb-5 md:mr-5"},ye={class:"block mb-5"},be={class:"grid grid-cols-1 md:grid-cols-2 mb-10"},fe={class:"block md:mr-5"},Ve={class:"block mb-5"},he={class:"block mb-5"},ke={class:"block"},ge={key:0},xe={key:1},we=k(" \u0422\u0422\u041D \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 ("),pe=k(") "),Me={class:"block"},Ie={class:"mb-7"},Ue={class:"grid grid-cols-2"},Ce={class:"block mb-5 mr-5"},Fe={class:"block mb-5"},$e={class:"grid grid-cols-2"},Oe={class:"block mb-5 mr-5"},je={class:"block mb-5"},Ee={key:2},Ae={class:"grid grid-cols-2"},Be={class:"block mb-5 mr-5"},De={class:"block mb-5"},Se={class:"block mb-5"},ze=k("\u0414\u043E\u0434\u0430\u0442\u0438 \u0442\u043E\u0432\u0430\u0440"),Ne={class:"grid grid-cols-1 md:grid-cols-3 mt-5"},Te={class:"flex justify-center"},Le=l("p",{class:"font-semibold text-l text-gray-900 dark:text-white"}," \u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u0442\u043E\u0432\u0430\u0440\u0456\u0432:\xA0 ",-1),Pe={class:"text-l text-gray-900 dark:text-white"},Ke={class:"flex justify-center"},Re=l("p",{class:"font-semibold text-l text-gray-900 dark:text-white"}," \u0417\u0430\u0433\u0430\u043B\u044C\u043D\u0430 \u0446\u0456\u043D\u0430:\xA0 ",-1),We={class:"text-l text-gray-900 dark:text-white"},Xe={class:"flex justify-center"},Ye=l("p",{class:"font-semibold text-l text-gray-900 dark:text-white"}," \u041F\u0440\u043E\u043C\u043E-\u043A\u043E\u0434:\xA0 ",-1),qe={class:"text-l text-gray-900 dark:text-white"},Ge={class:"block"},He=k("\u0414\u043E\u0434\u0430\u0442\u0438 \u0440\u0430\u0445\u0443\u043D\u043E\u043A"),so={__name:"Form",props:["order","statuses","paymentMethods","invoiceStatuses"],emits:["submitItemForm","onEditClient"],setup(e,{emit:g}){const u=e,m=A("$swal"),w=A("$can"),C=$({order_id:u.order.id,sum:null}),i=X({showItemsModal:!1,showInvoicesModal:!1,itemsModalAction:"",item:{count:1,size:"",color:"",product_id:null},invoiceItem:{},statuses:[],managers:[],paymentMethods:[]});Y(()=>{P();for(const[s,o]of Object.entries(u.statuses))i.value.statuses.push({key:s,value:o});for(const[s,o]of Object.entries(u.paymentMethods))i.value.paymentMethods.push({key:s,value:o})});const B=O(()=>i.value.showItemsModal?q:null),D=O(()=>i.value.showInvoicesModal?Q:null),y=$([{key:0,value:"\u041D\u0456"},{key:1,value:"\u0422\u0430\u043A"}]);function x(){i.value.showInvoicesModal=!i.value.showInvoicesModal}function S(s){w("destroy-invoices")&&m({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(o=>{o.isConfirmed&&axios.delete(route("api.invoices.destroy",s)).then(()=>{g("submitItemForm"),m({icon:"success",title:"Destroyed!"})}).catch(n=>{console.log(n),m({icon:"error",title:"Error!"})})})}function z(){w("create-invoices")&&(i.value.invoiceItem=C,x())}function N(){axios.post(route("api.invoices.create"),i.value.invoiceItem).then(({data:s})=>{i.value.invoiceItem=C,x(),navigator.clipboard.writeText(s.result.data.invoice_url),m({title:"\u0423\u0441\u043F\u0456\u0448\u043D\u043E!",text:"\u0420\u0430\u0445\u0443\u043D\u043E\u043A \u0431\u0443\u0432 \u0443\u0441\u043F\u0456\u0448\u043D\u043E \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u0438\u0439, \u043F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F \u043D\u0430 \u043E\u043F\u043B\u0430\u0442\u0443 \u0441\u043A\u043E\u043F\u0456\u0439\u043E\u0432\u0430\u043D\u043E \u0432 \u0431\u0443\u0444\u0435\u0440 \u043E\u0431\u043C\u0456\u043D\u0443",icon:"success"}),g("submitItemForm",s.result)}).catch(s=>{console.log(s),m({title:"Error!",icon:"error"})})}function F(){u.order.waybill&&axios.post(route("notify.waybill"),{phone:u.order.client.phone,waybill:u.order.waybill,order_id:u.order.id}).then(({data:s})=>{s.success===!0?m({icon:"success",title:"\u041D\u043E\u043C\u0435\u0440 \u043D\u0430\u043A\u043B\u0430\u0434\u043D\u043E\u0439 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D \u043A\u043B\u0438\u0435\u043D\u0442\u0443",text:s.info}):m({icon:"error",title:"\u041E\u0448\u0438\u0431\u043A\u0430",text:s.info}),axios.put(route("api.orders.update",u.order.id),u.order)}).catch(s=>{m({icon:"error",title:"\u041E\u0448\u0438\u0431\u043A\u0430",text:"\u041E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u043A \u0430\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\u0443"}),console.log(s)})}function T(){i.value.itemsModalAction==="create"?axios.post(route("api.order-items.add",u.order.id),i.value.item).then(({data:s})=>{b(),g("submitItemForm",s.result)}).catch(s=>console.log(s)):i.value.itemsModalAction==="edit"&&axios.put(route("api.order-items.update",i.value.item.id),i.value.item).then(({data:s})=>{b(),g("submitItemForm",s.result)}).catch(s=>console.log(s))}function L(){b(),i.value.itemsModalAction="create"}function b(){i.value.showItemsModal=!i.value.showItemsModal}function P(){axios.get(route("api.users.list.managers")).then(({data:s})=>{s.result.length&&s.result.forEach(o=>{i.value.managers.push({key:o.id,value:o.name})})}).catch(s=>console.log(s))}function K(s,o){m({title:"Are you sure?",icon:"warning",showCancelButton:!0}).then(n=>{n.isConfirmed&&axios.delete(route("api.order-items.destroy",{item_id:s,order_id:u.order.id})).then(()=>{u.order.items.splice(o,1),m({title:"Success",icon:"success"})}).catch(a=>{console.log(a),m({title:"Error",icon:"error"})})})}function R(s){b(),i.value.itemsModalAction="edit",axios.get(route("api.order-items.edit",s)).then(({data:o})=>i.value.item=o.result).catch(o=>console.log(o))}return(s,o)=>{const n=h("label-component"),a=h("input-component"),p=h("button-component"),v=h("select-component"),W=h("textarea-component");return r(),f("form",Z,[l("div",_,[l("div",ee,[d(n,{value:"\u0406\u043C\u02BC\u044F"}),d(a,{modelValue:e.order.client.name,"onUpdate:modelValue":o[0]||(o[0]=t=>e.order.client.name=t),type:"text",disabled:""},null,8,["modelValue"])]),l("div",oe,[d(n,{value:"\u041F\u0440\u0456\u0437\u0432\u0438\u0449\u0435"}),d(a,{modelValue:e.order.client.last_name,"onUpdate:modelValue":o[1]||(o[1]=t=>e.order.client.last_name=t),type:"text",disabled:""},null,8,["modelValue"])]),l("div",te,[d(n,{value:"\u041F\u043E-\u0431\u0430\u0442\u044C\u043A\u043E\u0432\u0456"}),d(a,{modelValue:e.order.client.middle_name,"onUpdate:modelValue":o[2]||(o[2]=t=>e.order.client.middle_name=t),type:"text",disabled:""},null,8,["modelValue"])]),l("div",le,[d(n,{value:"\xA0"}),d(p,{class:"w-full",type:"button",onClick:o[3]||(o[3]=t=>s.$emit("onEditClient"))},{default:M(()=>[de]),_:1})])]),l("div",se,[l("div",ie,[d(n,{value:"\u0421\u0442\u0430\u0442\u0443\u0441 \u043A\u043B\u0456\u0454\u043D\u0442\u0430"}),d(a,{modelValue:e.order.client.status,"onUpdate:modelValue":o[4]||(o[4]=t=>e.order.client.status=t),type:"text",disabled:""},null,8,["modelValue"])]),l("div",ne,[d(n,{value:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D"}),d(a,{modelValue:e.order.client.phone,"onUpdate:modelValue":o[5]||(o[5]=t=>e.order.client.phone=t),type:"text",disabled:""},null,8,["modelValue"])])]),e.order.client.orders.length>1?(r(),f("div",ae,[d(H,{data:e.order.client.orders,statuses:e.statuses},null,8,["data","statuses"])])):V("",!0),re,l("div",ue,[l("div",me,[d(n,{value:"\u0421\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F"}),d(v,{modelValue:e.order.status,"onUpdate:modelValue":o[6]||(o[6]=t=>e.order.status=t),options:i.value.statuses},null,8,["modelValue","options"])]),l("div",ce,[d(n,{value:"\u041C\u0435\u043D\u0435\u0434\u0436\u0435\u0440"}),d(v,{modelValue:e.order.manager_id,"onUpdate:modelValue":o[7]||(o[7]=t=>e.order.manager_id=t),options:i.value.managers},null,8,["modelValue","options"])]),l("div",ve,[d(n,{value:"\u0421\u043F\u043E\u0441\u0456\u0431 \u043E\u043F\u043B\u0430\u0442\u0438"}),d(v,{modelValue:e.order.payment_method,"onUpdate:modelValue":o[8]||(o[8]=t=>e.order.payment_method=t),options:i.value.paymentMethods},null,8,["modelValue","options"])]),l("div",ye,[d(n,{value:"\u041D\u0430\u0433\u0430\u0434\u0443\u0432\u0430\u043D\u043D\u044F \u043F\u0440\u043E \u043F\u043E\u0441\u0438\u043B\u043A\u0443"}),d(v,{modelValue:e.order.parcel_reminder,"onUpdate:modelValue":o[9]||(o[9]=t=>e.order.parcel_reminder=t),options:y},null,8,["modelValue","options"])])]),l("div",be,[l("div",fe,[l("div",Ve,[d(n,{value:"\u041C\u0456\u0441\u0442\u043E"}),d(a,{modelValue:e.order.city,"onUpdate:modelValue":o[10]||(o[10]=t=>e.order.city=t),type:"text"},null,8,["modelValue"])]),l("div",he,[d(n,{value:"\u041F\u043E\u0447\u0442\u043E\u0432\u0435 \u0432\u0456\u0434\u0434\u0456\u043B\u0435\u043D\u043D\u044F"}),d(a,{modelValue:e.order.postal_office,"onUpdate:modelValue":o[11]||(o[11]=t=>e.order.postal_office=t),type:"text"},null,8,["modelValue"])]),l("div",ke,[d(n,{value:"\u041D\u043E\u043C\u0435\u0440 \u043D\u0430\u043A\u043B\u0430\u0434\u043D\u043E\u0457"}),d(a,{modelValue:e.order.waybill,"onUpdate:modelValue":o[12]||(o[12]=t=>e.order.waybill=t),type:"text"},null,8,["modelValue"]),!e.order.sms_waybill_status&&e.order.waybill?(r(),f("div",ge,[l("a",{href:"javascript:",onClick:o[13]||(o[13]=j(t=>F(e.order.client.phone,e.order.waybill),["prevent"]))},"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u0422\u0422\u041D \u043A\u043B\u0438\u0435\u043D\u0442\u0443")])):V("",!0),e.order.sms_waybill_status?(r(),f("div",xe,[we,l("a",{href:"javascript:",onClick:o[14]||(o[14]=j(t=>F(e.order.client.phone,e.order.waybill),["prevent"]))},"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E"),pe])):V("",!0)])]),l("div",Me,[d(n,{value:"\u041A\u043E\u043C\u0435\u043D\u0442\u0430\u0440"}),d(W,{rows:"10",modelValue:e.order.comment,"onUpdate:modelValue":o[15]||(o[15]=t=>e.order.comment=t)},null,8,["modelValue"])])]),l("div",Ie,[l("div",Ue,[l("div",Ce,[d(n,{value:"\u0414\u043E\u0434.\u043F\u0440\u043E\u0434\u0430\u0436 \u043F\u043E\u0432\u0456\u0442\u0440\u044F"}),d(v,{modelValue:e.order.sale_of_air,"onUpdate:modelValue":o[16]||(o[16]=t=>e.order.sale_of_air=t),options:y},null,8,["modelValue","options"])]),l("div",Fe,[d(n,{value:"\u0421\u0443\u043C\u0430 \u0434\u043E\u043F.\u043F\u0440\u043E\u0434\u0430\u0436\u0443 \u043F\u043E\u0432\u0456\u0442\u0440\u044F (\u0433\u0440\u043D.)"}),e.order.sale_of_air?(r(),c(a,{key:0,modelValue:e.order.sale_of_air_price,"onUpdate:modelValue":o[17]||(o[17]=t=>e.order.sale_of_air_price=t),type:"number"},null,8,["modelValue"])):(r(),c(a,{key:1,modelValue:e.order.sale_of_air_price,"onUpdate:modelValue":o[18]||(o[18]=t=>e.order.sale_of_air_price=t),type:"number",disabled:""},null,8,["modelValue"]))])]),l("div",$e,[l("div",Oe,[d(n,{value:"\u041F\u0435\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0430"}),e.order.wfp_payment?(r(),c(v,{key:1,modelValue:e.order.prepayment,"onUpdate:modelValue":o[20]||(o[20]=t=>e.order.prepayment=t),options:y,disabled:""},null,8,["modelValue","options"])):(r(),c(v,{key:0,modelValue:e.order.prepayment,"onUpdate:modelValue":o[19]||(o[19]=t=>e.order.prepayment=t),options:y},null,8,["modelValue","options"]))]),l("div",je,[d(n,{value:"\u0421\u0443\u043C\u0430 \u043F\u0435\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0438 (\u0433\u0440\u043D.)"}),e.order.prepayment&&!e.order.wfp_payment?(r(),c(a,{key:0,modelValue:e.order.prepayment_sum,"onUpdate:modelValue":o[21]||(o[21]=t=>e.order.prepayment_sum=t),type:"number"},null,8,["modelValue"])):(r(),c(a,{key:1,modelValue:e.order.prepayment_sum,"onUpdate:modelValue":o[22]||(o[22]=t=>e.order.prepayment_sum=t),type:"number",disabled:""},null,8,["modelValue"])),e.order.wfp_payment?(r(),f("span",Ee,"\u041E\u043F\u043B\u0430\u0447\u0435\u043D\u043E \u043D\u0430 \u0441\u0430\u0439\u0442\u0456")):V("",!0)])]),l("div",Ae,[l("div",Be,[d(n,{value:"\u0417\u043D\u0438\u0436\u043A\u0430"}),d(v,{modelValue:e.order.discount,"onUpdate:modelValue":o[23]||(o[23]=t=>e.order.discount=t),options:y},null,8,["modelValue","options"])]),l("div",De,[d(n,{value:"\u0421\u0443\u043C\u0430 \u0437\u043D\u0438\u0436\u043A\u0438 (\u0433\u0440\u043D.)"}),e.order.discount?(r(),c(a,{key:0,modelValue:e.order.discount_sum,"onUpdate:modelValue":o[24]||(o[24]=t=>e.order.discount_sum=t),type:"number"},null,8,["modelValue"])):(r(),c(a,{key:1,modelValue:e.order.discount_sum,"onUpdate:modelValue":o[25]||(o[25]=t=>e.order.discount_sum=t),type:"number",disabled:""},null,8,["modelValue"]))])])]),l("div",Se,[d(p,{type:"button",onClick:L},{default:M(()=>[ze]),_:1}),(r(),c(E(I(B)),{item:i.value.item,size:"medium",onCloseModal:b,onSubmitItemForm:T},null,40,["item"]))]),d(G,{data:e.order.items,onEditOrderItem:R,onDestroyOrderItem:K},null,8,["data"]),l("div",Ne,[l("div",Te,[Le,l("p",Pe,U(e.order.total_count),1)]),l("div",Ke,[Re,l("p",We,U(s.$filters.formatMoney(e.order.total_price)),1)]),l("div",Xe,[Ye,l("p",qe,U(e.order.promo_code?e.order.promo_code:"\u0412\u0456\u0434\u0441\u0443\u0442\u043D\u0456\u0439"),1)])]),l("div",Ge,[d(p,{type:"button",onClick:z,class:"my-4"},{default:M(()=>[He]),_:1}),e.order.invoices.length?(r(),c(J,{key:0,data:e.order.invoices,statuses:e.invoiceStatuses,"can-destroy":I(w)("destroy-invoices"),onOnDestroy:S},null,8,["data","statuses","can-destroy"])):V("",!0),(r(),c(E(I(D)),{item:i.value.invoiceItem,onCloseModal:x,onSubmitForm:N,onDeclineForm:x},null,40,["item"]))])])}}};export{so as default};
