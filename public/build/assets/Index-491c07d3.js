import{_}from"./Button-dd1aed97.js";import{_ as C}from"./Paginate-01527c78.js";import{_ as w}from"./Card-d700085f.js";import{_ as i}from"./Label-20131f4c.js";import{L as M}from"./Loader-ccf6e4ba.js";import N from"./StatisticLayout-af991e7b.js";import B from"./Datepicker-1dfd351e.js";import D from"./Table-ec27ff96.js";import{M as A}from"./Multiselect-a4b04608.js";import{s as S,e as U}from"./index-7a810988.js";import{N as j,k as d,z as g,o as E,l as n,s as p,y as c,w as m,t as h,x as F,m as k,p as r,n as s,F as I,q as O}from"./index-a01126e2.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./AuthenticatedLayout-704e8f94.js";import"./index.esm-02fff71f.js";import"./Logo-83ffc10f.js";import"./SidebarItem-446a46b0.js";import"./isDark-c828c264.js";import"./vue-datepicker-3bdc29fb.js";import"./index-2cbe9ca3.js";import"./Table-fe1ca8dd.js";const q={key:1,class:"grid grid-cols-1 gap-4"},z={class:"grid grid-cols-1 md:grid-cols-12 gap-4 mt-5"},T={class:"block col-span-2 text-center"},G={class:"block col-span-4"},H={class:"block col-span-4"},J={class:"block col-span-2 text-center"},K={class:"grid grid-cols-2 md:grid-cols-4"},Q={class:"text-center"},_e={__name:"Index",setup(R){const x=j("$can"),t=d({data:[],products:[],chart:null,isLoading:!0}),v=d([]),a=d({date:[],currentPage:1}),f=g(()=>{let e=[];return t.value.products.forEach(o=>{e.push(o.id)}),e.join()}),V=g(()=>{const e={};return a.value.date.length===2&&(e.date_start=a.value.date[0].toLocaleDateString(),e.date_end=a.value.date[1].toLocaleDateString()),f.value&&(e.products=f.value),e.page=a.value.currentPage,e});E(()=>{a.value.date[0]=S(new Date),a.value.date[1]=U(new Date),u(),axios.get(route("api.products.list")).then(({data:e})=>v.value=e.result).catch(e=>console.log(e))});function L(){a.value.date=[],t.value.products=[],u()}function b({h1:e,id:o}){return e.ua?e.ua+` (${o})`:e.ru?e.ru+` (${o})`:o}function $(e){e&&(a.value.currentPage=e),u()}function y(){a.value.currentPage=1,u()}function u(){t.value.isLoading=!0,axios.get(route("api.statistics.products.index",V.value)).then(({data:e})=>{t.value.data=e,t.value.isLoading=!1}).catch(e=>{console.log(e),t.value.isLoading=!1})}return(e,o)=>(n(),p(N,{title:"Статистика товарів"},{header:c(()=>[m(" Статистика товарів ")]),default:c(()=>[t.value.isLoading?(n(),p(M,{key:0})):h("",!0),!t.value.isLoading&&F(x)("show-bookkeeping-marketing")?(n(),k("div",q,[r("div",z,[r("div",T,[s(i,{value:" "}),s(_,{type:"button",onClick:L},{default:c(()=>[m(" Очистити ")]),_:1})]),r("div",G,[s(i,{value:"Фільтр по даті"}),s(B,{modelValue:a.value.date,"onUpdate:modelValue":o[0]||(o[0]=l=>a.value.date=l)},null,8,["modelValue"])]),r("div",H,[s(i,{value:"Фільтр по менеджерам"}),s(A,{modelValue:t.value.products,"onUpdate:modelValue":o[1]||(o[1]=l=>t.value.products=l),options:v.value,"custom-label":b,placeholder:"Оберіть товари","track-by":"id",searchable:!0,"close-on-select":!1,multiple:""},null,8,["modelValue","options"])]),r("div",J,[s(i,{value:" "}),s(_,{type:"button",onClick:y},{default:c(()=>[m(" Пошук ")]),_:1})])]),r("div",K,[(n(!0),k(I,null,O(t.value.data.generalStat,(l,P)=>(n(),p(w,{class:"text-center",title:P,description:l||"0"},null,8,["title","description"]))),256))]),s(D,{data:t.value.data.result.data},null,8,["data"]),r("div",Q,[s(C,{pagination:t.value.data.result,"click-handler":$,modelValue:a.value.currentPage,"onUpdate:modelValue":o[2]||(o[2]=l=>a.value.currentPage=l)},null,8,["pagination","modelValue"])])])):h("",!0)]),_:1}))}};export{_e as default};
