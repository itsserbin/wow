import M from"./Modal-095b8087.js";import L from"./Table-7034fa42.js";import V from"./ContentLayout-6476cabf.js";import{L as B}from"./Loader-3f12bd2d.js";import{_ as b}from"./Paginate-7604e12b.js";import{_ as P}from"./Button-18e692de.js";import{C as n}from"./Form-a82bc186.js";import{u as F}from"./vue-i18n.esm-bundler-39f45a4f.js";import{s as l}from"./swal-76588f7d.js";import{i as N,G as j,r as E,o as O,j as I,p as u,D as d,x as p,A as f,B as w,C as v,t as m,q as S,v as _,l as y,J as U}from"./app-6d1ec759.js";import"./Modal-1e77e375.js";import"./LangTabs-75b411e7.js";import"./Table-d4015883.js";import"./XCircle-0fb660d3.js";import"./AuthenticatedLayout-53775af0.js";import"./index.esm-09a1b1ab.js";import"./Logo-7b0b10d2.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ImagesSelectModal-13ddc8c3.js";import"./UploadImagesModal-764d5655.js";import"./UploadImagesInput-b445dfef.js";import"./Label-646a10b8.js";import"./ImageCard-f6ab6853.js";import"./InputError-f9295872.js";import"./Input-335d7e3d.js";import"./Textarea-8cacefaf.js";import"./Select-ffba6ec3.js";import"./Editor-b0ed515a.js";const q={key:1,class:"grid gap-4 grid-cols-1"},G={class:"text-center"},_e={__name:"Index",setup(J){const a=N("$can"),{t:o}=F(),h=j({published:0,slug:null,parent_id:null,preview_id:null,preview:null,title:{ru:null,ua:null},meta_title:{ru:null,ua:null},meta_description:{ru:null,ua:null},meta_keyword:{ru:null,ua:null},seo_text:{ru:null,ua:null}}),e=E({categories:[],currentPage:1,isLoading:!0,isActiveModal:!1,modalAction:"",item:{},errors:[]});O(()=>{c(1)});const k=I(()=>e.value.isActiveModal?M:null),c=async t=>{e.value.isLoading=!0,t&&(e.value.currentPage=t);const i=await n.fetch({page:e.value.currentPage});e.value.categories=i.success?i.result:[],e.value.isLoading=!1},g=async t=>{if(a("destroy-categories")&&(await l({title:o("swal.sure"),icon:"warning",showCancelButton:!0})).isConfirmed){const{success:s}=await n.destroy(t);s&&(await c(),e.value.isActiveModal&&r(),await l({icon:"success",title:o("swal.destroyed")}))}},r=()=>{e.value.isActiveModal=!e.value.isActiveModal},A=async(t,i)=>{if(a("edit-categories")){const s=await n.edit(t);s.success&&(e.value.item=s.result,e.value.modalAction="edit",e.value.item.index=i,r())}},C=async()=>{if(a("edit-categories")){const t=await n.update(e.value.item);e.value.errors=[],t.success?(r(),await c(),await l({title:o("swal.updated"),icon:"success"})):(e.value.errors=t,console.log(t),await l({title:o("swal.error"),icon:"error",text:o("swal.check_data")}))}},D=async()=>{if(a("create-categories")){const t=await n.create(e.value.item);e.value.errors=[],t.success?(r(),e.value.item={},await c(),await l({title:o("swal.created"),icon:"success"})):(e.value.errors=t,console.log(t),await l({title:o("swal.error"),text:o("swal.check_data"),icon:"error"}))}},$=async()=>{e.value.modalAction==="edit"&&a("edit-categories")?await C():e.value.modalAction==="create"&&a("create-categories")&&await D()},x=()=>{a("create-categories")&&(Object.assign(e.value.item,h),e.value.modalAction="create",e.value.errors=[],r())};return(t,i)=>(u(),d(V,{title:t.$t("categories.page_title")},{header:p(()=>[f(w(t.$t("categories.page_title")),1)]),default:p(()=>[e.value.isLoading?(u(),d(B,{key:0})):v("",!0),!e.value.isLoading&&m(a)("show-categories")?(u(),S("div",q,[_("div",null,[m(a)("create-categories")?(u(),d(P,{key:0,type:"btn",onClick:x},{default:p(()=>[f(w(t.$t("add")),1)]),_:1})):v("",!0)]),y(L,{data:e.value.categories.data,onOnEdit:A,onOnDestroy:g,canDestroy:m(a)("destroy-categories")},null,8,["data","canDestroy"]),_("div",G,[y(b,{pagination:e.value.categories,"click-handler":c,modelValue:e.value.currentPage,"onUpdate:modelValue":i[0]||(i[0]=s=>e.value.currentPage=s)},null,8,["pagination","modelValue"])])])):v("",!0),(u(),d(U(m(k)),{item:e.value.item,errors:e.value.errors,onCloseModal:r,onSubmitForm:$,onDeclineForm:g,canDestroy:m(a)("destroy-categories")},null,40,["item","errors","canDestroy"]))]),_:1},8,["title"]))}};export{_e as default};
