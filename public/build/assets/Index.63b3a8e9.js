import j from"./Modal.92b88877.js";import z from"./Table.1a7dfaba.js";import{y,z as L,G,W as m,U as p,Y as n,S as i,a0 as M,P as g,L as E,M as f,K as _,F as K,V as T,Z as C,O as W,be as Y,D as A}from"./moment.325cf309.js";import"./Form.de3dca85.js";import"./ItemsModal.ff619ef7.js";import"./ItemsForm.ef7ad969.js";import"./ItemsTable.ceb00bfd.js";import"./ClientOrders.99d80344.js";const Z=C(" \u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F "),q={key:1},H={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},J={class:"md:col-span-1"},Q={class:"w-full md:col-span-4 grid gap-4 grid-cols-1"},R={class:"text-center"},le={__name:"Index",props:["statuses","payment_methods"],setup(x){const h=x,e=y({orders:[],currentPage:1,isLoading:!0,isActiveEditModal:!1,sidebarActive:"all",orderModal:{}}),u=y([]),l=A("$swal"),r=A("$can"),a=y({status:null,currentPage:1}),D=L(()=>{const t={};return t.page=a.value.currentPage,a.value.status&&(t.status=a.value.status),t});G(()=>{d(),u.value.push({title:"\u0412\u0441\u0456 \u0437\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F",key:"all"});for(const[t,o]of Object.entries(h.statuses))u.value.push({title:o,key:t});route().params.id&&(e.value.isLoading=!0,k(route().params.id))});const P=L(()=>e.value.isActiveEditModal?j:null);function S(t){r("edit-orders")&&(axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal),axios.get(route("api.orders.edit",t.order_id)).then(({data:o})=>e.value.orderModal=o.result).catch(o=>console.log(o)))}function V(t){e.value.sidebarActive=t,t==="all"?a.value.status=null:a.value.status=t,d()}function w(t){t&&(a.value.currentPage=t),d()}function F(t){axios.get(route("api.orders.search",t)).then(({data:o})=>{e.value.sidebarActive=null,a.value.currentPage=1,e.value.orders=o.result,e.value.isLoading=!1}).catch(o=>{console.log(o),e.value.isLoading=!1})}function d(){axios.get(route("api.orders.index",D.value)).then(({data:t})=>{e.value.orders=t.result,e.value.isLoading=!1}).catch(t=>{console.log(t),e.value.isLoading=!1})}function b(t){r("destroy-orders")&&l({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(o=>{o.isConfirmed&&axios.delete(route("api.orders.destroy",t)).then(()=>{e.value.isLoading=!1,d(),e.value.isActiveEditModal&&v(),l({title:"Success!",icon:"success"})}).catch(s=>{console.log(s),l({title:"Error!",icon:"error"})})})}function k(t,o){axios.get(route("api.orders.edit",t)).then(({data:s})=>{e.value.orderModal.index=o,e.value.orderModal=s.result,v(),e.value.isLoading=!1}).catch(s=>console.log(s))}function B(){r("edit-orders")&&axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal).then(()=>{v(),d(),l({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),l({title:"Error!",icon:"error"})})}function v(){e.value.isActiveEditModal=!e.value.isActiveEditModal}return(t,o)=>{const s=n("loader-component"),$=n("sidebar-item"),N=n("sidebar-component"),O=n("search-component"),I=n("pagination"),U=n("auth-layout");return i(),m(U,{title:"\u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F"},{header:p(()=>[Z]),default:p(()=>[e.value.isLoading?(i(),m(s,{key:0})):M("",!0),!e.value.isLoading&&g(r)("show-orders")?(i(),E("div",q,[f("div",H,[f("div",J,[_(N,null,{default:p(()=>[u.value.length?(i(!0),E(K,{key:0},T(u.value,c=>(i(),m($,{onClick:X=>V(c.key),active:e.value.sidebarActive===c.key},{default:p(()=>[C(W(c.title),1)]),_:2},1032,["onClick","active"]))),256)):M("",!0)]),_:1})]),f("div",Q,[_(O,{onSearch:F,clear:!0,placeholder:"\u0406\u043C\u02BC\u044F, \u043F\u0440\u0456\u0437\u0432\u0438\u0449\u0435, \u0442\u0435\u043B\u0435\u0444\u043E\u043D, \u043D\u0430\u043A\u043B\u0430\u0434\u043A\u0430, \u043A\u043E\u043C\u0435\u043D\u0442\u0430\u0440..."}),_(z,{data:e.value.orders.data,onOnEdit:k,onOnDestroy:b,statuses:x.statuses,canDestroy:g(r)("destroy-orders")},null,8,["data","statuses","canDestroy"]),f("div",R,[_(I,{pagination:e.value.orders,"click-handler":w,modelValue:e.value.currentPage,"onUpdate:modelValue":o[0]||(o[0]=c=>e.value.currentPage=c)},null,8,["pagination","modelValue"])])])]),(i(),m(Y(g(P)),{order:e.value.orderModal,statuses:h.statuses,paymentMethods:h.payment_methods,size:"extralarge",onCloseModal:v,onDeclineForm:b,onSubmitForm:B,onSubmitItemForm:S,canDestroy:g(r)("destroy-orders")},null,40,["order","statuses","paymentMethods","canDestroy"]))])):M("",!0)]),_:1})}}};export{le as default};
