import{L as V,b,j as E}from"./app.95816afc.js";import P from"./Modal.ab0d1b9d.js";import B from"./Table.7be4ef7e.js";import F from"./ContentLayout.451502c3.js";import{ae as N,af as j,p as I,q as O,f as S,m,w as g,v as y,o as u,k as _,t as h,j as w,u as d,g as U,i as v,x,ab as q}from"./vendor.aefaaf5e.js";import"./vue.m.8e70aa70.js";import"./bootstrap.a62f1e2e.js";import"./__commonjsHelpers__.488ed5c2.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./Logo.9cbb3071.js";import"./Form.965a7edb.js";const p={async fetch(s){try{return(await axios.get(route("api.pages.index",s))).data}catch(a){throw new Error(a.response.data)}},async destroy(s){try{return(await axios.delete(route("api.pages.destroy",s))).data}catch(a){throw new Error(a.response.data)}},async edit(s){try{return(await axios.get(route("api.pages.edit",s))).data}catch(a){throw new Error(a.response.data)}},async update(s){try{return(await axios.put(route("api.pages.update",s.id),s)).data}catch(a){return a.response.data}},async create(s){try{return(await axios.post(route("api.pages.create"),s)).data}catch(a){return a.response.data}}},R={key:1,class:"grid gap-4 grid-cols-1"},T={class:"text-center"},ae={__name:"Index",setup(s){const a=y("$swal"),o=y("$can"),{t:r}=N(),k=j({slug:null,published:0,heading:{ru:null,ua:null},h1:{ru:null,ua:null},content:{ru:null,ua:null},meta_title:{ru:null,ua:null},meta_description:{ru:null,ua:null}}),e=I({data:[],currentPage:1,isLoading:!0,isActiveModal:!1,modalAction:"",errors:[],item:{}});O(()=>{l(1)});const A=S(()=>e.value.isActiveModal?P:null),l=async t=>{e.value.isLoading=!0,t&&(e.value.currentPage=t);const n=await p.fetch({page:e.value.currentPage});e.value.data=n.success?n.result:[],e.value.isLoading=!1},f=async t=>{if(o("destroy-pages")&&(await a({title:r("swal.sure"),icon:"warning",showCancelButton:!0})).isConfirmed){const{success:c}=await p.destroy(t);c&&(await l(),e.value.isActiveModal&&i(),await a({icon:"success",title:r("swal.destroyed")}))}},i=()=>{e.value.isActiveModal=!e.value.isActiveModal},$=async(t,n)=>{if(o("edit-pages")){const c=await p.edit(t);c.success&&(e.value.item=c.result,e.value.modalAction="edit",e.value.item.index=n,i())}},D=async()=>{if(o("edit-pages")){const t=await p.update(e.value.item);t.success?(i(),await l(),await a({title:r("swal.updated"),icon:"success"})):(e.value.errors=t,console.log(t),await a({title:r("swal.error"),icon:"error",text:r("swal.check_data")}))}},C=async()=>{if(o("create-pages")){const t=await p.create(e.value.item);t.success?(i(),e.value.item={},await l(),await a({title:r("swal.created"),icon:"success"})):(e.value.errors=t,console.log(t),await a({title:r("swal.error"),text:r("swal.check_data"),icon:"error"}))}},M=async()=>{e.value.modalAction==="edit"&&o("edit-pages")?await D():e.value.modalAction==="create"&&o("create-pages")&&await C()},L=()=>{o("create-pages")&&(e.value.item=k,e.value.modalAction="create",i())};return(t,n)=>(u(),m(F,{title:t.$t("pages.page_title")},{header:g(()=>[_(h(t.$t("pages.page_title")),1)]),default:g(()=>[e.value.isLoading?(u(),m(V,{key:0})):w("",!0),!e.value.isLoading&&d(o)("show-pages")?(u(),U("div",R,[v("div",null,[d(o)("create-pages")?(u(),m(b,{key:0,type:"btn",onClick:L},{default:g(()=>[_(h(t.$t("add")),1)]),_:1})):w("",!0)]),v("div",null,[x(B,{data:e.value.data.data,onOnEdit:$,onOnDestroy:f,canDestroy:d(o)("destroy-pages")},null,8,["data","canDestroy"])]),v("div",T,[x(E,{pagination:e.value.data,"click-handler":l,modelValue:e.value.currentPage,"onUpdate:modelValue":n[0]||(n[0]=c=>e.value.currentPage=c)},null,8,["pagination","modelValue"])])])):w("",!0),(u(),m(q(d(A)),{item:e.value.item,onCloseModal:i,onSubmitForm:M,onDeclineForm:f,canDestroy:d(o)("destroy-pages")},null,40,["item","canDestroy"]))]),_:1},8,["title"]))}};export{ae as default};
