import R from"./StatisticLayout-af991e7b.js";import $ from"./Form-15f9476b.js";import{_ as M,u as D,i as p}from"./useConfirm-315b1e48.js";import{s as m,a as J,b as g}from"./column.esm-ad632756.js";import{ae as V,N as j,g as z,k as B,z as I,o as T,l as w,m as k,n as a,y as i,F as E,w as v,x as r,p as f,v as y,t as K}from"./index-a01126e2.js";import{i as u}from"./isDark-c828c264.js";import"./AuthenticatedLayout-704e8f94.js";import"./index.esm-02fff71f.js";import"./Logo-83ffc10f.js";import"./SidebarItem-446a46b0.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Label-20131f4c.js";import"./dropdown.esm-067e1b29.js";import"./app-741b04df.js";import"./moment-fbc5633a.js";import"./basecomponent.esm-bc6743c9.js";import"./focustrap.esm-94bc3b5f.js";const U={key:0,class:"grid grid-cols-1 gap-4"},q={class:"text-center"},G={class:"text-center"},H={class:"text-center"},ge={__name:"Index",setup(Q){const{t:n}=V(),_=j("$can"),h={title:null,slug:null,type:null},e=z({categories:[],isLoading:!0,isActiveModal:!1,modalAction:"",item:{},currentPage:1}),l=B({date:null,page:0,first:0,rows:15,sortField:null,sortOrder:null}),x=I(()=>{let t={};return l.value.sortField&&(t.sort=l.value.sortField,l.value.sortOrder===1?t.param="asc":l.value.sortOrder===-1&&(t.param="desc")),{perPage:l.value.rows||15,sort:t.sort&&t.param?t.sort:null,param:t.sort&&t.param?t.param:null,page:(l.value.page||0)+1}});T(async()=>await c());const c=async()=>{e.isLoading=!0,await axios.get(route("api.statistics.costs.categories.index",x.value)).then(({data:t})=>e.categories=t.result).catch(t=>console.error(t)),e.isLoading=!1};function b(t){_("show-bookkeeping-costs")&&D({message:n("swal.confirm_destroy"),header:n("swal.confirm_action"),icon:"pi pi-exclamation-triangle",accept:async()=>{try{const{data:s}=await axios.delete(route("api.statistics.costs.categories.destroy",t));s.success&&(await c(),p.success(n("swal.destroyed"),{autoClose:3e3,theme:u?"dark":"light"}))}catch(s){console.error(s),p.error(n("swal.error"),{autoClose:3e3,theme:u?"dark":"light"})}}})}function d(){e.isActiveModal=!e.isActiveModal}function C(t,s){axios.get(route("api.statistics.costs.categories.edit",t)).then(({data:o})=>{e.item=o.result,e.modalAction="edit",e.item.index=s,d(),e.isLoading=!1}).catch(o=>console.log(o))}function P(){e.item.type!==null&&typeof e.item.type=="object"&&(e.item.type=e.item.type.code),axios.put(route("api.statistics.costs.categories.update",e.item.id),e.item).then(()=>{d(),c(),p.success(n("swal.updated"),{autoClose:3e3,theme:u?"dark":"light"})}).catch(t=>{console.log(t),p.error(n("swal.error"),{autoClose:3e3,theme:u?"dark":"light"})})}function L(){e.item.type!==null&&typeof e.item.type=="object"&&(e.item.type=e.item.type.code),axios.post(route("api.statistics.costs.categories.create"),e.item).then(()=>{d(),e.item=JSON.parse(JSON.stringify(h)),c(),p.success(n("swal.created"),{autoClose:3e3,theme:u?"dark":"light"})}).catch(t=>{console.log(t),p.error(n("swal.error"),{autoClose:3e3,theme:u?"dark":"light"})})}function N(){e.modalAction==="edit"?P():e.modalAction==="create"&&L()}function S(){e.item=JSON.parse(JSON.stringify(h)),e.modalAction="create",d()}const A=async t=>{l.value=t,await c()},F=async t=>{l.value=t,await c()},O=t=>{e.isLoading=!0,C(t.data.id)};return(t,s)=>(w(),k(E,null,[a(R,{title:"Категорії витрат"},{header:i(()=>[v(" Категорії витрат та прибутків ")]),default:i(()=>[r(_)("show-bookkeeping-costs")?(w(),k("div",U,[f("div",null,[a(r(m),{type:"btn",onClick:S},{default:i(()=>[v(" Додати ")]),_:1})]),a(r(J),{selectionMode:"single",onRowSelect:O,ref:"dt",dataKey:"date",loading:e.isLoading,value:e.categories.data,class:"p-datatable cost-and-profit-categories-table",lazy:"",paginator:"",rows:e.categories.per_page,totalRecords:e.categories.total,onPage:s[0]||(s[0]=o=>A(o)),onSort:s[1]||(s[1]=o=>F(o)),rowsPerPageOptions:[15,50,100,500],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown CurrentPageReport",currentPageReportTemplate:"Показано з {first} по {last} із {totalRecords} записів"},{default:i(()=>[a(r(g),{sortable:"",field:"title",header:"Назва"},{body:i(({data:o})=>[f("div",q,y(o.title),1)]),_:1}),a(r(g),{sortable:"",field:"type",header:"Тип"},{body:i(({data:o})=>[f("div",G,y(o.type?"Прибуток":"Витрата"),1)]),_:1}),a(r(g),{sortable:"",field:"slug",header:"Slug"},{body:i(({data:o})=>[f("div",H,y(o.slug),1)]),_:1}),a(r(g),{field:"actions",header:""},{body:i(({data:o})=>[a(r(m),{text:"",rounded:"",icon:"pi pi-trash",type:"button",onClick:W=>b(o.id)},null,8,["onClick"])]),_:1})]),_:1},8,["loading","value","rows","totalRecords"])])):K("",!0)]),_:1}),a(M,{show:e.isActiveModal,onClose:d},{body:i(()=>[a($,{item:e.item},null,8,["item"])]),footer:i(()=>[a(r(m),{label:"Скасувати",icon:"pi pi-times",onClick:d,text:""}),a(r(m),{label:"Зберегти",icon:"pi pi-check",onClick:N,autofocus:""})]),_:1},8,["show"])],64))}};export{ge as default};
