import{y as P,z as M,C as $,L as h,K as u,P as s,X as g,F as B,B as y,V as d,S as t,a0 as r,_ as p,ac as z,bg as I,Y as U}from"./___vite-browser-external_commonjs-proxy.af1999bf.js";import{_ as N}from"./UploadImagesModal.fcb85341.js";import j from"./List.8aa21fe0.js";import E from"./Modal.e245b213.js";import{H}from"./app.7edc1e1b.js";import"./Form.e36075f9.js";const S=U("\u0417\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"),T={key:1},K=U(" \u0414\u043E\u0434\u0430\u0442\u0438 "),R={__name:"Index",setup(O){const f=y("$swal"),n=y("$can"),e=P({imagesList:[],isActiveUploadModal:!1,isActiveImageModal:!1,imageUploadModal:[],imageModal:{id:null,src:null,alt:null},currentPage:1,isLoading:!0}),L=M(()=>e.value.isActiveUploadModal?N:null),C=M(()=>e.value.isActiveImageModal?E:null);$(()=>l());function k(a){n("create-images")&&Array.from(a).forEach(function(o){let m=new FormData;m.append("image",o),axios.post(route("api.images.upload"),m,{headers:{"Content-Type":"multipart/form-data"}}).then(({data:i})=>{e.value.imageUploadModal.push({src:i.result}),l()}).catch(i=>console.log(i))})}function v(){e.value.isActiveUploadModal=!e.value.isActiveUploadModal}function c(){e.value.isActiveImageModal=!e.value.isActiveImageModal}function x(){e.value.imageUploadModal=[]}function F(a){c(),e.value.imageModal=a}function A(){n("edit-images")&&axios.put(route("api.images.update",e.value.imageModal.id),e.value.imageModal).then(()=>{c(),f({icon:"success",title:"Updated!"})}).catch(a=>console.log(a))}function w(a){_(a),c()}function _(a){n("destroy-images")&&axios.delete(route("api.images.destroy",a)).then(()=>{l(),f({icon:"success",title:"Destroyed!"})}).catch(o=>console.log(o))}async function l(a){e.value.isLoading=!0,a&&(e.value.currentPage=a),await axios.get(route("api.images.index",{page:e.value.currentPage})).then(o=>{Object.assign(e.value.imagesList,o.data.result),e.value.isLoading=!1}).catch(o=>{console.log(o),e.value.isLoading=!1})}return(a,o)=>{const m=d("loader-component"),i=d("button-component"),V=d("pagination"),b=d("auth-layout");return t(),h(B,null,[u(s(H),{title:"\u0417\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"}),u(b,null,{header:g(()=>[S]),default:g(()=>[e.value.isLoading?(t(),r(m,{key:0})):p("",!0),!e.value.isLoading&&s(n)("show-images")?(t(),h("div",T,[s(n)("create-images")?(t(),r(i,{key:0,type:"btn",onClick:z(v,["prevent"])},{default:g(()=>[K]),_:1},8,["onClick"])):p("",!0),u(j,{images:e.value.imagesList,onClickImage:F,onFetch:l,onDestroyImage:_},null,8,["images"]),u(V,{pagination:e.value.imagesList,"click-handler":l,modelValue:e.value.currentPage,"onUpdate:modelValue":o[0]||(o[0]=D=>e.value.currentPage=D)},null,8,["pagination","modelValue"]),(t(),r(I(s(C)),{onCloseModal:c,onSubmitForm:A,onDeclineForm:w,image:e.value.imageModal,size:"large"},null,40,["image"])),(t(),r(I(s(L)),{onCloseModal:v,onUploadImages:k,onLoadMoreImages:x,images:e.value.imageUploadModal,size:"large"},null,40,["images"]))])):p("",!0)]),_:1})],64)}}};export{R as default};
