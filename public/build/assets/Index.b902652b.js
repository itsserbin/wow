import X from"./Modal.d6d909d5.js";import Y from"./Modal.af010d3d.js";import Z from"./Table.bca64ee3.js";import q from"./CrmLayout.6ac8e003.js";import{y,z as S,C as G,a0 as c,X as f,B as A,V as d,S as l,_ as x,P as v,L as E,M as h,K as _,F as H,Z as J,Y as F,O as Q,bh as L}from"./___vite-browser-external_commonjs-proxy.45af3daa.js";import"./Form.74c50b37.js";import"./ItemsTable.f44fc406.js";import"./Form.574a1b2d.js";import"./ItemsModal.e43ef458.js";import"./ItemsForm.e4e68cc1.js";import"./ItemsTable.48bd35e4.js";import"./ClientOrders.42e6ec90.js";import"./Table.c04318de.js";import"./Modal.23849084.js";import"./Form.306b1569.js";import"./app.2709748a.js";const R=F(" \u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F "),W={key:1},ee={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},te={class:"md:col-span-1"},oe={class:"w-full md:col-span-4 grid gap-4 grid-cols-1"},ae={class:"text-center"},Se={__name:"Index",props:["statuses","payment_methods","invoiceStatuses"],setup(b){const p=b,e=y({orders:[],currentPage:1,isLoading:!0,isActiveEditModal:!1,isActiveClientModal:!1,sidebarActive:"all",orderModal:{},clientModal:{},clientsStatuses:null,clientsSubStatuses:null}),m=y([]),a=A("$swal"),n=A("$can"),s=y({status:null,currentPage:1}),P=S(()=>{const t={};return t.page=s.value.currentPage,s.value.status&&(t.status=s.value.status),t});G(()=>{r(),m.value.push({title:"\u0412\u0441\u0456 \u0437\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F",key:"all"});for(const[t,o]of Object.entries(p.statuses))m.value.push({title:o,key:t});route().params.id&&(e.value.isLoading=!0,k(route().params.id)),axios.get(route("api.clients.statuses")).then(({data:t})=>{e.value.clientsStatuses=t.statuses,e.value.clientsSubStatuses=t.subStatuses})});const D=S(()=>e.value.isActiveEditModal?Y:null),V=S(()=>e.value.isActiveClientModal?X:null);function w(){axios.get(route("api.clients.edit",e.value.orderModal.client.id)).then(({data:t})=>{e.value.clientModal=t.result,M()}).catch(t=>console.log(t))}function M(){e.value.isActiveClientModal=!e.value.isActiveClientModal}function B(){axios.put(route("api.clients.update",e.value.clientModal.id),e.value.clientModal).then(()=>{M(),axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal).then(()=>{axios.get(route("api.orders.edit",e.value.orderModal.id)).then(({data:t})=>{e.value.orderModal=t.result,a({title:"Success!",icon:"success"})}).catch(t=>console.log(t))})}).catch(t=>{console.log(t),a({title:"Error!",icon:"error"})})}function $(){axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal),axios.get(route("api.orders.edit",e.value.orderModal.id)).then(({data:t})=>e.value.orderModal=t.result).catch(t=>console.log(t))}function O(t){e.value.sidebarActive=t,t==="all"?s.value.status=null:s.value.status=t,r()}function N(t){t&&(s.value.currentPage=t),r()}function z(t){axios.get(route("api.orders.search",t)).then(({data:o})=>{e.value.sidebarActive=null,s.value.currentPage=1,e.value.orders=o.result,e.value.isLoading=!1}).catch(o=>{console.log(o),e.value.isLoading=!1})}function r(){axios.get(route("api.orders.index",P.value)).then(({data:t})=>{e.value.orders=t.result,e.value.isLoading=!1}).catch(t=>{console.log(t),e.value.isLoading=!1})}function C(t){n("destroy-orders")&&a({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(o=>{o.isConfirmed&&axios.delete(route("api.orders.destroy",t)).then(()=>{e.value.isLoading=!1,r(),e.value.isActiveEditModal&&g(),a({title:"Success!",icon:"success"})}).catch(i=>{console.log(i),a({title:"Error!",icon:"error"})})})}function k(t,o){axios.get(route("api.orders.edit",t)).then(({data:i})=>{e.value.orderModal.index=o,e.value.orderModal=i.result,g(),e.value.isLoading=!1}).catch(i=>console.log(i))}function I(){n("edit-orders")&&axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal).then(()=>{g(),r(),a({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),a({title:"Error!",icon:"error"})})}function g(){e.value.isActiveEditModal=!e.value.isActiveEditModal}return(t,o)=>{const i=d("loader-component"),U=d("sidebar-item"),j=d("sidebar-component"),K=d("search-component"),T=d("pagination");return l(),c(q,{title:"\u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F"},{header:f(()=>[R]),default:f(()=>[e.value.isLoading?(l(),c(i,{key:0})):x("",!0),!e.value.isLoading&&v(n)("show-orders")?(l(),E("div",W,[h("div",ee,[h("div",te,[_(j,null,{default:f(()=>[m.value.length?(l(!0),E(H,{key:0},J(m.value,u=>(l(),c(U,{onClick:se=>O(u.key),active:e.value.sidebarActive===u.key},{default:f(()=>[F(Q(u.title),1)]),_:2},1032,["onClick","active"]))),256)):x("",!0)]),_:1})]),h("div",oe,[_(K,{onSearch:z,clear:!0,placeholder:"\u0406\u043C\u02BC\u044F, \u043F\u0440\u0456\u0437\u0432\u0438\u0449\u0435, \u0442\u0435\u043B\u0435\u0444\u043E\u043D, \u043D\u0430\u043A\u043B\u0430\u0434\u043A\u0430, \u043A\u043E\u043C\u0435\u043D\u0442\u0430\u0440..."}),_(Z,{data:e.value.orders.data,onOnEdit:k,onOnDestroy:C,statuses:b.statuses,canDestroy:v(n)("destroy-orders")},null,8,["data","statuses","canDestroy"]),h("div",ae,[_(T,{pagination:e.value.orders,"click-handler":N,modelValue:e.value.currentPage,"onUpdate:modelValue":o[0]||(o[0]=u=>e.value.currentPage=u)},null,8,["pagination","modelValue"])])])]),(l(),c(L(v(D)),{order:e.value.orderModal,statuses:p.statuses,invoiceStatuses:p.invoiceStatuses,paymentMethods:p.payment_methods,size:"extralarge",onCloseModal:g,onDeclineForm:C,onSubmitForm:I,onSubmitItemForm:$,canDestroy:v(n)("destroy-orders"),onOnEditClient:w},null,40,["order","statuses","invoiceStatuses","paymentMethods","canDestroy"])),(l(),c(L(v(V)),{item:e.value.clientModal,statuses:e.value.clientsStatuses,"sub-statuses":e.value.clientsSubStatuses,size:"extralarge",onCloseModal:M,onSubmitForm:B},null,40,["item","statuses","sub-statuses"]))])):x("",!0)]),_:1})}}};export{Se as default};
