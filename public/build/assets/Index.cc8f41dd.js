import{af as V,q as F,g as y,s as B,p as l,w as g,x as _,o as i,l as M,t as h,k as p,u as d,i as P,j as I,K as D,y as L,ac as k}from"./vendor.2c8aab53.js";import{L as E,b as N,j as b}from"./app.1edad9f2.js";import{_ as j}from"./UploadImagesModal.b73b5cfe.js";import S from"./List.0a56c40a.js";import q from"./Modal.836c0144.js";import z from"./ContentLayout.40dd65c6.js";import"./__commonjsHelpers__.4516dc8a.js";import"./vue.m.132a23fc.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./Logo.6090e12d.js";import"./Form.b7883da0.js";const v={async fetch(t){try{return(await axios.get(route("api.images.index",t))).data}catch(s){throw new Error(s.response.data)}},async destroy(t){try{return(await axios.delete(route("api.images.destroy",t))).data}catch(s){throw new Error(s.response.data)}},async update(t){try{return(await axios.put(route("api.images.update",t.id),t)).data}catch(s){throw new Error(s.response.data)}}},K={key:1,class:"grid grid-cols-1 gap-4"},O={class:"text-center"},ea={__name:"Index",setup(t){const s=_("$swal"),r=_("$can"),{t:u}=V(),a=F({imagesList:[],isActiveUploadModal:!1,isActiveImageModal:!1,imageUploadModal:[],imageModal:{id:null,src:null,alt:null},currentPage:1,isLoading:!0}),$=y(()=>a.value.isActiveUploadModal?j:null),C=y(()=>a.value.isActiveImageModal?q:null);B(()=>n());const f=()=>{a.value.isActiveUploadModal=!a.value.isActiveUploadModal},c=()=>{a.value.isActiveImageModal=!a.value.isActiveImageModal},U=e=>{c(),a.value.imageModal=e},x=async()=>{if(r("edit-images")){const{success:e}=await v.update(a.value.imageModal);e&&(c(),await s({icon:"success",title:u("swal.updated")}))}},A=async e=>{await w(e),c()},w=async e=>{if(r("destroy-images")&&(await s({title:u("swal.sure"),icon:"warning",showCancelButton:!0})).isConfirmed){a.value.isLoading=!0;const{success:m}=await v.destroy(e);m&&(await n(),await s({icon:"success",title:u("swal.destroyed")})),a.value.isLoading=!1}},n=async e=>{a.value.isLoading=!0,e&&(a.value.currentPage=e);const o=await v.fetch({page:a.value.currentPage});a.value.imagesList=o.success?o.result:[],a.value.isLoading=!1};return(e,o)=>(i(),l(z,{title:e.$t("images.page_title")},{header:g(()=>[M(h(e.$t("images.page_title")),1)]),default:g(()=>[a.value.isLoading?(i(),l(E,{key:0})):p("",!0),!a.value.isLoading&&d(r)("show-images")?(i(),P("div",K,[I("div",null,[d(r)("create-images")?(i(),l(N,{key:0,type:"btn",onClick:D(f,["prevent"])},{default:g(()=>[M(h(e.$t("add")),1)]),_:1},8,["onClick"])):p("",!0)]),L(S,{images:a.value.imagesList,onClickImage:U,onFetch:n,onDestroyImage:w},null,8,["images"]),I("div",O,[L(b,{pagination:a.value.imagesList,"click-handler":n,modelValue:a.value.currentPage,"onUpdate:modelValue":o[0]||(o[0]=m=>a.value.currentPage=m)},null,8,["pagination","modelValue"])])])):p("",!0),(i(),l(k(d(C)),{onCloseModal:c,onSubmitForm:x,onDeclineForm:A,image:a.value.imageModal,size:"large"},null,40,["image"])),(i(),l(k(d($)),{onCloseModal:f,onOnUpload:n},null,32))]),_:1},8,["title"]))}};export{ea as default};
