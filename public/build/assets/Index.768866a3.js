import j from"./Modal.52506fe9.js";import z from"./Table.678b4aa9.js";import"./app.b6e043f1.js";import{A as h,B as b,G,V as m,S as p,X as r,R as n,$ as y,P as k,L as A,M as g,K as _,F as K,U as R,Y as L,O as T,bc as X,x as E}from"./moment.e1708d83.js";import"./Form.c0e1d08f.js";import"./ItemsModal.c12ccf19.js";import"./ItemsForm.c557ed1b.js";import"./ItemsTable.e30908a8.js";const Y=L(" \u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F "),q={key:1},H={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},J={class:"md:col-span-1"},Q={class:"w-full md:col-span-4 grid gap-4 grid-cols-1"},W={class:"text-center"},le={__name:"Index",props:["statuses","payment_methods"],setup(M){const f=M,e=h({orders:[],currentPage:1,isLoading:!0,isActiveEditModal:!1,sidebarActive:"all",orderModal:{}}),d=h([]),i=E("$swal"),u=E("$can"),a=h({status:null,currentPage:1}),C=b(()=>{const t={};return t.page=a.value.currentPage,a.value.status&&(t.status=a.value.status),t});G(()=>{l(),d.value.push({title:"\u0412\u0441\u0456 \u0437\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F",key:"all"});for(const[t,o]of Object.entries(f.statuses))d.value.push({title:o,key:t})});const P=b(()=>e.value.isActiveEditModal?j:null);function S(t){u("edit-orders")&&(axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal),axios.get(route("api.orders.edit",t.order_id)).then(({data:o})=>e.value.orderModal=o.result).catch(o=>console.log(o)))}function V(t){e.value.sidebarActive=t,t==="all"?a.value.status=null:a.value.status=t,l()}function w(t){t&&(a.value.currentPage=t),l()}function B(t){axios.get(route("api.orders.search",t)).then(({data:o})=>{e.value.sidebarActive=null,a.value.currentPage=1,e.value.orders=o.result,e.value.isLoading=!1}).catch(o=>{console.log(o),e.value.isLoading=!1})}function l(){axios.get(route("api.orders.index",C.value)).then(({data:t})=>{e.value.orders=t.result,e.value.isLoading=!1}).catch(t=>{console.log(t),e.value.isLoading=!1})}function x(t){u("destroy-orders")&&i({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(o=>{o.isConfirmed&&axios.delete(route("api.orders.destroy",t)).then(()=>{e.value.isLoading=!1,l(),e.value.isActiveEditModal&&v(),i({title:"Success!",icon:"success"})}).catch(s=>{console.log(s),i({title:"Error!",icon:"error"})})})}function F(t,o){axios.get(route("api.orders.edit",t)).then(({data:s})=>{e.value.orderModal.index=o,e.value.orderModal=s.result,v()}).catch(s=>console.log(s))}function $(){u("edit-orders")&&axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal).then(()=>{v(),l(),i({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),i({title:"Error!",icon:"error"})})}function v(){e.value.isActiveEditModal=!e.value.isActiveEditModal}return(t,o)=>{const s=r("loader-component"),D=r("sidebar-item"),N=r("sidebar-component"),O=r("search-component"),I=r("pagination"),U=r("auth-layout");return n(),m(U,{title:"\u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F"},{header:p(()=>[Y]),default:p(()=>[e.value.isLoading?(n(),m(s,{key:0})):y("",!0),!e.value.isLoading&&k(u)("show-orders")?(n(),A("div",q,[g("div",H,[g("div",J,[_(N,null,{default:p(()=>[d.value.length?(n(!0),A(K,{key:0},R(d.value,c=>(n(),m(D,{onClick:Z=>V(c.key),active:e.value.sidebarActive===c.key},{default:p(()=>[L(T(c.title),1)]),_:2},1032,["onClick","active"]))),256)):y("",!0)]),_:1})]),g("div",Q,[_(O,{onSearch:B,clear:!0,placeholder:"\u0406\u043C\u02BC\u044F, \u043F\u0440\u0456\u0437\u0432\u0438\u0449\u0435, \u0442\u0435\u043B\u0435\u0444\u043E\u043D, \u043D\u0430\u043A\u043B\u0430\u0434\u043A\u0430, \u043A\u043E\u043C\u0435\u043D\u0442\u0430\u0440..."}),_(z,{data:e.value.orders.data,onOnEdit:F,onOnDestroy:x,statuses:M.statuses},null,8,["data","statuses"]),g("div",W,[_(I,{pagination:e.value.orders,"click-handler":w,modelValue:e.value.currentPage,"onUpdate:modelValue":o[0]||(o[0]=c=>e.value.currentPage=c)},null,8,["pagination","modelValue"])])])]),(n(),m(X(k(P)),{order:e.value.orderModal,statuses:f.statuses,paymentMethods:f.payment_methods,size:"extralarge",onCloseModal:v,onDeclineForm:x,onSubmitForm:$,onSubmitItemForm:S},null,40,["order","statuses","paymentMethods"]))])):y("",!0)]),_:1})}}};export{le as default};
