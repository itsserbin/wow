import{y as b,z as _,C as D,a0 as s,X as d,B as M,V as r,S as t,_ as g,P as u,L as P,ac as $,K as h,bg as I,Y as y}from"./___vite-browser-external_commonjs-proxy.f18235ae.js";import{_ as B}from"./UploadImagesModal.ad725ce6.js";import z from"./List.6efd42a2.js";import N from"./Modal.12e4359e.js";import"./app.5beb5dc1.js";import j from"./ContentLayout.0386185f.js";import"./Form.00adea98.js";const E=y("\u0417\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"),S={key:1},T=y(" \u0414\u043E\u0434\u0430\u0442\u0438 "),Q={__name:"Index",setup(K){const p=M("$swal"),n=M("$can"),e=b({imagesList:[],isActiveUploadModal:!1,isActiveImageModal:!1,imageUploadModal:[],imageModal:{id:null,src:null,alt:null},currentPage:1,isLoading:!0}),U=_(()=>e.value.isActiveUploadModal?B:null),L=_(()=>e.value.isActiveImageModal?N:null);D(()=>i());function C(a){n("create-images")&&Array.from(a).forEach(function(o){let m=new FormData;m.append("image",o),axios.post(route("api.images.upload"),m,{headers:{"Content-Type":"multipart/form-data"}}).then(({data:l})=>{e.value.imageUploadModal.push({src:l.result}),i()}).catch(l=>console.log(l))})}function f(){e.value.isActiveUploadModal=!e.value.isActiveUploadModal}function c(){e.value.isActiveImageModal=!e.value.isActiveImageModal}function k(){e.value.imageUploadModal=[]}function x(a){c(),e.value.imageModal=a}function A(){n("edit-images")&&axios.put(route("api.images.update",e.value.imageModal.id),e.value.imageModal).then(()=>{c(),p({icon:"success",title:"Updated!"})}).catch(a=>console.log(a))}function F(a){v(a),c()}function v(a){n("destroy-images")&&axios.delete(route("api.images.destroy",a)).then(()=>{i(),p({icon:"success",title:"Destroyed!"})}).catch(o=>console.log(o))}async function i(a){e.value.isLoading=!0,a&&(e.value.currentPage=a),await axios.get(route("api.images.index",{page:e.value.currentPage})).then(o=>{Object.assign(e.value.imagesList,o.data.result),e.value.isLoading=!1}).catch(o=>{console.log(o),e.value.isLoading=!1})}return(a,o)=>{const m=r("loader-component"),l=r("button-component"),w=r("pagination");return t(),s(j,{title:"\u0417\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"},{header:d(()=>[E]),default:d(()=>[e.value.isLoading?(t(),s(m,{key:0})):g("",!0),!e.value.isLoading&&u(n)("show-images")?(t(),P("div",S,[u(n)("create-images")?(t(),s(l,{key:0,type:"btn",onClick:$(f,["prevent"])},{default:d(()=>[T]),_:1},8,["onClick"])):g("",!0),h(z,{images:e.value.imagesList,onClickImage:x,onFetch:i,onDestroyImage:v},null,8,["images"]),h(w,{pagination:e.value.imagesList,"click-handler":i,modelValue:e.value.currentPage,"onUpdate:modelValue":o[0]||(o[0]=V=>e.value.currentPage=V)},null,8,["pagination","modelValue"]),(t(),s(I(u(L)),{onCloseModal:c,onSubmitForm:A,onDeclineForm:F,image:e.value.imageModal,size:"large"},null,40,["image"])),(t(),s(I(u(U)),{onCloseModal:f,onUploadImages:C,onLoadMoreImages:k,images:e.value.imageUploadModal,size:"large"},null,40,["images"]))])):g("",!0)]),_:1})}}};export{Q as default};
