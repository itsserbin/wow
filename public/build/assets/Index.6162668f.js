import O from"./Modal.3870b835.js";import U from"./Table.099c15f0.js";import{z as g,A as y,D as j,U as v,R as m,W as n,Q as l,Z as f,O as x,K as k,L as p,J as _,F as z,S as I,X as S,M as J,bc as K,v as L}from"./moment.5b161624.js";import"./Form.9944c218.js";import"./ItemsTable.eeeb048b.js";const Q=S(" \u041A\u043B\u0456\u0454\u043D\u0442\u0438 "),R={key:1},T={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},W={class:"md:col-span-1"},X={class:"w-full md:col-span-4 grid grid-cols-1 gap-4"},Z={class:"text-center"},se={__name:"Index",setup(q){const e=g({data:[],statuses:[],subStatuses:[],isLoading:!0,isActiveEditModal:!1,sidebarActive:"all",modal:{}}),s=g({status:null,currentPage:1}),A=y(()=>{const t={};return t.page=s.value.currentPage,s.value.status&&(t.status=s.value.status),t}),c=g([]),r=L("$swal"),h=L("$can");j(()=>{i(),axios.get(route("api.clients.statuses")).then(({data:t})=>{e.value.statuses=t.statuses,e.value.subStatuses=t.subStatuses,c.value.push({title:"\u0412\u0441\u0456 \u043A\u043B\u0456\u0454\u043D\u0442\u0438",key:"all"});for(const[a,o]of Object.entries(t.statuses))c.value.push({title:o,key:a})})});const E=y(()=>e.value.isActiveEditModal?O:null);function M(t){axios.get(route("api.clients.search",{search:t})).then(({data:a})=>{e.value.sidebarActive=null,s.value.currentPage=1,e.value.data=a.result,e.value.isLoading=!1}).catch(a=>{console.log(a),e.value.isLoading=!1})}function C(t){e.value.sidebarActive=t,t==="all"?s.value.status=null:s.value.status=t,i()}function P(t){t&&(s.value.currentPage=t),i()}function i(){axios.get(route("api.clients.index",A.value)).then(({data:t})=>{e.value.data=t.result,e.value.isLoading=!1}).catch(t=>{console.log(t),e.value.isLoading=!1})}function b(t){h("destroy-clients")&&(e.value.isLoading=!0,axios.delete(route("api.clients.destroy",t)).then(()=>{e.value.isLoading=!1,i(),e.value.isActiveEditModal&&d(),r({title:"Success!",icon:"success"})}).catch(a=>{console.log(a),r({title:"Error!",icon:"error"})}))}function V(t,a){axios.get(route("api.clients.edit",t)).then(({data:o})=>{e.value.modal.index=a,e.value.modal=o.result,d()}).catch(o=>console.log(o))}function w(){axios.put(route("api.clients.update",e.value.modal.id),e.value.modal).then(()=>{d(),i(),r({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),r({title:"Error!",icon:"error"})})}function d(){e.value.isActiveEditModal=!e.value.isActiveEditModal}return(t,a)=>{const o=n("loader-component"),B=n("sidebar-item"),D=n("sidebar-component"),F=n("search-component"),$=n("pagination"),N=n("auth-layout");return l(),v(N,{title:"\u041A\u043B\u0456\u0454\u043D\u0442\u0438"},{header:m(()=>[Q]),default:m(()=>[e.value.isLoading?(l(),v(o,{key:0})):f("",!0),!e.value.isLoading&&x(h)("show-clients")?(l(),k("div",R,[p("div",T,[p("div",W,[_(D,null,{default:m(()=>[c.value.length?(l(!0),k(z,{key:0},I(c.value,u=>(l(),v(B,{onClick:G=>C(u.key),active:e.value.sidebarActive===u.key},{default:m(()=>[S(J(u.title),1)]),_:2},1032,["onClick","active"]))),256)):f("",!0)]),_:1})]),p("div",X,[_(F,{onSearch:M,clear:!0,placeholder:"\u0406\u043C\u02BC\u044F, \u043F\u0440\u0456\u0437\u0432\u0438\u0449\u0435, \u043F\u043E-\u0431\u0430\u0442\u044C\u043A\u043E\u0432\u0456, \u0442\u0435\u043B\u0435\u0444\u043E\u043D, email, \u043A\u043E\u043C\u0435\u043D\u0442\u0430\u0440..."}),_(U,{data:e.value.data.data,onOnEdit:V,onOnDestroy:b,statuses:e.value.statuses},null,8,["data","statuses"]),p("div",Z,[_($,{pagination:e.value.data,"click-handler":P,modelValue:s.value.currentPage,"onUpdate:modelValue":a[0]||(a[0]=u=>s.value.currentPage=u)},null,8,["pagination","modelValue"])])])]),(l(),v(K(x(E)),{item:e.value.modal,statuses:e.value.statuses,"sub-statuses":e.value.subStatuses,size:"extralarge",onCloseModal:d,onDeclineForm:b,onSubmitForm:w},null,40,["item","statuses","sub-statuses"]))])):f("",!0)]),_:1})}}};export{se as default};
