import S from"./Modal.f2f0b874.js";import{v as k,A as E,G as j,B as N,V as h,S as c,X as u,R as m,$ as b,P as y,L as I,M as d,K as _,Y as v,O as p,bc as O,x as w}from"./moment.e1708d83.js";import"./Form.00e6e2d0.js";const U=v(" \u0417\u0430\u044F\u0432\u043A\u0438 \u043D\u0430 \u0437\u0432\u043E\u0440\u043E\u0442\u043D\u0456\u0439 \u0437\u0432\u02BC\u044F\u0437\u043E\u043A "),G={key:1},K={class:"grid grid-cols-1 gap-4"},R=["onClick"],T=d("hr",{class:"my-1"},null,-1),X=["onClick"],Y={class:"text-center"},J={__name:"Index",props:["statuses"],setup(f){const s=w("$swal"),n=w("$can");k({name:null,phone:null,comment:null,status:null});const e=E({data:[],currentPage:1,isLoading:!0,isActiveModal:!1,modalAction:"",item:{}});j(()=>{i(1)});const x=N(()=>e.value.isActiveModal?S:null),C=k([{label:"ID",key:"id"},{label:"\u0421\u0442\u0430\u0442\u0443\u0441",key:"status"},{label:"\u0406\u043C\u02BC\u044F",key:"name"},{label:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",key:"phone"},{label:"\u041A\u043E\u043C\u0435\u043D\u0442\u0430\u0440",key:"comment"},{label:"\u041E\u043D\u043E\u0432\u043B\u0435\u043D\u043E<hr class='my-1'>\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043E",key:"timestamps"},{label:"#",key:"actions"}]);function i(t){e.value.isLoading=!0,t&&(e.value.currentPage=t),axios.get(route("api.callbacks.index",{page:e.value.currentPage})).then(o=>{Object.assign(e.value.data,o.data.result),e.value.isLoading=!1}).catch(o=>{console.log(o),e.value.isLoading=!1})}function g(t){n("destroy-callbacks")&&s({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(o=>{o.isConfirmed&&axios.delete(route("api.callbacks.destroy",t)).then(()=>{i(),e.value.isActiveModal&&r(),s({icon:"success",title:"Destroyed!"})}).catch(l=>{console.log(l),s({icon:"error",title:"Error!"})})})}function r(){e.value.isActiveModal=!e.value.isActiveModal}function A(t,o){n("edit-callbacks")&&axios.get(route("api.callbacks.edit",t)).then(({data:l})=>{e.value.item=l.result,e.value.modalAction="edit",e.value.item.index=o,r()}).catch(l=>console.log(l))}function M(){n("edit-callbacks")&&axios.put(route("api.callbacks.update",e.value.item.id),e.value.item).then(()=>{r(),i(),s({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),s({title:"Error!",icon:"error"})})}function V(){n("create-callbacks")&&axios.post(route("api.callbacks.create"),e.value.item).then(({data:t})=>{r(),e.value.item={},i(),s({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),s({title:"Error!",icon:"error"})})}function $(){e.value.modalAction==="edit"&&n("edit-callbacks")?M():e.value.modalAction==="create"&&n("create-callbacks")&&V()}return(t,o)=>{const l=u("loader-component"),L=u("xcircle-component"),B=u("table-component"),D=u("pagination"),F=u("auth-layout");return m(),h(F,{title:"\u0417\u0430\u044F\u0432\u043A\u0438 \u043D\u0430 \u0437\u0432\u043E\u0440\u043E\u0442\u043D\u0456\u0439 \u0437\u0432\u02BC\u044F\u0437\u043E\u043A"},{header:c(()=>[U]),default:c(()=>[e.value.isLoading?(m(),h(l,{key:0})):b("",!0),!e.value.isLoading&&y(n)("show-callbacks")?(m(),I("div",G,[d("div",K,[_(B,{headings:C,isSlotMode:!0,rows:e.value.data.data},{status:c(({data:a})=>[v(p(f.statuses[a.row.status]),1)]),id:c(({data:a})=>[d("a",{href:"javascript:",onClick:P=>A(a.row.id,a.i)},p(a.row.id),9,R)]),timestamps:c(({data:a})=>[v(p(t.$filters.dateFormat(a.row.updated_at))+" ",1),T,v(" "+p(t.$filters.dateFormat(a.row.created_at)),1)]),actions:c(({data:a})=>[d("a",{href:"javascript:",onClick:P=>g(a.row.id)},[_(L)],8,X)]),_:1},8,["headings","rows"]),d("div",Y,[_(D,{pagination:e.value.data,"click-handler":i,modelValue:e.value.currentPage,"onUpdate:modelValue":o[0]||(o[0]=a=>e.value.currentPage=a)},null,8,["pagination","modelValue"])])]),(m(),h(O(y(x)),{item:e.value.item,onCloseModal:r,onSubmitForm:$,onDeclineForm:g,statuses:f.statuses},null,40,["item","statuses"]))])):b("",!0)]),_:1})}}};export{J as default};
