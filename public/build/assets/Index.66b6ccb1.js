import S from"./Chart.825fd74c.js";import M from"./StatisticLayout.ce9552cb.js";import C from"./LastParams.f1a58b45.js";import{z as g,A as D,D as N,u as F,U as c,R as u,Q as l,Z as d,K as v,L as m,J as s,F as U,S as A,X as p,M as f,v as h,W as n}from"./moment.5b161624.js";import"./index.377b15bb.js";import"./app.e09e3887.js";const R=p(" \u041C\u0430\u0440\u043A\u0435\u0442\u0438\u043D\u0433\u043E\u0432\u0430 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430 "),T={key:1},j={class:"grid grid-cols-1 gap-4 mt-5"},z={class:"block"},E={class:"grid grid-cols-2 md:grid-cols-4"},Z={__name:"Index",setup(I){h("$swal"),h("$can");const t=g({data:[],chart:null,isLoading:!0}),a=g({date:[],filter:null,last:"one-month",currentPage:1}),_=D(()=>{const e={};return a.value.date.length===2&&(e.date_start=a.value.date[0],e.date_end=a.value.date[1]),a.value.last&&(e.last=a.value.last),e.page=a.value.currentPage,e});N(()=>r());const k=F([{label:"\u0414\u0430\u0442\u0430",key:"date"},{label:"\u0421\u0440. \u0446\u0456\u043D\u0430 \u0437\u0430\u044F\u0432\u043A\u0438",key:"average_application_price"},{label:"\u0421\u0440. \u0446\u0456\u043D\u0430 \u0430\u043F\u0440\u0443\u0432\u0430",key:"average_approve_application_price"},{label:"\u0421\u0440. \u0446\u0456\u043D\u0430 \u0432\u0438\u043A\u043E\u043D\u0430\u043D\u043E\u0457 \u0437\u0430\u044F\u0432\u043A\u0438",key:"average_done_application_price"},{label:"\u0421\u0440. \u0447\u0435\u043A",key:"average_check"},{label:"\u0421\u0440. \u043C\u0430\u0440\u0436\u0430",key:"average_marginality"},{label:"\u0421\u0440. \u043A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u0442\u043E\u0432\u0430\u0440\u0456\u0432",key:"average_items"}]);function y(e){e?a.value.last=e:a.value={date:[],filter:null,last:null,currentPage:1},r()}function b(){a.value.last="range",r()}function r(){t.value.isLoading=!0,axios.get(route("api.statistics.marketing.index",_.value)).then(({data:e})=>{t.value.data=e,t.value.isLoading=!1}).catch(e=>{console.log(e),t.value.isLoading=!1}),axios.get(route("api.statistics.marketing.chart",_.value)).then(({data:e})=>t.value.chart=e.result).catch(e=>console.log(e))}return(e,i)=>{const L=n("loader-component"),V=n("label-component"),$=n("Datepicker"),w=n("card-component"),B=n("table-component"),P=n("pagination");return l(),c(M,{title:"\u041C\u0430\u0440\u043A\u0435\u0442\u0438\u043D\u0433\u043E\u0432\u0430 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430"},{header:u(()=>[R]),default:u(()=>[t.value.isLoading?(l(),c(L,{key:0})):d("",!0),t.value.isLoading?d("",!0):(l(),v("div",T,[m("div",j,[m("div",z,[s(V,{value:"\u0424\u0456\u043B\u044C\u0442\u0440 \u043F\u043E \u0434\u0430\u0442\u0456"}),s($,{modelValue:a.value.date,"onUpdate:modelValue":[i[0]||(i[0]=o=>a.value.date=o),b],class:"w-100",locale:"ru",placeholder:"\u041E\u0431\u0435\u0440\u0456\u0442\u044C \u0434\u0430\u0442\u0443",autoApply:"",monthChangeOnScroll:!1,enableTimePicker:!1,range:"",utc:""},null,8,["modelValue"])])]),s(C,{"active-item":a.value.last,onSortByLast:y},null,8,["active-item"]),t.value.chart?(l(),c(S,{key:0,"chart-data":t.value.chart},null,8,["chart-data"])):d("",!0),m("div",E,[(l(!0),v(U,null,A(t.value.data.generalStatistics,(o,x)=>(l(),c(w,{class:"text-center",title:x,description:e.$filters.formatMoney(o)},null,8,["title","description"]))),256))]),s(B,{headings:k,rows:t.value.data.result.data,isSlotMode:!0},{date:u(({data:o})=>[p(f(e.$filters.dateFormat(o.row.date)),1)]),costs:u(({data:o})=>[p(f(e.$filters.formatMoney(o.row.costs)),1)]),_:1},8,["headings","rows"]),s(P,{pagination:t.value.data.result,"click-handler":r,modelValue:a.value.currentPage,"onUpdate:modelValue":i[1]||(i[1]=o=>a.value.currentPage=o)},null,8,["pagination","modelValue"])]))]),_:1})}}};export{Z as default};
