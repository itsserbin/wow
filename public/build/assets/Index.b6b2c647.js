import C from"./Chart.b4760a17.js";import D from"./StatisticLayout.1a10cb13.js";import N from"./LastParams.6b352395.js";import{y as p,z as F,G as U,az as z,W as c,U as o,S as n,a0 as _,P as O,L as y,M as f,K as u,F as T,V as j,Z as l,O as r,D as v,Y as i}from"./___vite-browser-external_commonjs-proxy.2503c6f8.js";import"./index.e3255c35.js";import"./app.d33e4a32.js";const A=l(" \u041F\u0440\u0438\u0431\u0443\u0442\u043E\u043A "),E={key:1},G={class:"grid grid-cols-1 gap-4 mt-5"},I={class:"block"},K={class:"grid grid-cols-2 md:grid-cols-4"},Q={__name:"Index",setup(R){v("$swal");const h=v("$can"),s=p({profits:[],chart:null,isLoading:!0}),t=p({date:[],last:"one-month",currentPage:1});p([]);const g=F(()=>{const e={};return t.value.date.length===2&&(e.date_start=t.value.date[0],e.date_end=t.value.date[1]),t.value.last&&(e.last=t.value.last),e.page=t.value.currentPage,e});U(()=>m());const k=z([{label:"\u0414\u0430\u0442\u0430",key:"date"},{label:"\u0412\u0438\u0442\u0440\u0430\u0442\u0438",key:"cost"},{label:"\u041E\u0431\u0435\u0440\u0442",key:"turnover"},{label:"\u041C\u0430\u0440\u0436\u0430",key:"marginality"},{label:"\u0427\u0438\u0441\u0442\u0438\u0439 \u043F\u0440\u0438\u0431\u0443\u0442\u043E\u043A",key:"clear_profit"},{label:"\u0412\u0438\u043D\u0435\u043D \u043F\u043E\u0441\u0442\u0430\u0447\u0430\u043B\u044C\u043D\u0438\u043A",key:"debt_supplier"},{label:"\u041F\u0440\u043E\u0434\u0430\u0436\u0456 \u043F\u043E\u0432\u0456\u0442\u0440\u044F",key:"sale_of_air_sum"},{label:"\u0421\u0435\u0440\u0435\u0434\u043D\u044F \u043C\u0430\u0440\u0436\u0430",key:"average_marginality"},{label:"\u0421\u0443\u043C\u0430 \u043F\u0435\u0440\u0435\u043E\u0434\u043E\u043F\u043B\u0430\u0442",key:"prepayment_sum"},{label:"\u0421\u0443\u043C\u0430 \u0437\u0430 \u043F\u043E\u0432\u0435\u0440\u043D\u0435\u043D\u043D\u044F \u0442\u043E\u0432\u0430\u0440\u0443",key:"refunds_sum"},{label:"\u041C\u0430\u0440\u0436\u0430 \u0437 \u0434\u043E\u0434.\u043F\u0440\u043E\u0434\u0430\u0436",key:"additional_sales_marginality_sum"},{label:"\u041E\u0431\u0435\u0440\u0442 \u0434\u043E\u0434.\u043F\u0440\u043E\u0434\u0430\u0436",key:"additional_sales_sum"}]);function b(e){e?t.value.last=e:t.value={date:[],last:null,currentPage:1},m()}function w(e){t.value.last="range",m()}function m(){s.value.isLoading=!0,axios.get(route("api.statistics.profits.index",g.value)).then(({data:e})=>{s.value.profits=e,s.value.isLoading=!1}).catch(e=>{console.log(e),s.value.isLoading=!1}),axios.get(route("api.statistics.profits.chart",g.value)).then(({data:e})=>s.value.chart=e.result).catch(e=>console.log(e))}return(e,d)=>{const $=i("loader-component"),M=i("label-component"),V=i("Datepicker"),L=i("card-component"),P=i("table-component"),B=i("pagination");return n(),c(D,{title:"\u041F\u0440\u0438\u0431\u0443\u0442\u043E\u043A"},{header:o(()=>[A]),default:o(()=>[s.value.isLoading?(n(),c($,{key:0})):_("",!0),!s.value.isLoading&&O(h)("show-bookkeeping-profits")?(n(),y("div",E,[f("div",G,[f("div",I,[u(M,{value:"\u0424\u0456\u043B\u044C\u0442\u0440 \u043F\u043E \u0434\u0430\u0442\u0456"}),u(V,{modelValue:t.value.date,"onUpdate:modelValue":[d[0]||(d[0]=a=>t.value.date=a),w],class:"w-100",placeholder:"\u041E\u0431\u0435\u0440\u0456\u0442\u044C \u0434\u0430\u0442\u0443",autoApply:"",monthChangeOnScroll:!1,enableTimePicker:!1,range:"",locale:"ru"},null,8,["modelValue"])])]),u(N,{"active-item":t.value.last,onSortByLast:b},null,8,["active-item"]),s.value.chart?(n(),c(C,{key:0,"chart-data":s.value.chart},null,8,["chart-data"])):_("",!0),f("div",K,[(n(!0),y(T,null,j(s.value.profits.generalStat,(a,S)=>(n(),c(L,{class:"text-center",title:S,description:e.$filters.formatMoney(a)},null,8,["title","description"]))),256))]),u(P,{headings:k,rows:s.value.profits.result.data,isSlotMode:!0},{date:o(({data:a})=>[l(r(e.$filters.dateFormat(a.row.date)),1)]),costs:o(({data:a})=>[l(r(e.$filters.formatMoney(a.row.costs)),1)]),turnover:o(({data:a})=>[l(r(e.$filters.formatMoney(a.row.turnover)),1)]),marginality:o(({data:a})=>[l(r(e.$filters.formatMoney(a.row.marginality)),1)]),clear_profit:o(({data:a})=>[l(r(e.$filters.formatMoney(a.row.clear_profit)),1)]),average_marginality:o(({data:a})=>[l(r(e.$filters.formatMoney(a.row.average_marginality)),1)]),sale_of_air_sum:o(({data:a})=>[l(r(e.$filters.formatMoney(a.row.sale_of_air_sum)),1)]),debt_supplier:o(({data:a})=>[l(r(e.$filters.formatMoney(a.row.debt_supplier)),1)]),prepayment_sum:o(({data:a})=>[l(r(e.$filters.formatMoney(a.row.prepayment_sum)),1)]),refunds_sum:o(({data:a})=>[l(r(e.$filters.formatMoney(a.row.refunds_sum)),1)]),additional_sales_marginality_sum:o(({data:a})=>[l(r(e.$filters.formatMoney(a.row.additional_sales_marginality_sum)),1)]),additional_sales_sum:o(({data:a})=>[l(r(e.$filters.formatMoney(a.row.additional_sales_sum)),1)]),_:1},8,["headings","rows"]),u(B,{pagination:s.value.profits.result,"click-handler":m,modelValue:t.value.currentPage,"onUpdate:modelValue":d[1]||(d[1]=a=>t.value.currentPage=a)},null,8,["pagination","modelValue"])])):_("",!0)]),_:1})}}};export{Q as default};
