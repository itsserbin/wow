import C from"./StatisticLayout-af991e7b.js";import{s as V,a as b,b as i}from"./column.esm-ad632756.js";import{s as F}from"./multiselect.esm-af9c9b5b.js";import z from"./Chart-ceaabd04.js";import{g as w,k as x,z as N,o as O,l as c,s as p,y as t,w as l,p as s,t as m,n as _,x as o,v as d}from"./index-a01126e2.js";import"./AuthenticatedLayout-704e8f94.js";import"./index.esm-02fff71f.js";import"./Logo-83ffc10f.js";import"./SidebarItem-446a46b0.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./app-741b04df.js";import"./moment-fbc5633a.js";import"./dropdown.esm-067e1b29.js";import"./basecomponent.esm-bc6743c9.js";import"./focustrap.esm-94bc3b5f.js";import"./index.esm-73720709.js";import"./card.esm-3b1398df.js";const S={class:"grid grid-cols-1 gap-4"},B={class:"text-center whitespace-nowrap"},D=s("br",null,null,-1),E={class:"text-center whitespace-nowrap"},I={class:"text-center whitespace-nowrap"},T={class:"text-center whitespace-nowrap"},U=s("br",null,null,-1),j={class:"text-center whitespace-nowrap"},K=s("br",null,null,-1),q=s("br",null,null,-1),A={class:"text-center whitespace-nowrap"},G={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},H={class:"flex items-center"},J={class:"flex justify-end"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},_e={__name:"Index",setup(W){const n=w({data:[],isLoading:!0}),u=x({date:null,page:0,first:0,rows:15,sortField:null,sortOrder:null}),k=w([{name:"Місяць",code:"month"},{name:"Залишок на початок місяця",code:"start_month_balance"},{name:"Надходження",code:"approved_income"},{name:"Списання",code:"approved_consumption"},{name:"Залишок на кінець місяця",code:"end_month_balance"},{name:"Чистий грошовий потік",code:"difference"}]),g=x(k),L=x([]),v=w({}),P=N(()=>{let e={};return u.value.sortField&&(e.sort=u.value.sortField,u.value.sortOrder===1?e.param="asc":u.value.sortOrder===-1&&(e.param="desc")),{perPage:u.value.rows||15,sort:e.sort&&e.param?e.sort:null,param:e.sort&&e.param?e.param:null,page:(u.value.page||0)+1}});O(async()=>{await y()});const y=async()=>{n.isLoading=!0,await axios.get(route("api.statistics.cash-flow",P.value)).then(({data:e})=>n.data=e.result).catch(e=>console.log(e)),n.isLoading=!1},h=e=>g.value.some(r=>r.code===e),$=async e=>{u.value=e,await y()},R=async e=>{u.value=e,await y()},M=async e=>{n.isLoading=!0,await axios.get(route("api.statistics.bank-card-movements.cost-and-profit",e.data.month)).then(({data:r})=>{v[e.data.id]=r.result,n.isLoading=!1})};return(e,r)=>(c(),p(C,null,{header:t(()=>[l(" CashFlow ")]),default:t(()=>[s("div",S,[n.data.data?(c(),p(z,{key:0,data:n.data.data},null,8,["data"])):m("",!0),_(o(b),{resizableColumns:"",columnResizeMode:"expand",expandedRows:L.value,"onUpdate:expandedRows":r[2]||(r[2]=a=>L.value=a),onRowExpand:M,selectionMode:"single",ref:"dt",dataKey:"month",loading:n.isLoading,value:n.data.data,class:"p-datatable-sm cash-flow-table",lazy:"",paginator:"",rows:n.data.per_page,totalRecords:n.data.total,onPage:r[3]||(r[3]=a=>$(a)),onSort:r[4]||(r[4]=a=>R(a)),rowsPerPageOptions:[15,50,100,500],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},{header:t(()=>[_(o(F),{modelValue:g.value,"onUpdate:modelValue":r[0]||(r[0]=a=>g.value=a),options:k,optionLabel:"name",placeholder:"Оберіть стовпці",class:"w-full md:w-20rem"},null,8,["modelValue","options"])]),footer:t(()=>[s("div",G,[s("div",H," Показано з "+d(n.data.from)+" по "+d(n.data.to)+" із "+d(n.data.total)+" записів ",1),s("div",J,[_(o(V),{icon:"pi pi-file-export",iconPos:"right",type:"button",label:"Експортувати",onClick:r[1]||(r[1]=()=>{})})])])]),expansion:t(a=>[s("div",Q,[v[a.data.id]?(c(),p(o(b),{key:0,value:v[a.data.id].costs,class:"p-datatable cash-flow-profits-table"},{default:t(()=>[_(o(i),{header:"Витрати"},{body:t(({data:f})=>[l(d(f.key),1)]),_:1}),_(o(i),null,{body:t(({data:f})=>[l(d(e.$filters.formatMoney(-f.value)),1)]),_:1})]),_:2},1032,["value"])):m("",!0),v[a.data.id]?(c(),p(o(b),{key:1,value:v[a.data.id].profits,class:"p-datatable cash-flow-profits-table"},{default:t(()=>[_(o(i),{header:"Надходження"},{body:t(({data:f})=>[l(d(f.key),1)]),_:1}),_(o(i),null,{body:t(({data:f})=>[l(d(e.$filters.formatMoney(f.value)),1)]),_:1})]),_:2},1032,["value"])):m("",!0)])]),default:t(()=>[_(o(i),{expander:""}),h("month")?(c(),p(o(i),{key:0,sortable:"",field:"month",header:"Місяць"},{body:t(({data:a})=>[s("div",B,d(e.$filters.dateFormat(a.month)),1)]),_:1})):m("",!0),h("start_month_balance")?(c(),p(o(i),{key:1,sortable:"",field:"start_month_balance"},{header:t(()=>[l(" Залишок"),D,l("на початок місяця ")]),body:t(({data:a})=>[s("div",E,d(e.$filters.formatMoney(a.start_month_balance)),1)]),_:1})):m("",!0),h("approved_income")?(c(),p(o(i),{key:2,sortable:"",field:"approved_income",header:"Надходження"},{body:t(({data:a})=>[s("div",I,d(e.$filters.formatMoney(a.approved_income)),1)]),_:1})):m("",!0),h("approved_consumption")?(c(),p(o(i),{key:3,sortable:"",field:"approved_consumption",header:"Списання"},{body:t(({data:a})=>[s("div",T,d(e.$filters.formatMoney(a.approved_consumption)),1)]),_:1})):m("",!0),h("end_month_balance")?(c(),p(o(i),{key:4,sortable:"",field:"end_month_balance"},{header:t(()=>[l(" Залишок"),U,l("на кінець місяця ")]),body:t(({data:a})=>[s("div",j,d(e.$filters.formatMoney(a.end_month_balance)),1)]),_:1})):m("",!0),h("difference")?(c(),p(o(i),{key:5,sortable:"",field:"difference"},{header:t(()=>[l(" Чистий"),K,l("грошовий"),q,l("потік ")]),body:t(({data:a})=>[s("div",A,d(e.$filters.formatMoney(a.difference)),1)]),_:1})):m("",!0)]),_:1},8,["expandedRows","loading","value","rows","totalRecords"])])]),_:1}))}};export{_e as default};
