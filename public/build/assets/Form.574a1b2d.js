import{z as U,aA as O,y as Y,C as q,L as b,M as l,K as s,X as C,_ as y,ad as j,a0 as c,bh as _,P as f,O as I,Y as p,B as A,V as x,S as a}from"./___vite-browser-external_commonjs-proxy.45af3daa.js";import G from"./ItemsModal.e43ef458.js";import H from"./ItemsTable.48bd35e4.js";import J from"./ClientOrders.42e6ec90.js";import Q from"./Table.c04318de.js";import Z from"./Modal.23849084.js";import"./ItemsForm.e4e68cc1.js";import"./Form.306b1569.js";const ee={class:"grid gap-4"},te={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},oe={class:"block"},le={class:"block"},se={class:"block"},de={class:"block"},ie=p(" \u041A\u0430\u0440\u0442\u043A\u0430 \u043A\u043B\u0456\u0454\u043D\u0442\u0430 "),ne={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ae={class:"block"},re={class:"block"},ue={key:0,class:"block"},me=l("hr",null,null,-1),ce={class:"grid grid-cols-1 md:grid-cols-4 mb-5"},ve={class:"block mb-5 md:mr-5"},ye={class:"block mb-5 md:mr-5"},be={class:"block mb-5 md:mr-5"},fe={class:"block mb-5"},Ve={class:"grid grid-cols-1 md:grid-cols-2 mb-10"},he={class:"block md:mr-5"},ke={class:"block mb-5"},ge={class:"block mb-5"},xe={class:"block"},pe={key:0},we={key:1},Ie=p(" \u0422\u0422\u041D \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 ("),Me=p(") "),Ue={class:"block"},Ce={class:"mb-7"},Fe={class:"grid grid-cols-2"},$e={class:"block mb-5 mr-5"},Se={class:"block mb-5"},Oe={class:"grid grid-cols-2"},je={class:"block mb-5 mr-5"},_e={class:"block mb-5"},Ae={key:2},Ee={class:"grid grid-cols-2"},Be={class:"block mb-5 mr-5"},De={class:"block mb-5"},Ne={class:"block mb-5"},ze=p("\u0414\u043E\u0434\u0430\u0442\u0438 \u0442\u043E\u0432\u0430\u0440"),Te={class:"grid grid-cols-1 md:grid-cols-4 mt-5"},Le={class:"flex justify-center"},Pe=l("p",{class:"font-semibold text-l text-gray-900 dark:text-white"}," \u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u0442\u043E\u0432\u0430\u0440\u0456\u0432:\xA0 ",-1),We={class:"text-l text-gray-900 dark:text-white"},Ke={class:"flex justify-center"},Re=l("p",{class:"font-semibold text-l text-gray-900 dark:text-white"}," \u0417\u0430\u0433\u0430\u043B\u044C\u043D\u0430 \u0446\u0456\u043D\u0430:\xA0 ",-1),Xe={class:"text-l text-gray-900 dark:text-white"},Ye={class:"flex justify-center"},qe=l("p",{class:"font-semibold text-l text-gray-900 dark:text-white"}," \u0426\u0456\u043D\u0430 \u043D\u0430 \u043F\u043E\u0441\u0438\u043B\u043A\u0443:\xA0 ",-1),Ge={class:"text-l text-gray-900 dark:text-white"},He={class:"flex justify-center"},Je=l("p",{class:"font-semibold text-l text-gray-900 dark:text-white"}," \u041F\u0440\u043E\u043C\u043E-\u043A\u043E\u0434:\xA0 ",-1),Qe={class:"text-l text-gray-900 dark:text-white"},Ze={key:1,class:"block"},et=p(" \u0414\u043E\u0434\u0430\u0442\u0438 \u0440\u0430\u0445\u0443\u043D\u043E\u043A "),rt={__name:"Form",props:["order","statuses","paymentMethods","invoiceStatuses"],emits:["submitItemForm","onEditClient"],setup(e,{emit:V}){const r=e,m=A("$swal"),h=A("$can"),F=U(()=>r.order.prepayment?r.order.total_price-r.order.prepayment_sum:r.order.total_price);console.log(F.value);const $=O({order_id:r.order.id,sum:null}),i=Y({showItemsModal:!1,showInvoicesModal:!1,itemsModalAction:"",item:{count:1,size:"",color:"",product_id:null},invoiceItem:{},statuses:[],managers:[],paymentMethods:[]});q(()=>{P();for(const[d,t]of Object.entries(r.statuses))i.value.statuses.push({key:d,value:t});for(const[d,t]of Object.entries(r.paymentMethods))i.value.paymentMethods.push({key:d,value:t})});const E=U(()=>i.value.showItemsModal?G:null),B=U(()=>i.value.showInvoicesModal?Z:null),k=O([{key:0,value:"\u041D\u0456"},{key:1,value:"\u0422\u0430\u043A"}]);function w(){i.value.showInvoicesModal=!i.value.showInvoicesModal}function D(d){h("destroy-invoices")&&m({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(t=>{t.isConfirmed&&axios.delete(route("api.invoices.destroy",d)).then(()=>{V("submitItemForm"),m({icon:"success",title:"Destroyed!"})}).catch(n=>{console.log(n),m({icon:"error",title:"Error!"})})})}function N(){h("create-invoices")&&(i.value.invoiceItem=$,w())}function z(){axios.post(route("api.invoices.create"),i.value.invoiceItem).then(({data:d})=>{i.value.invoiceItem=$,w(),navigator.clipboard.writeText(d.result.data.invoice_url),m({title:"\u0423\u0441\u043F\u0456\u0448\u043D\u043E!",text:"\u0420\u0430\u0445\u0443\u043D\u043E\u043A \u0431\u0443\u0432 \u0443\u0441\u043F\u0456\u0448\u043D\u043E \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u0438\u0439, \u043F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F \u043D\u0430 \u043E\u043F\u043B\u0430\u0442\u0443 \u0441\u043A\u043E\u043F\u0456\u0439\u043E\u0432\u0430\u043D\u043E \u0432 \u0431\u0443\u0444\u0435\u0440 \u043E\u0431\u043C\u0456\u043D\u0443",icon:"success"}),V("submitItemForm",d.result)}).catch(d=>{console.log(d),m({title:"Error!",icon:"error"})})}function S(){r.order.waybill&&axios.post(route("notify.waybill"),{phone:r.order.client.phone,waybill:r.order.waybill,order_id:r.order.id}).then(({data:d})=>{d.success===!0?m({icon:"success",title:"\u041D\u043E\u043C\u0435\u0440 \u043D\u0430\u043A\u043B\u0430\u0434\u043D\u043E\u0439 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D \u043A\u043B\u0438\u0435\u043D\u0442\u0443",text:d.info}):m({icon:"error",title:"\u041E\u0448\u0438\u0431\u043A\u0430",text:d.info}),axios.put(route("api.orders.update",r.order.id),r.order)}).catch(d=>{m({icon:"error",title:"\u041E\u0448\u0438\u0431\u043A\u0430",text:"\u041E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u043A \u0430\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\u0443"}),console.log(d)})}function T(){i.value.itemsModalAction==="create"?axios.post(route("api.order-items.add",r.order.id),i.value.item).then(({data:d})=>{g(),V("submitItemForm",d.result)}).catch(d=>console.log(d)):i.value.itemsModalAction==="edit"&&axios.put(route("api.order-items.update",i.value.item.id),i.value.item).then(({data:d})=>{g(),V("submitItemForm",d.result)}).catch(d=>console.log(d))}function L(){g(),i.value.itemsModalAction="create"}function g(){i.value.showItemsModal=!i.value.showItemsModal}function P(){axios.get(route("api.users.list.managers")).then(({data:d})=>{d.result.length&&d.result.forEach(t=>{i.value.managers.push({key:t.id,value:t.name})})}).catch(d=>console.log(d))}function W(d,t){m({title:"Are you sure?",icon:"warning",showCancelButton:!0}).then(n=>{n.isConfirmed&&axios.delete(route("api.order-items.destroy",{item_id:d,order_id:r.order.id})).then(()=>{r.order.items.splice(t,1),m({title:"Success",icon:"success"})}).catch(u=>{console.log(u),m({title:"Error",icon:"error"})})})}function K(d){g(),i.value.itemsModalAction="edit",axios.get(route("api.order-items.edit",d)).then(({data:t})=>i.value.item=t.result).catch(t=>console.log(t))}function R(){m({title:"\u0423\u0441\u043F\u0456\u0448\u043D\u043E",text:"\u041F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F \u043D\u0430 \u043E\u043F\u043B\u0430\u0442\u0443 \u043D\u0430\u0434\u0456\u0441\u043B\u0430\u043D\u043E \u043A\u043B\u0456\u0454\u043D\u0442\u0443",icon:"success"}),V("submitItemForm")}return(d,t)=>{const n=x("label-component"),u=x("input-component"),M=x("button-component"),v=x("select-component"),X=x("textarea-component");return a(),b("form",ee,[l("div",te,[l("div",oe,[s(n,{value:"\u0406\u043C\u02BC\u044F"}),s(u,{modelValue:e.order.client.name,"onUpdate:modelValue":t[0]||(t[0]=o=>e.order.client.name=o),type:"text",disabled:""},null,8,["modelValue"])]),l("div",le,[s(n,{value:"\u041F\u0440\u0456\u0437\u0432\u0438\u0449\u0435"}),s(u,{modelValue:e.order.client.last_name,"onUpdate:modelValue":t[1]||(t[1]=o=>e.order.client.last_name=o),type:"text",disabled:""},null,8,["modelValue"])]),l("div",se,[s(n,{value:"\u041F\u043E-\u0431\u0430\u0442\u044C\u043A\u043E\u0432\u0456"}),s(u,{modelValue:e.order.client.middle_name,"onUpdate:modelValue":t[2]||(t[2]=o=>e.order.client.middle_name=o),type:"text",disabled:""},null,8,["modelValue"])]),l("div",de,[s(n,{value:"\xA0"}),s(M,{class:"w-full",type:"button",onClick:t[3]||(t[3]=o=>d.$emit("onEditClient"))},{default:C(()=>[ie]),_:1})])]),l("div",ne,[l("div",ae,[s(n,{value:"\u0421\u0442\u0430\u0442\u0443\u0441 \u043A\u043B\u0456\u0454\u043D\u0442\u0430"}),s(u,{modelValue:e.order.client.status,"onUpdate:modelValue":t[4]||(t[4]=o=>e.order.client.status=o),type:"text",disabled:""},null,8,["modelValue"])]),l("div",re,[s(n,{value:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D"}),s(u,{modelValue:e.order.client.phone,"onUpdate:modelValue":t[5]||(t[5]=o=>e.order.client.phone=o),type:"text",disabled:""},null,8,["modelValue"])])]),e.order.client.orders.length>1?(a(),b("div",ue,[s(J,{data:e.order.client.orders,statuses:e.statuses},null,8,["data","statuses"])])):y("",!0),me,l("div",ce,[l("div",ve,[s(n,{value:"\u0421\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F"}),s(v,{modelValue:e.order.status,"onUpdate:modelValue":t[6]||(t[6]=o=>e.order.status=o),options:i.value.statuses},null,8,["modelValue","options"])]),l("div",ye,[s(n,{value:"\u041C\u0435\u043D\u0435\u0434\u0436\u0435\u0440"}),s(v,{modelValue:e.order.manager_id,"onUpdate:modelValue":t[7]||(t[7]=o=>e.order.manager_id=o),options:i.value.managers},null,8,["modelValue","options"])]),l("div",be,[s(n,{value:"\u0421\u043F\u043E\u0441\u0456\u0431 \u043E\u043F\u043B\u0430\u0442\u0438"}),s(v,{modelValue:e.order.payment_method,"onUpdate:modelValue":t[8]||(t[8]=o=>e.order.payment_method=o),options:i.value.paymentMethods},null,8,["modelValue","options"])]),l("div",fe,[s(n,{value:"\u041D\u0430\u0433\u0430\u0434\u0443\u0432\u0430\u043D\u043D\u044F \u043F\u0440\u043E \u043F\u043E\u0441\u0438\u043B\u043A\u0443"}),s(v,{modelValue:e.order.parcel_reminder,"onUpdate:modelValue":t[9]||(t[9]=o=>e.order.parcel_reminder=o),options:k},null,8,["modelValue","options"])])]),l("div",Ve,[l("div",he,[l("div",ke,[s(n,{value:"\u041C\u0456\u0441\u0442\u043E"}),s(u,{modelValue:e.order.city,"onUpdate:modelValue":t[10]||(t[10]=o=>e.order.city=o),type:"text"},null,8,["modelValue"])]),l("div",ge,[s(n,{value:"\u041F\u043E\u0447\u0442\u043E\u0432\u0435 \u0432\u0456\u0434\u0434\u0456\u043B\u0435\u043D\u043D\u044F"}),s(u,{modelValue:e.order.postal_office,"onUpdate:modelValue":t[11]||(t[11]=o=>e.order.postal_office=o),type:"text"},null,8,["modelValue"])]),l("div",xe,[s(n,{value:"\u041D\u043E\u043C\u0435\u0440 \u043D\u0430\u043A\u043B\u0430\u0434\u043D\u043E\u0457"}),s(u,{modelValue:e.order.waybill,"onUpdate:modelValue":t[12]||(t[12]=o=>e.order.waybill=o),type:"text"},null,8,["modelValue"]),!e.order.sms_waybill_status&&e.order.waybill?(a(),b("div",pe,[l("a",{href:"javascript:",onClick:t[13]||(t[13]=j(o=>S(e.order.client.phone,e.order.waybill),["prevent"]))},"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u0422\u0422\u041D \u043A\u043B\u0438\u0435\u043D\u0442\u0443")])):y("",!0),e.order.sms_waybill_status?(a(),b("div",we,[Ie,l("a",{href:"javascript:",onClick:t[14]||(t[14]=j(o=>S(e.order.client.phone,e.order.waybill),["prevent"]))},"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E"),Me])):y("",!0)])]),l("div",Ue,[s(n,{value:"\u041A\u043E\u043C\u0435\u043D\u0442\u0430\u0440"}),s(X,{rows:"10",modelValue:e.order.comment,"onUpdate:modelValue":t[15]||(t[15]=o=>e.order.comment=o)},null,8,["modelValue"])])]),l("div",Ce,[l("div",Fe,[l("div",$e,[s(n,{value:"\u0414\u043E\u0434.\u043F\u0440\u043E\u0434\u0430\u0436 \u043F\u043E\u0432\u0456\u0442\u0440\u044F"}),s(v,{modelValue:e.order.sale_of_air,"onUpdate:modelValue":t[16]||(t[16]=o=>e.order.sale_of_air=o),options:k},null,8,["modelValue","options"])]),l("div",Se,[s(n,{value:"\u0421\u0443\u043C\u0430 \u0434\u043E\u043F.\u043F\u0440\u043E\u0434\u0430\u0436\u0443 \u043F\u043E\u0432\u0456\u0442\u0440\u044F (\u0433\u0440\u043D.)"}),e.order.sale_of_air?(a(),c(u,{key:0,modelValue:e.order.sale_of_air_price,"onUpdate:modelValue":t[17]||(t[17]=o=>e.order.sale_of_air_price=o),type:"number"},null,8,["modelValue"])):(a(),c(u,{key:1,modelValue:e.order.sale_of_air_price,"onUpdate:modelValue":t[18]||(t[18]=o=>e.order.sale_of_air_price=o),type:"number",disabled:""},null,8,["modelValue"]))])]),l("div",Oe,[l("div",je,[s(n,{value:"\u041F\u0435\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0430"}),e.order.wfp_payment?(a(),c(v,{key:1,modelValue:e.order.prepayment,"onUpdate:modelValue":t[20]||(t[20]=o=>e.order.prepayment=o),options:k,disabled:""},null,8,["modelValue","options"])):(a(),c(v,{key:0,modelValue:e.order.prepayment,"onUpdate:modelValue":t[19]||(t[19]=o=>e.order.prepayment=o),options:k},null,8,["modelValue","options"]))]),l("div",_e,[s(n,{value:"\u0421\u0443\u043C\u0430 \u043F\u0435\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0438 (\u0433\u0440\u043D.)"}),e.order.prepayment&&!e.order.wfp_payment?(a(),c(u,{key:0,modelValue:e.order.prepayment_sum,"onUpdate:modelValue":t[21]||(t[21]=o=>e.order.prepayment_sum=o),type:"number"},null,8,["modelValue"])):(a(),c(u,{key:1,modelValue:e.order.prepayment_sum,"onUpdate:modelValue":t[22]||(t[22]=o=>e.order.prepayment_sum=o),type:"number",disabled:""},null,8,["modelValue"])),e.order.wfp_payment?(a(),b("span",Ae,"\u041E\u043F\u043B\u0430\u0447\u0435\u043D\u043E \u043D\u0430 \u0441\u0430\u0439\u0442\u0456")):y("",!0)])]),l("div",Ee,[l("div",Be,[s(n,{value:"\u0417\u043D\u0438\u0436\u043A\u0430"}),s(v,{modelValue:e.order.discount,"onUpdate:modelValue":t[23]||(t[23]=o=>e.order.discount=o),options:k},null,8,["modelValue","options"])]),l("div",De,[s(n,{value:"\u0421\u0443\u043C\u0430 \u0437\u043D\u0438\u0436\u043A\u0438 (\u0433\u0440\u043D.)"}),e.order.discount?(a(),c(u,{key:0,modelValue:e.order.discount_sum,"onUpdate:modelValue":t[24]||(t[24]=o=>e.order.discount_sum=o),type:"number"},null,8,["modelValue"])):(a(),c(u,{key:1,modelValue:e.order.discount_sum,"onUpdate:modelValue":t[25]||(t[25]=o=>e.order.discount_sum=o),type:"number",disabled:""},null,8,["modelValue"]))])])]),l("div",Ne,[s(M,{type:"button",onClick:L},{default:C(()=>[ze]),_:1}),(a(),c(_(f(E)),{item:i.value.item,size:"medium",onCloseModal:g,onSubmitItemForm:T},null,40,["item"]))]),s(H,{data:e.order.items,onEditOrderItem:K,onDestroyOrderItem:W},null,8,["data"]),l("div",Te,[l("div",Le,[Pe,l("p",We,I(e.order.total_count),1)]),l("div",Ke,[Re,l("p",Xe,I(d.$filters.formatMoney(e.order.total_price)),1)]),l("div",Ye,[qe,l("p",Ge,I(f(F)),1)]),l("div",He,[Je,l("p",Qe,I(e.order.promo_code?e.order.promo_code:"\u0412\u0456\u0434\u0441\u0443\u0442\u043D\u0456\u0439"),1)])]),f(h)("show-invoices")?(a(),b("div",Ze,[f(h)("create-invoices")?(a(),c(M,{key:0,type:"button",onClick:N,class:"my-4"},{default:C(()=>[et]),_:1})):y("",!0),e.order.invoices.length?(a(),c(Q,{key:1,data:e.order.invoices,statuses:e.invoiceStatuses,"can-destroy":f(h)("destroy-invoices"),onOnDestroy:D,onOnSendInvoiceSms:R},null,8,["data","statuses","can-destroy"])):y("",!0),(a(),c(_(f(B)),{item:i.value.invoiceItem,onCloseModal:w,onSubmitForm:z,onDeclineForm:w},null,40,["item"]))])):y("",!0)])}}};export{rt as default};
