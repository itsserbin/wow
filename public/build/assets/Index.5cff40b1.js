import K from"./Modal.ce7f2c1f.js";import Q from"./Chart.1e666b17.js";import W from"./StatisticLayout.aa4de5c9.js";import{g as X}from"./app.ec5dc424.js";import{G as h,Y as A,H as Z,ac as M,C as g,A as n,y as s,J as k,u as b,am as D,v,z as r,F as P,B,O as d,w as f,b5 as ee,aP as L,D as u}from"./_plugin-vue_export-helper.f12554ed.js";import"./Form.f0213d59.js";import"./index.86214304.js";import"./Sidebar.620cebe0.js";const te=d(" \u0412\u0438\u0442\u0440\u0430\u0442\u0438 "),oe={key:1},ae=d(" \u0414\u043E\u0434\u0430\u0442\u0438 "),le={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-5"},ne={class:"block"},se={class:"block"},ie={class:"grid grid-cols-2 md:grid-cols-4 gap-4 my-5"},ce={class:"grid grid-cols-2 md:grid-cols-6"},re=["onClick"],ue=["onClick"],ke={__name:"Index",setup(de){const m=L("$swal"),i=L("$can"),w={name:null,date:null,sum:null,quantity:1,comment:null,total:null,cost_category_id:null},o=h({colors:[],isLoading:!0,isActiveModal:!1,modalAction:"",item:{}}),a=h({date:[],filter:null,last:"one-month",currentPage:1}),C=h([]),F=A(()=>{const e={};return a.value.filter&&(e.filter=a.value.filter),a.value.date.length===2&&(e.date_start=a.value.date[0],e.date_end=a.value.date[1]),a.value.last&&(e.last=a.value.last),e.page=a.value.currentPage,route("api.statistics.costs.index",e)});function S(e){e?a.value.last=e:a.value={date:[],filter:null,last:null,currentPage:1},c()}function E(){a.value.last="range",c()}Z(()=>{c(),axios.get(route("api.statistics.costs.categories.list")).then(({data:e})=>{e.result.forEach(l=>{C.value.push({value:l.title,key:l.id})})}).catch(e=>console.log(e))});const j=A(()=>o.value.isActiveModal?K:null),O=M([{label:"ID",key:"id"},{label:"\u0414\u0430\u0442\u0430",key:"date"},{label:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0456\u044F",key:"category"},{label:"\u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C",key:"quantity"},{label:"\u0421\u0443\u043C\u0430",key:"sum"},{label:"\u0417\u0430\u0433\u0430\u043B\u043E\u043C",key:"total"},{label:"\u0412\u0456\u0434\u043F\u043E\u0432\u0456\u0434\u0430\u043B\u044C\u043D\u0438\u0439",key:"user"},{label:"\u041A\u043E\u043C\u0435\u043D\u0442\u0430\u0440",key:"comment"},{label:"\u041E\u043D\u043E\u0432\u043B\u0435\u043D\u043E<hr class='my-1'>\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043E",key:"timestamps"},{label:"#",key:"actions"}]),N=M([{label:"\u0412\u0435\u0441\u044C \u0447\u0430\u0441",key:null},{label:"\u041F\u043E\u0442\u043E\u0447\u043D\u0438\u0439 \u0442\u0438\u0436\u0434\u0435\u043D\u044C",key:"week"},{label:"\u041F\u043E\u0442\u043E\u0447\u043D\u0438\u0439 \u0442\u0430 \u043F\u043E\u043F\u0435\u0440\u0435\u0434\u043D\u0456 \u0442\u0438\u0436\u043D\u0456",key:"two-week"},{label:"\u041F\u043E\u0442\u043E\u0447\u043D\u0438\u0439 \u043C\u0456\u0441\u044F\u0446\u044C",key:"one-month"}]);function c(){o.value.isLoading=!0,axios.get(F.value).then(e=>{Object.assign(o.value.colors,e.data),o.value.isLoading=!1}).catch(e=>{console.log(e),o.value.isLoading=!1})}function V(e){i("destroy-colors")&&m({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(l=>{l.isConfirmed&&axios.delete(route("api.statistics.costs.destroy",e)).then(()=>{c(),o.value.isActiveModal&&_(),m({icon:"success",title:"Destroyed!"})}).catch(p=>{console.log(p),m({icon:"error",title:"Error!"})})})}function _(){o.value.isActiveModal=!o.value.isActiveModal}function U(e,l){i("edit-colors")&&axios.get(route("api.statistics.costs.edit",e)).then(({data:p})=>{o.value.item=p.result,o.value.modalAction="edit",o.value.item.index=l,_()}).catch(p=>console.log(p))}function q(){i("edit-colors")&&axios.put(route("api.statistics.costs.update",o.value.item.id),o.value.item).then(()=>{_(),c(),m({title:"Success!",icon:"success"})}).catch(e=>{console.log(e),m({title:"Error!",icon:"error"})})}function I(){i("create-colors")&&axios.post(route("api.statistics.costs.create"),o.value.item).then(()=>{_(),o.value.item=w,c(),m({title:"Success!",icon:"success"})}).catch(e=>{console.log(e),m({title:"Error!",icon:"error"})})}function T(){o.value.modalAction==="edit"&&i("edit-colors")?q():o.value.modalAction==="create"&&i("create-colors")&&I()}function z(){i("create-colors")&&(Object.assign(o.value.item,w),o.value.modalAction="create",_())}return(e,l)=>{const p=u("loader-component"),$=u("button-component"),x=u("label-component"),G=u("select-component"),H=u("Datepicker"),J=u("card-component"),R=u("xcircle-component"),Y=u("table-component");return s(),g(W,{title:"\u0412\u0438\u0442\u0440\u0430\u0442\u0438"},{header:n(()=>[te]),default:n(()=>[o.value.isLoading?(s(),g(p,{key:0})):k("",!0),o.value.isLoading?k("",!0):(s(),b("div",oe,[D(i)("create-providers")?(s(),g($,{key:0,type:"btn",onClick:z},{default:n(()=>[ae]),_:1})):k("",!0),v("div",le,[v("div",ne,[r(x,{value:"\u0424\u0456\u043B\u044C\u0442\u0440 \u043F\u043E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0456\u0457"}),r(G,{modelValue:a.value.filter,"onUpdate:modelValue":l[0]||(l[0]=t=>a.value.filter=t),options:C.value,onChange:c},null,8,["modelValue","options"])]),v("div",se,[r(x,{value:"\u0424\u0456\u043B\u044C\u0442\u0440 \u043F\u043E \u0434\u0430\u0442\u0456"}),r(H,{modelValue:a.value.date,"onUpdate:modelValue":[l[1]||(l[1]=t=>a.value.date=t),E],class:"w-100",locale:"ru",placeholder:"\u041E\u0431\u0435\u0440\u0456\u0442\u044C \u0434\u0430\u0442\u0443",autoApply:"",monthChangeOnScroll:!1,enableTimePicker:!1,range:"",utc:""},null,8,["modelValue"])])]),v("div",ie,[(s(!0),b(P,null,B(N,t=>(s(),g($,{type:"btn",onClick:y=>S(t.key),active:t.key===a.value.last},{default:n(()=>[d(f(t.label),1)]),_:2},1032,["onClick","active"]))),256))]),r(Q,{"chart-data":o.value.colors.all},null,8,["chart-data"]),v("div",ce,[(s(!0),b(P,null,B(o.value.colors.generalStat,(t,y)=>(s(),g(J,{class:"text-center",title:y,description:e.$filters.formatMoney(t)},null,8,["title","description"]))),256))]),r(Y,{headings:O,rows:o.value.colors.result.data,isSlotMode:!0},{id:n(({data:t})=>[v("a",{href:"javascript:",onClick:y=>U(t.row.id,t.i)},f(t.row.id),9,re)]),date:n(({data:t})=>[d(f(e.$filters.dateFormat(t.row.date)),1)]),category:n(({data:t})=>[d(f(t.row.category.title),1)]),sum:n(({data:t})=>[d(f(e.$filters.formatMoney(t.row.sum)),1)]),total:n(({data:t})=>[d(f(e.$filters.formatMoney(t.row.total)),1)]),user:n(({data:t})=>[d(f(t.row.user?t.row.user.name:"-"),1)]),actions:n(({data:t})=>[v("a",{href:"javascript:",onClick:y=>V(t.row.id)},[r(R)],8,ue)]),_:1},8,["headings","rows"]),r(X,{pagination:o.value.colors.result,"click-handler":c,modelValue:a.value.currentPage,"onUpdate:modelValue":l[2]||(l[2]=t=>a.value.currentPage=t)},null,8,["pagination","modelValue"]),(s(),g(ee(D(j)),{item:o.value.item,onCloseModal:_,onSubmitForm:T,onDeclineForm:V},null,40,["item"]))]))]),_:1})}}};export{ke as default};
