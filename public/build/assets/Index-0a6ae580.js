import M from"./Modal-b19d4de4.js";import L from"./Table-909e8210.js";import V from"./ContentLayout-1276209e.js";import{L as b}from"./Loader-ccf6e4ba.js";import{_ as B}from"./Paginate-01527c78.js";import{_ as N}from"./Button-dd1aed97.js";import{C as n}from"./Form-79b5c81b.js";import{N as P,ae as F,g as E,k as O,o as j,z as I,l as u,s as m,y as p,w as f,v as w,t as v,x as d,m as S,p as _,n as y,a0 as U}from"./index-a01126e2.js";import{s as l}from"./swal-03cac797.js";import"./Modal-e072f216.js";import"./LangTabs-9cff8ebb.js";import"./Table-fe1ca8dd.js";import"./XCircle-3c75bba8.js";import"./AuthenticatedLayout-704e8f94.js";import"./index.esm-02fff71f.js";import"./Logo-83ffc10f.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ImagesSelectModal-c14951e7.js";import"./UploadImagesModal-452117b9.js";import"./UploadImagesInput-5c733d39.js";import"./Label-20131f4c.js";import"./ImageCard-674c7c55.js";import"./InputError-f28ae438.js";import"./Input-39294dfa.js";import"./Textarea-cb91500a.js";import"./Select-c098c0c0.js";import"./Editor-fb472374.js";const z={key:1,class:"grid gap-4 grid-cols-1"},R={class:"text-center"},we={__name:"Index",setup(T){const a=P("$can"),{t:o}=F(),k=E({published:0,slug:null,parent_id:null,preview_id:null,preview:null,title:{ru:null,ua:null},meta_title:{ru:null,ua:null},meta_description:{ru:null,ua:null},meta_keyword:{ru:null,ua:null},seo_text:{ru:null,ua:null}}),e=O({categories:[],currentPage:1,isLoading:!0,isActiveModal:!1,modalAction:"",item:{},errors:[]});j(()=>{c(1)});const h=I(()=>e.value.isActiveModal?M:null),c=async t=>{e.value.isLoading=!0,t&&(e.value.currentPage=t);const i=await n.fetch({page:e.value.currentPage});e.value.categories=i.success?i.result:[],e.value.isLoading=!1},g=async t=>{if(a("destroy-categories")&&(await l({title:o("swal.sure"),icon:"warning",showCancelButton:!0})).isConfirmed){const{success:r}=await n.destroy(t);r&&(await c(),e.value.isActiveModal&&s(),await l({icon:"success",title:o("swal.destroyed")}))}},s=()=>{e.value.isActiveModal=!e.value.isActiveModal},A=async(t,i)=>{if(a("edit-categories")){const r=await n.edit(t);r.success&&(e.value.item=r.result,e.value.modalAction="edit",e.value.item.index=i,s())}},C=async()=>{if(a("edit-categories")){const t=await n.update(e.value.item);e.value.errors=[],t.success?(s(),await c(),await l({title:o("swal.updated"),icon:"success"})):(e.value.errors=t,console.log(t),await l({title:o("swal.error"),icon:"error",text:o("swal.check_data")}))}},D=async()=>{if(a("create-categories")){const t=await n.create(e.value.item);e.value.errors=[],t.success?(s(),e.value.item={},await c(),await l({title:o("swal.created"),icon:"success"})):(e.value.errors=t,console.log(t),await l({title:o("swal.error"),text:o("swal.check_data"),icon:"error"}))}},$=async()=>{e.value.modalAction==="edit"&&a("edit-categories")?await C():e.value.modalAction==="create"&&a("create-categories")&&await D()},x=()=>{a("create-categories")&&(Object.assign(e.value.item,k),e.value.modalAction="create",e.value.errors=[],s())};return(t,i)=>(u(),m(V,{title:t.$t("categories.page_title")},{header:p(()=>[f(w(t.$t("categories.page_title")),1)]),default:p(()=>[e.value.isLoading?(u(),m(b,{key:0})):v("",!0),!e.value.isLoading&&d(a)("show-categories")?(u(),S("div",z,[_("div",null,[d(a)("create-categories")?(u(),m(N,{key:0,type:"btn",onClick:x},{default:p(()=>[f(w(t.$t("add")),1)]),_:1})):v("",!0)]),y(L,{data:e.value.categories.data,onOnEdit:A,onOnDestroy:g,canDestroy:d(a)("destroy-categories")},null,8,["data","canDestroy"]),_("div",R,[y(B,{pagination:e.value.categories,"click-handler":c,modelValue:e.value.currentPage,"onUpdate:modelValue":i[0]||(i[0]=r=>e.value.currentPage=r)},null,8,["pagination","modelValue"])])])):v("",!0),(u(),m(U(d(h)),{item:e.value.item,errors:e.value.errors,onCloseModal:s,onSubmitForm:$,onDeclineForm:g,canDestroy:d(a)("destroy-categories")},null,40,["item","errors","canDestroy"]))]),_:1},8,["title"]))}};export{we as default};
