{"version":3,"file":"Index-65429ba3.js","sources":["../../../resources/js/Repositories/ImagesRepository.js","../../../resources/js/Pages/Admin/Content/Images/Index.vue"],"sourcesContent":["export default {\n    async fetch(params) {\n        try {\n            const response = await axios.get(route('api.images.index', params));\n            return response.data;\n        } catch (error) {\n            throw new Error(error.response.data);\n        }\n    },\n    async destroy(id) {\n        try {\n            const response = await axios.delete(route('api.images.destroy', id));\n            return response.data;\n        } catch (error) {\n            throw new Error(error.response.data);\n        }\n    },\n    async update(item) {\n        try {\n            const response = await axios.put(route('api.images.update', item.id), item)\n            return response.data;\n        } catch (error) {\n            throw new Error(error.response.data);\n        }\n    },\n};\n","<script setup>\nimport Loader from '@/Components/Loader.vue';\nimport Button from '@/Components/Button.vue';\nimport Paginate from '@/Components/Paginate.vue';\nimport UploadImagesModal from '@/Components/UploadImagesModal.vue';\nimport List from '@/Pages/Admin/Content/Images/List.vue';\nimport ImageModal from '@/Pages/Admin/Content/Images/Modal.vue';\nimport ContentLayout from '@/Pages/Admin/Content/ContentLayout.vue'\nimport {swal} from \"@/Includes/swal\";\n\nimport {onMounted, inject, ref, computed} from \"vue\";\nimport ImagesRepository from \"@/Repositories/ImagesRepository\";\nimport {useI18n} from 'vue-i18n'\n\nconst can = inject('$can');\nconst {t} = useI18n();\n\nconst state = ref({\n    imagesList: [],\n    isActiveUploadModal: false,\n    isActiveImageModal: false,\n    imageUploadModal: [],\n    imageModal: {\n        id: null,\n        src: null,\n        alt: null,\n    },\n    currentPage: 1,\n    isLoading: true,\n});\n\nconst imagesUploadModal = computed(() => state.value.isActiveUploadModal ? UploadImagesModal : null);\nconst imageModal = computed(() => state.value.isActiveImageModal ? ImageModal : null);\n\nonMounted(async() => await fetch());\n\nconst modalUploadImagesFunction = () => {\n    state.value.isActiveUploadModal = !state.value.isActiveUploadModal;\n}\n\nconst modalImagesFunction = () => {\n    state.value.isActiveImageModal = !state.value.isActiveImageModal;\n}\n\nconst openImageModal = (image) => {\n    modalImagesFunction();\n    state.value.imageModal = image;\n}\n\nconst updateImage = async () => {\n    if (can('edit-images')) {\n        const {success} = await ImagesRepository.update(state.value.imageModal);\n        if (success) {\n            modalImagesFunction();\n            await swal({\n                icon: 'success',\n                title: t('swal.updated')\n            })\n        }\n    }\n}\n\nconst destroyImageFromModal = async (id) => {\n    await destroyImage(id);\n    modalImagesFunction();\n}\n\nconst destroyImage = async (id) => {\n    if (can('destroy-images')) {\n        const result = await swal({\n            title: t('swal.sure'),\n            icon: 'warning',\n            showCancelButton: true,\n        });\n\n        if (result.isConfirmed) {\n            state.value.isLoading = true;\n            const {success} = await ImagesRepository.destroy(id);\n            if (success) {\n                await fetch();\n                await swal({\n                    icon: 'success',\n                    title: t('swal.destroyed')\n                });\n            }\n            state.value.isLoading = false;\n        }\n    }\n}\n\nconst fetch = async (page) => {\n    state.value.isLoading = true;\n    if (page) {\n        state.value.currentPage = page;\n    }\n    const data = await ImagesRepository.fetch({'page': state.value.currentPage});\n    state.value.imagesList = data.success ? data.result : [];\n    state.value.isLoading = false;\n}\n</script>\n\n<template>\n    <ContentLayout :title=\"$t('images.page_title')\">\n        <template #header>{{ $t('images.page_title') }}</template>\n\n        <Loader v-if=\"state.isLoading\"/>\n\n        <div v-if=\"!state.isLoading && can('show-images')\" class=\"grid grid-cols-1 gap-4\">\n            <div>\n                <Button type=\"btn\" @click.prevent=\"modalUploadImagesFunction\"\n                        v-if=\"can('create-images')\">\n                    {{ $t('add') }}\n                </Button>\n            </div>\n\n            <List :images=\"state.imagesList\"\n                  @clickImage=\"openImageModal\"\n                  @fetch=\"fetch\"\n                  @destroyImage=\"destroyImage\"\n            />\n\n            <div class=\"text-center\">\n                <Paginate :pagination=\"state.imagesList\"\n                          :click-handler=\"fetch\"\n                          v-model=\"state.currentPage\"\n                />\n            </div>\n        </div>\n\n        <component :is=\"imageModal\"\n                   @closeModal=\"modalImagesFunction\"\n                   @submitForm=\"updateImage\"\n                   @declineForm=\"destroyImageFromModal\"\n                   :image=\"state.imageModal\"\n                   size=\"large\"\n        ></component>\n\n        <component :is=\"imagesUploadModal\"\n                   @closeModal=\"modalUploadImagesFunction\"\n                   @onUpload=\"fetch\"\n        ></component>\n    </ContentLayout>\n</template>\n"],"names":["ImagesRepository","params","error","id","item","can","inject","t","useI18n","state","ref","imagesUploadModal","computed","UploadImagesModal","imageModal","ImageModal","onMounted","fetch","modalUploadImagesFunction","modalImagesFunction","openImageModal","image","updateImage","success","swal","destroyImageFromModal","destroyImage","page","data"],"mappings":"m5BAAA,MAAeA,EAAA,CACX,MAAM,MAAMC,EAAQ,CAChB,GAAI,CAEA,OADiB,MAAM,MAAM,IAAI,MAAM,mBAAoBA,CAAM,CAAC,GAClD,IACnB,OAAQC,EAAP,CACE,MAAM,IAAI,MAAMA,EAAM,SAAS,IAAI,CACtC,CACJ,EACD,MAAM,QAAQC,EAAI,CACd,GAAI,CAEA,OADiB,MAAM,MAAM,OAAO,MAAM,qBAAsBA,CAAE,CAAC,GACnD,IACnB,OAAQD,EAAP,CACE,MAAM,IAAI,MAAMA,EAAM,SAAS,IAAI,CACtC,CACJ,EACD,MAAM,OAAOE,EAAM,CACf,GAAI,CAEA,OADiB,MAAM,MAAM,IAAI,MAAM,oBAAqBA,EAAK,EAAE,EAAGA,CAAI,GAC1D,IACnB,OAAQF,EAAP,CACE,MAAM,IAAI,MAAMA,EAAM,SAAS,IAAI,CACtC,CACJ,CACL,+FCXA,MAAMG,EAAMC,EAAO,MAAM,EACnB,CAAC,EAAAC,CAAC,EAAIC,IAENC,EAAQC,EAAI,CACd,WAAY,CAAE,EACd,oBAAqB,GACrB,mBAAoB,GACpB,iBAAkB,CAAE,EACpB,WAAY,CACR,GAAI,KACJ,IAAK,KACL,IAAK,IACR,EACD,YAAa,EACb,UAAW,EACf,CAAC,EAEKC,EAAoBC,EAAS,IAAMH,EAAM,MAAM,oBAAsBI,EAAoB,IAAI,EAC7FC,EAAaF,EAAS,IAAMH,EAAM,MAAM,mBAAqBM,EAAa,IAAI,EAEpFC,EAAU,SAAW,MAAMC,EAAK,CAAE,EAElC,MAAMC,EAA4B,IAAM,CACpCT,EAAM,MAAM,oBAAsB,CAACA,EAAM,MAAM,mBACnD,EAEMU,EAAsB,IAAM,CAC9BV,EAAM,MAAM,mBAAqB,CAACA,EAAM,MAAM,kBAClD,EAEMW,EAAkBC,GAAU,CAC9BF,IACAV,EAAM,MAAM,WAAaY,CAC7B,EAEMC,EAAc,SAAY,CAC5B,GAAIjB,EAAI,aAAa,EAAG,CACpB,KAAM,CAAC,QAAAkB,CAAO,EAAI,MAAMvB,EAAiB,OAAOS,EAAM,MAAM,UAAU,EAClEc,IACAJ,IACA,MAAMK,EAAK,CACP,KAAM,UACN,MAAOjB,EAAE,cAAc,CACvC,CAAa,GAGb,EAEMkB,EAAwB,MAAOtB,GAAO,CACxC,MAAMuB,EAAavB,CAAE,EACrBgB,GACJ,EAEMO,EAAe,MAAOvB,GAAO,CAC/B,GAAIE,EAAI,gBAAgB,IACL,MAAMmB,EAAK,CACtB,MAAOjB,EAAE,WAAW,EACpB,KAAM,UACN,iBAAkB,EAC9B,CAAS,GAEU,YAAa,CACpBE,EAAM,MAAM,UAAY,GACxB,KAAM,CAAC,QAAAc,CAAO,EAAI,MAAMvB,EAAiB,QAAQG,CAAE,EAC/CoB,IACA,MAAMN,EAAK,EACX,MAAMO,EAAK,CACP,KAAM,UACN,MAAOjB,EAAE,gBAAgB,CAC7C,CAAiB,GAELE,EAAM,MAAM,UAAY,GAGpC,EAEMQ,EAAQ,MAAOU,GAAS,CAC1BlB,EAAM,MAAM,UAAY,GACpBkB,IACAlB,EAAM,MAAM,YAAckB,GAE9B,MAAMC,EAAO,MAAM5B,EAAiB,MAAM,CAAC,KAAQS,EAAM,MAAM,WAAW,CAAC,EAC3EA,EAAM,MAAM,WAAamB,EAAK,QAAUA,EAAK,OAAS,GACtDnB,EAAM,MAAM,UAAY,EAC5B"}