import q from"./Modal.1a967263.js";import I from"./Chart.00beeb6d.js";import P from"./Table.201fefae.js";import T from"./StatisticLayout.1151f9a1.js";import z from"./Datepicker.56195765.js";import{ag as G,p as v,f as A,q as H,ah as J,ai as K,m as p,w as g,v as V,B as d,o as c,j as _,u as b,g as C,i as m,x as r,F as Q,s as R,ab as W,k as M}from"./vendor.baa499d2.js";import"./Form.9366f75f.js";import"./__commonjsHelpers__.488ed5c2.js";import"./index.2e276325.js";import"./app.1c4fbfa0.js";import"./vue.m.8e70aa70.js";import"./bootstrap.2c4b2a4d.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./Logo.6344e541.js";const X=M(" \u0412\u0438\u0442\u0440\u0430\u0442\u0438 "),Y={key:1,class:"grid grid-cols-1 gap-4"},Z=M(" \u0414\u043E\u0434\u0430\u0442\u0438 "),tt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-5"},et={class:"block"},ot={class:"block"},at={class:"grid grid-cols-2 md:grid-cols-6"},nt={class:"text-center"},kt={__name:"Index",setup(st){const n=V("$swal"),w=V("$can"),f=G({name:null,date:null,sum:null,quantity:1,comment:null,total:null,cost_category_id:null,cost_type:"single"}),t=v({data:[],chart:[],isLoading:!0,isActiveModal:!1,modalAction:"",item:{}}),o=v({date:[],page:1}),h=v([]),x=A(()=>{const e={};return o.value.filter&&(e.filter=o.value.filter),o.value.date.length===2&&(e.date_start=o.value.date[0].toLocaleDateString(),e.date_end=o.value.date[1].toLocaleDateString()),e.page=o.value.page,e});H(()=>{o.value.date[0]=J(new Date),o.value.date[1]=K(new Date),s(),axios.get(route("api.statistics.costs.categories.list")).then(({data:e})=>{e.result.forEach(a=>{h.value.push({value:a.title,key:a.id})})}).catch(e=>console.log(e))});const D=A(()=>t.value.isActiveModal?q:null);function s(){t.value.isLoading=!0,axios.get(route("api.statistics.costs.index",x.value)).then(({data:e})=>{t.value.data=e,t.value.isLoading=!1}).catch(e=>{console.log(e),t.value.isLoading=!1}),axios.get(route("api.statistics.costs.chart",x.value)).then(({data:e})=>t.value.chart=e.result).catch(e=>console.log(e))}function k(e){n({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(a=>{a.isConfirmed&&axios.delete(route("api.statistics.costs.destroy",e)).then(()=>{s(),t.value.isActiveModal&&u(),n({icon:"success",title:"Destroyed!"})}).catch(l=>{console.log(l),n({icon:"error",title:"Error!"})})})}function u(){t.value.isActiveModal=!t.value.isActiveModal}function L(e,a){axios.get(route("api.statistics.costs.edit",e)).then(({data:l})=>{t.value.item=l.result,t.value.modalAction="edit",t.value.item.index=a,u()}).catch(l=>console.log(l))}function $(){axios.put(route("api.statistics.costs.update",t.value.item.id),t.value.item).then(()=>{u(),s(),n({title:"Success!",icon:"success"})}).catch(e=>{console.log(e),n({title:"Error!",icon:"error"})})}function E(){axios.post(route("api.statistics.costs.create"),t.value.item).then(()=>{u(),t.value.item=f,s(),n({title:"Success!",icon:"success"})}).catch(e=>{console.log(e),n({title:"Error!",icon:"error"})})}function B(){t.value.modalAction==="edit"?$():t.value.modalAction==="create"&&E()}function F(){Object.assign(t.value.item,f),t.value.modalAction="create",u()}return(e,a)=>{const l=d("loader-component"),O=d("button-component"),y=d("label-component"),S=d("select-component"),N=d("card-component"),U=d("pagination");return c(),p(T,{title:"\u0412\u0438\u0442\u0440\u0430\u0442\u0438"},{header:g(()=>[X]),default:g(()=>[t.value.isLoading?(c(),p(l,{key:0})):_("",!0),!t.value.isLoading&&b(w)("show-bookkeeping-costs")?(c(),C("div",Y,[m("div",null,[r(O,{type:"btn",onClick:F},{default:g(()=>[Z]),_:1})]),m("div",tt,[m("div",et,[r(y,{value:"\u0424\u0456\u043B\u044C\u0442\u0440 \u043F\u043E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0456\u0457"}),r(S,{modelValue:o.value.filter,"onUpdate:modelValue":a[0]||(a[0]=i=>o.value.filter=i),options:h.value,onChange:s},null,8,["modelValue","options"])]),m("div",ot,[r(y,{value:"\u0424\u0456\u043B\u044C\u0442\u0440 \u043F\u043E \u0434\u0430\u0442\u0456"}),r(z,{modelValue:o.value.date,"onUpdate:modelValue":[a[1]||(a[1]=i=>o.value.date=i),s]},null,8,["modelValue"])])]),t.value.chart?(c(),p(I,{key:0,"chart-data":t.value.chart},null,8,["chart-data"])):_("",!0),m("div",at,[(c(!0),C(Q,null,R(t.value.data.generalStat,(i,j)=>(c(),p(N,{class:"text-center",title:j,description:e.$filters.formatMoney(i)},null,8,["title","description"]))),256))]),r(P,{data:t.value.data.result.data,onOnDestroy:k,onOnEdit:L},null,8,["data"]),m("div",nt,[r(U,{pagination:t.value.data.result,"click-handler":s,modelValue:o.value.page,"onUpdate:modelValue":a[2]||(a[2]=i=>o.value.page=i)},null,8,["pagination","modelValue"])]),(c(),p(W(b(D)),{item:t.value.item,modalAction:t.value.modalAction,onCloseModal:u,onSubmitForm:B,onDeclineForm:k},null,40,["item","modalAction"]))])):_("",!0)]),_:1})}}};export{kt as default};
