import j from"./Modal.5d2b1a8e.js";import P from"./Chart.56133c85.js";import q from"./Table.b1787576.js";import z from"./StatisticLayout.04a55807.js";import{s as I,e as K,_ as T}from"./Datepicker.a2add9fb.js";import{ay as X,y as v,z as k,C as Y,a0 as m,X as _,B as x,V as r,S as i,_ as g,P as b,L as A,M as u,K as c,F as Z,Z as G,bh as H,Y as C}from"./___vite-browser-external_commonjs-proxy.4500e77d.js";import"./Form.7940e511.js";import"./index.24f8f0f7.js";import"./app.904dadda.js";const J=C(" \u0412\u0438\u0442\u0440\u0430\u0442\u0438 "),Q={key:1,class:"grid grid-cols-1 gap-4"},R=C(" \u0414\u043E\u0434\u0430\u0442\u0438 "),W={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-5"},ee={class:"block"},te={class:"block"},oe={class:"grid grid-cols-2 md:grid-cols-6"},ae={class:"text-center"},ve={__name:"Index",setup(ne){const n=x("$swal"),M=x("$can"),f=X({name:null,date:null,sum:null,quantity:1,comment:null,total:null,cost_category_id:null,cost_type:"single"}),e=v({data:[],chart:[],isLoading:!0,isActiveModal:!1,modalAction:"",item:{}}),o=v({date:[],page:1}),h=v([]),y=k(()=>{const t={};return o.value.filter&&(t.filter=o.value.filter),o.value.date.length===2&&(t.date_start=o.value.date[0].toLocaleDateString(),t.date_end=o.value.date[1].toLocaleDateString()),t.page=o.value.page,t});Y(()=>{o.value.date[0]=I(new Date),o.value.date[1]=K(new Date),s(),axios.get(route("api.statistics.costs.categories.list")).then(({data:t})=>{t.result.forEach(a=>{h.value.push({value:a.title,key:a.id})})}).catch(t=>console.log(t))});const L=k(()=>e.value.isActiveModal?j:null);function s(){e.value.isLoading=!0,axios.get(route("api.statistics.costs.index",y.value)).then(({data:t})=>{e.value.data=t,e.value.isLoading=!1}).catch(t=>{console.log(t),e.value.isLoading=!1}),axios.get(route("api.statistics.costs.chart",y.value)).then(({data:t})=>e.value.chart=t.result).catch(t=>console.log(t))}function w(t){n({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(a=>{a.isConfirmed&&axios.delete(route("api.statistics.costs.destroy",t)).then(()=>{s(),e.value.isActiveModal&&d(),n({icon:"success",title:"Destroyed!"})}).catch(p=>{console.log(p),n({icon:"error",title:"Error!"})})})}function d(){e.value.isActiveModal=!e.value.isActiveModal}function D(){axios.put(route("api.statistics.costs.update",e.value.item.id),e.value.item).then(()=>{d(),s(),n({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),n({title:"Error!",icon:"error"})})}function $(){axios.post(route("api.statistics.costs.create"),e.value.item).then(()=>{d(),e.value.item=f,s(),n({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),n({title:"Error!",icon:"error"})})}function S(){e.value.modalAction==="edit"?D():e.value.modalAction==="create"&&$()}function B(){Object.assign(e.value.item,f),e.value.modalAction="create",d()}return(t,a)=>{const p=r("loader-component"),F=r("button-component"),V=r("label-component"),E=r("select-component"),N=r("card-component"),O=r("pagination");return i(),m(z,{title:"\u0412\u0438\u0442\u0440\u0430\u0442\u0438"},{header:_(()=>[J]),default:_(()=>[e.value.isLoading?(i(),m(p,{key:0})):g("",!0),!e.value.isLoading&&b(M)("show-bookkeeping-costs")?(i(),A("div",Q,[u("div",null,[c(F,{type:"btn",onClick:B},{default:_(()=>[R]),_:1})]),u("div",W,[u("div",ee,[c(V,{value:"\u0424\u0456\u043B\u044C\u0442\u0440 \u043F\u043E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0456\u0457"}),c(E,{modelValue:o.value.filter,"onUpdate:modelValue":a[0]||(a[0]=l=>o.value.filter=l),options:h.value,onChange:s},null,8,["modelValue","options"])]),u("div",te,[c(V,{value:"\u0424\u0456\u043B\u044C\u0442\u0440 \u043F\u043E \u0434\u0430\u0442\u0456"}),c(T,{modelValue:o.value.date,"onUpdate:modelValue":[a[1]||(a[1]=l=>o.value.date=l),s]},null,8,["modelValue"])])]),e.value.chart?(i(),m(P,{key:0,"chart-data":e.value.chart},null,8,["chart-data"])):g("",!0),u("div",oe,[(i(!0),A(Z,null,G(e.value.data.generalStat,(l,U)=>(i(),m(N,{class:"text-center",title:U,description:t.$filters.formatMoney(l)},null,8,["title","description"]))),256))]),c(q,{data:e.value.data.result.data},null,8,["data"]),u("div",ae,[c(O,{pagination:e.value.data.result,"click-handler":s,modelValue:o.value.page,"onUpdate:modelValue":a[2]||(a[2]=l=>o.value.page=l)},null,8,["pagination","modelValue"])]),(i(),m(H(b(L)),{item:e.value.item,modalAction:e.value.modalAction,onCloseModal:d,onSubmitForm:S,onDeclineForm:w},null,40,["item","modalAction"]))])):g("",!0)]),_:1})}}};export{ve as default};
