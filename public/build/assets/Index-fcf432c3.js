import{s as i}from"./swal-01ed9a07.js";import{_ as V}from"./Paginate-b71b7269.js";import{L as $}from"./Loader-8bf33617.js";import{_ as w,S as E}from"./SidebarItem-eda03439.js";import F from"./Modal-9bf4d178.js";import j from"./Table-5bd096bb.js";import N from"./CrmLayout-ec648700.js";import{i as O,G as U,r as g,j as b,o as q,p as n,D as d,x as m,A as y,C as k,t as v,q as x,v as p,l as h,F as G,K as I,B as J,J as K}from"./app-f55448cf.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Modal-381c1367.js";import"./Form-5caefac6.js";import"./Select-35904355.js";import"./Label-fa7af1d1.js";import"./Input-4fdb1b47.js";import"./Textarea-faf312b0.js";import"./Table-6800669f.js";import"./XCircle-78b15e67.js";import"./AuthenticatedLayout-ecf8db9d.js";import"./index.esm-f21e1dfa.js";import"./Logo-edac3a30.js";import"./vue-i18n.esm-bundler-d070be13.js";const T={key:1},z={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},H={class:"md:col-span-1"},Q={class:"w-full md:col-span-4 grid gap-4 grid-cols-1"},R={class:"text-center"},he={__name:"Index",props:["statuses"],setup(f){const A=f,o=O("$can");U({name:null,phone:null,comment:null,status:null});const e=g({data:[],isLoading:!0,isActiveModal:!1,modalAction:"",item:{},sidebarActive:"all"}),u=g([]),l=g({status:null,currentPage:1}),C=b(()=>{const t={};return t.page=l.value.currentPage,l.value.status&&(t.status=l.value.status),t});q(()=>{c(1),u.value.push({title:"Всі",key:"all"});for(const[t,a]of Object.entries(A.statuses))u.value.push({title:a,key:t})});const L=b(()=>e.value.isActiveModal?F:null);function M(t){e.value.sidebarActive=t,t==="all"?l.value.status=null:l.value.status=t,l.value.currentPage=1,c()}function c(t){e.value.isLoading=!0,t&&(e.value.currentPage=t),axios.get(route("api.callbacks.index",C.value)).then(a=>{Object.assign(e.value.data,a.data.result),e.value.isLoading=!1}).catch(a=>{console.log(a),e.value.isLoading=!1})}function _(t){o("destroy-callbacks")&&i({title:"Видалити?",icon:"warning",showCancelButton:!0}).then(a=>{a.isConfirmed&&axios.delete(route("api.callbacks.destroy",t)).then(()=>{c(),e.value.isActiveModal&&r(),i({icon:"success",title:"Destroyed!"})}).catch(s=>{console.log(s),i({icon:"error",title:"Error!"})})})}function r(){e.value.isActiveModal=!e.value.isActiveModal}function B(t,a){o("edit-callbacks")&&axios.get(route("api.callbacks.edit",t)).then(({data:s})=>{e.value.item=s.result,e.value.modalAction="edit",e.value.item.index=a,r()}).catch(s=>console.log(s))}function D(){o("edit-callbacks")&&axios.put(route("api.callbacks.update",e.value.item.id),e.value.item).then(()=>{r(),c(),i({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),i({title:"Error!",icon:"error"})})}function P(){o("create-callbacks")&&axios.post(route("api.callbacks.create"),e.value.item).then(({data:t})=>{r(),e.value.item={},c(),i({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),i({title:"Error!",icon:"error"})})}function S(){e.value.modalAction==="edit"&&o("edit-callbacks")?D():e.value.modalAction==="create"&&o("create-callbacks")&&P()}return(t,a)=>(n(),d(N,{title:"Зворотній звʼязок"},{header:m(()=>[y(" Зворотній звʼязок ")]),default:m(()=>[e.value.isLoading?(n(),d($,{key:0})):k("",!0),!e.value.isLoading&&v(o)("show-callbacks")?(n(),x("div",T,[p("div",z,[p("div",H,[h(E,null,{default:m(()=>[u.value.length?(n(!0),x(G,{key:0},I(u.value,s=>(n(),d(w,{onClick:W=>M(s.key),active:e.value.sidebarActive===s.key},{default:m(()=>[y(J(s.title),1)]),_:2},1032,["onClick","active"]))),256)):k("",!0)]),_:1})]),p("div",Q,[h(j,{data:e.value.data.data,statuses:f.statuses,onOnEdit:B,onOnDestroy:_,"can-destroy":v(o)("destroy-callbacks")},null,8,["data","statuses","can-destroy"]),p("div",R,[h(V,{pagination:e.value.data,"click-handler":c,modelValue:l.value.currentPage,"onUpdate:modelValue":a[0]||(a[0]=s=>l.value.currentPage=s)},null,8,["pagination","modelValue"])])])]),(n(),d(K(v(L)),{item:e.value.item,onCloseModal:r,onSubmitForm:S,onDeclineForm:_,statuses:f.statuses,"can-destroy":v(o)("destroy-callbacks")},null,40,["item","statuses","can-destroy"]))])):k("",!0)]),_:1}))}};export{he as default};
