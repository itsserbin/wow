import{az as $,y as Y,C as q,z as S,L as V,M as l,K as s,X as I,_ as h,ac as O,a0 as c,bg as j,P as M,O as U,Y as g,B as E,V as k,S as r}from"./___vite-browser-external_commonjs-proxy.f18235ae.js";import G from"./ItemsModal.fddb9cee.js";import H from"./ItemsTable.20f7a276.js";import J from"./ClientOrders.f70d97ed.js";import Q from"./Table.3b6b27d0.js";import Z from"./Modal.6de2bc9d.js";import"./ItemsForm.f2dfd632.js";import"./Form.a91698b7.js";const _={class:"grid gap-4"},ee={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},oe={class:"block"},te={class:"block"},le={class:"block"},se={class:"block"},de=g(" \u041A\u0430\u0440\u0442\u043A\u0430 \u043A\u043B\u0456\u0454\u043D\u0442\u0430 "),ne={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ie={class:"block"},ae={class:"block"},re={key:0,class:"block"},ue=l("hr",null,null,-1),me={class:"grid grid-cols-1 md:grid-cols-4 mb-5"},ce={class:"block mb-5 md:mr-5"},ve={class:"block mb-5 md:mr-5"},ye={class:"block mb-5 md:mr-5"},be={class:"block mb-5"},fe={class:"grid grid-cols-1 md:grid-cols-2 mb-10"},Ve={class:"block md:mr-5"},he={class:"block mb-5"},ke={class:"block mb-5"},ge={class:"block"},xe={key:0},we={key:1},pe=g(" \u0422\u0422\u041D \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 ("),Ie=g(") "),Me={class:"block"},Ue={class:"mb-7"},Ce={class:"grid grid-cols-2"},Fe={class:"block mb-5 mr-5"},$e={class:"block mb-5"},Se={class:"grid grid-cols-2"},Oe={class:"block mb-5 mr-5"},je={class:"block mb-5"},Ee={key:2},Ae={class:"grid grid-cols-2"},Be={class:"block mb-5 mr-5"},De={class:"block mb-5"},ze={class:"block mb-5"},Ne=g("\u0414\u043E\u0434\u0430\u0442\u0438 \u0442\u043E\u0432\u0430\u0440"),Te={class:"grid grid-cols-1 md:grid-cols-3 mt-5"},Le={class:"flex justify-center"},Pe=l("p",{class:"font-semibold text-l text-gray-900 dark:text-white"}," \u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u0442\u043E\u0432\u0430\u0440\u0456\u0432:\xA0 ",-1),Ke={class:"text-l text-gray-900 dark:text-white"},Re={class:"flex justify-center"},We=l("p",{class:"font-semibold text-l text-gray-900 dark:text-white"}," \u0417\u0430\u0433\u0430\u043B\u044C\u043D\u0430 \u0446\u0456\u043D\u0430:\xA0 ",-1),Xe={class:"text-l text-gray-900 dark:text-white"},Ye={class:"flex justify-center"},qe=l("p",{class:"font-semibold text-l text-gray-900 dark:text-white"}," \u041F\u0440\u043E\u043C\u043E-\u043A\u043E\u0434:\xA0 ",-1),Ge={class:"text-l text-gray-900 dark:text-white"},He={class:"block"},Je=g("\u0414\u043E\u0434\u0430\u0442\u0438 \u0440\u0430\u0445\u0443\u043D\u043E\u043A"),no={__name:"Form",props:["order","statuses","paymentMethods","invoiceStatuses"],emits:["submitItemForm","onEditClient"],setup(e,{emit:y}){const u=e,m=E("$swal"),w=E("$can"),C=$({order_id:u.order.id,sum:null}),n=Y({showItemsModal:!1,showInvoicesModal:!1,itemsModalAction:"",item:{count:1,size:"",color:"",product_id:null},invoiceItem:{},statuses:[],managers:[],paymentMethods:[]});q(()=>{P();for(const[d,o]of Object.entries(u.statuses))n.value.statuses.push({key:d,value:o});for(const[d,o]of Object.entries(u.paymentMethods))n.value.paymentMethods.push({key:d,value:o})});const A=S(()=>n.value.showItemsModal?G:null),B=S(()=>n.value.showInvoicesModal?Z:null),b=$([{key:0,value:"\u041D\u0456"},{key:1,value:"\u0422\u0430\u043A"}]);function x(){n.value.showInvoicesModal=!n.value.showInvoicesModal}function D(d){w("destroy-invoices")&&m({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(o=>{o.isConfirmed&&axios.delete(route("api.invoices.destroy",d)).then(()=>{y("submitItemForm"),m({icon:"success",title:"Destroyed!"})}).catch(i=>{console.log(i),m({icon:"error",title:"Error!"})})})}function z(){w("create-invoices")&&(n.value.invoiceItem=C,x())}function N(){axios.post(route("api.invoices.create"),n.value.invoiceItem).then(({data:d})=>{n.value.invoiceItem=C,x(),navigator.clipboard.writeText(d.result.data.invoice_url),m({title:"\u0423\u0441\u043F\u0456\u0448\u043D\u043E!",text:"\u0420\u0430\u0445\u0443\u043D\u043E\u043A \u0431\u0443\u0432 \u0443\u0441\u043F\u0456\u0448\u043D\u043E \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u0438\u0439, \u043F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F \u043D\u0430 \u043E\u043F\u043B\u0430\u0442\u0443 \u0441\u043A\u043E\u043F\u0456\u0439\u043E\u0432\u0430\u043D\u043E \u0432 \u0431\u0443\u0444\u0435\u0440 \u043E\u0431\u043C\u0456\u043D\u0443",icon:"success"}),y("submitItemForm",d.result)}).catch(d=>{console.log(d),m({title:"Error!",icon:"error"})})}function F(){u.order.waybill&&axios.post(route("notify.waybill"),{phone:u.order.client.phone,waybill:u.order.waybill,order_id:u.order.id}).then(({data:d})=>{d.success===!0?m({icon:"success",title:"\u041D\u043E\u043C\u0435\u0440 \u043D\u0430\u043A\u043B\u0430\u0434\u043D\u043E\u0439 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D \u043A\u043B\u0438\u0435\u043D\u0442\u0443",text:d.info}):m({icon:"error",title:"\u041E\u0448\u0438\u0431\u043A\u0430",text:d.info}),axios.put(route("api.orders.update",u.order.id),u.order)}).catch(d=>{m({icon:"error",title:"\u041E\u0448\u0438\u0431\u043A\u0430",text:"\u041E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u043A \u0430\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\u0443"}),console.log(d)})}function T(){n.value.itemsModalAction==="create"?axios.post(route("api.order-items.add",u.order.id),n.value.item).then(({data:d})=>{f(),y("submitItemForm",d.result)}).catch(d=>console.log(d)):n.value.itemsModalAction==="edit"&&axios.put(route("api.order-items.update",n.value.item.id),n.value.item).then(({data:d})=>{f(),y("submitItemForm",d.result)}).catch(d=>console.log(d))}function L(){f(),n.value.itemsModalAction="create"}function f(){n.value.showItemsModal=!n.value.showItemsModal}function P(){axios.get(route("api.users.list.managers")).then(({data:d})=>{d.result.length&&d.result.forEach(o=>{n.value.managers.push({key:o.id,value:o.name})})}).catch(d=>console.log(d))}function K(d,o){m({title:"Are you sure?",icon:"warning",showCancelButton:!0}).then(i=>{i.isConfirmed&&axios.delete(route("api.order-items.destroy",{item_id:d,order_id:u.order.id})).then(()=>{u.order.items.splice(o,1),m({title:"Success",icon:"success"})}).catch(a=>{console.log(a),m({title:"Error",icon:"error"})})})}function R(d){f(),n.value.itemsModalAction="edit",axios.get(route("api.order-items.edit",d)).then(({data:o})=>n.value.item=o.result).catch(o=>console.log(o))}function W(){m({title:"\u0423\u0441\u043F\u0456\u0448\u043D\u043E",text:"\u041F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F \u043D\u0430 \u043E\u043F\u043B\u0430\u0442\u0443 \u043D\u0430\u0434\u0456\u0441\u043B\u0430\u043D\u043E \u043A\u043B\u0456\u0454\u043D\u0442\u0443",icon:"success"}),y("submitItemForm")}return(d,o)=>{const i=k("label-component"),a=k("input-component"),p=k("button-component"),v=k("select-component"),X=k("textarea-component");return r(),V("form",_,[l("div",ee,[l("div",oe,[s(i,{value:"\u0406\u043C\u02BC\u044F"}),s(a,{modelValue:e.order.client.name,"onUpdate:modelValue":o[0]||(o[0]=t=>e.order.client.name=t),type:"text",disabled:""},null,8,["modelValue"])]),l("div",te,[s(i,{value:"\u041F\u0440\u0456\u0437\u0432\u0438\u0449\u0435"}),s(a,{modelValue:e.order.client.last_name,"onUpdate:modelValue":o[1]||(o[1]=t=>e.order.client.last_name=t),type:"text",disabled:""},null,8,["modelValue"])]),l("div",le,[s(i,{value:"\u041F\u043E-\u0431\u0430\u0442\u044C\u043A\u043E\u0432\u0456"}),s(a,{modelValue:e.order.client.middle_name,"onUpdate:modelValue":o[2]||(o[2]=t=>e.order.client.middle_name=t),type:"text",disabled:""},null,8,["modelValue"])]),l("div",se,[s(i,{value:"\xA0"}),s(p,{class:"w-full",type:"button",onClick:o[3]||(o[3]=t=>d.$emit("onEditClient"))},{default:I(()=>[de]),_:1})])]),l("div",ne,[l("div",ie,[s(i,{value:"\u0421\u0442\u0430\u0442\u0443\u0441 \u043A\u043B\u0456\u0454\u043D\u0442\u0430"}),s(a,{modelValue:e.order.client.status,"onUpdate:modelValue":o[4]||(o[4]=t=>e.order.client.status=t),type:"text",disabled:""},null,8,["modelValue"])]),l("div",ae,[s(i,{value:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D"}),s(a,{modelValue:e.order.client.phone,"onUpdate:modelValue":o[5]||(o[5]=t=>e.order.client.phone=t),type:"text",disabled:""},null,8,["modelValue"])])]),e.order.client.orders.length>1?(r(),V("div",re,[s(J,{data:e.order.client.orders,statuses:e.statuses},null,8,["data","statuses"])])):h("",!0),ue,l("div",me,[l("div",ce,[s(i,{value:"\u0421\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F"}),s(v,{modelValue:e.order.status,"onUpdate:modelValue":o[6]||(o[6]=t=>e.order.status=t),options:n.value.statuses},null,8,["modelValue","options"])]),l("div",ve,[s(i,{value:"\u041C\u0435\u043D\u0435\u0434\u0436\u0435\u0440"}),s(v,{modelValue:e.order.manager_id,"onUpdate:modelValue":o[7]||(o[7]=t=>e.order.manager_id=t),options:n.value.managers},null,8,["modelValue","options"])]),l("div",ye,[s(i,{value:"\u0421\u043F\u043E\u0441\u0456\u0431 \u043E\u043F\u043B\u0430\u0442\u0438"}),s(v,{modelValue:e.order.payment_method,"onUpdate:modelValue":o[8]||(o[8]=t=>e.order.payment_method=t),options:n.value.paymentMethods},null,8,["modelValue","options"])]),l("div",be,[s(i,{value:"\u041D\u0430\u0433\u0430\u0434\u0443\u0432\u0430\u043D\u043D\u044F \u043F\u0440\u043E \u043F\u043E\u0441\u0438\u043B\u043A\u0443"}),s(v,{modelValue:e.order.parcel_reminder,"onUpdate:modelValue":o[9]||(o[9]=t=>e.order.parcel_reminder=t),options:b},null,8,["modelValue","options"])])]),l("div",fe,[l("div",Ve,[l("div",he,[s(i,{value:"\u041C\u0456\u0441\u0442\u043E"}),s(a,{modelValue:e.order.city,"onUpdate:modelValue":o[10]||(o[10]=t=>e.order.city=t),type:"text"},null,8,["modelValue"])]),l("div",ke,[s(i,{value:"\u041F\u043E\u0447\u0442\u043E\u0432\u0435 \u0432\u0456\u0434\u0434\u0456\u043B\u0435\u043D\u043D\u044F"}),s(a,{modelValue:e.order.postal_office,"onUpdate:modelValue":o[11]||(o[11]=t=>e.order.postal_office=t),type:"text"},null,8,["modelValue"])]),l("div",ge,[s(i,{value:"\u041D\u043E\u043C\u0435\u0440 \u043D\u0430\u043A\u043B\u0430\u0434\u043D\u043E\u0457"}),s(a,{modelValue:e.order.waybill,"onUpdate:modelValue":o[12]||(o[12]=t=>e.order.waybill=t),type:"text"},null,8,["modelValue"]),!e.order.sms_waybill_status&&e.order.waybill?(r(),V("div",xe,[l("a",{href:"javascript:",onClick:o[13]||(o[13]=O(t=>F(e.order.client.phone,e.order.waybill),["prevent"]))},"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u0422\u0422\u041D \u043A\u043B\u0438\u0435\u043D\u0442\u0443")])):h("",!0),e.order.sms_waybill_status?(r(),V("div",we,[pe,l("a",{href:"javascript:",onClick:o[14]||(o[14]=O(t=>F(e.order.client.phone,e.order.waybill),["prevent"]))},"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E"),Ie])):h("",!0)])]),l("div",Me,[s(i,{value:"\u041A\u043E\u043C\u0435\u043D\u0442\u0430\u0440"}),s(X,{rows:"10",modelValue:e.order.comment,"onUpdate:modelValue":o[15]||(o[15]=t=>e.order.comment=t)},null,8,["modelValue"])])]),l("div",Ue,[l("div",Ce,[l("div",Fe,[s(i,{value:"\u0414\u043E\u0434.\u043F\u0440\u043E\u0434\u0430\u0436 \u043F\u043E\u0432\u0456\u0442\u0440\u044F"}),s(v,{modelValue:e.order.sale_of_air,"onUpdate:modelValue":o[16]||(o[16]=t=>e.order.sale_of_air=t),options:b},null,8,["modelValue","options"])]),l("div",$e,[s(i,{value:"\u0421\u0443\u043C\u0430 \u0434\u043E\u043F.\u043F\u0440\u043E\u0434\u0430\u0436\u0443 \u043F\u043E\u0432\u0456\u0442\u0440\u044F (\u0433\u0440\u043D.)"}),e.order.sale_of_air?(r(),c(a,{key:0,modelValue:e.order.sale_of_air_price,"onUpdate:modelValue":o[17]||(o[17]=t=>e.order.sale_of_air_price=t),type:"number"},null,8,["modelValue"])):(r(),c(a,{key:1,modelValue:e.order.sale_of_air_price,"onUpdate:modelValue":o[18]||(o[18]=t=>e.order.sale_of_air_price=t),type:"number",disabled:""},null,8,["modelValue"]))])]),l("div",Se,[l("div",Oe,[s(i,{value:"\u041F\u0435\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0430"}),e.order.wfp_payment?(r(),c(v,{key:1,modelValue:e.order.prepayment,"onUpdate:modelValue":o[20]||(o[20]=t=>e.order.prepayment=t),options:b,disabled:""},null,8,["modelValue","options"])):(r(),c(v,{key:0,modelValue:e.order.prepayment,"onUpdate:modelValue":o[19]||(o[19]=t=>e.order.prepayment=t),options:b},null,8,["modelValue","options"]))]),l("div",je,[s(i,{value:"\u0421\u0443\u043C\u0430 \u043F\u0435\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0438 (\u0433\u0440\u043D.)"}),e.order.prepayment&&!e.order.wfp_payment?(r(),c(a,{key:0,modelValue:e.order.prepayment_sum,"onUpdate:modelValue":o[21]||(o[21]=t=>e.order.prepayment_sum=t),type:"number"},null,8,["modelValue"])):(r(),c(a,{key:1,modelValue:e.order.prepayment_sum,"onUpdate:modelValue":o[22]||(o[22]=t=>e.order.prepayment_sum=t),type:"number",disabled:""},null,8,["modelValue"])),e.order.wfp_payment?(r(),V("span",Ee,"\u041E\u043F\u043B\u0430\u0447\u0435\u043D\u043E \u043D\u0430 \u0441\u0430\u0439\u0442\u0456")):h("",!0)])]),l("div",Ae,[l("div",Be,[s(i,{value:"\u0417\u043D\u0438\u0436\u043A\u0430"}),s(v,{modelValue:e.order.discount,"onUpdate:modelValue":o[23]||(o[23]=t=>e.order.discount=t),options:b},null,8,["modelValue","options"])]),l("div",De,[s(i,{value:"\u0421\u0443\u043C\u0430 \u0437\u043D\u0438\u0436\u043A\u0438 (\u0433\u0440\u043D.)"}),e.order.discount?(r(),c(a,{key:0,modelValue:e.order.discount_sum,"onUpdate:modelValue":o[24]||(o[24]=t=>e.order.discount_sum=t),type:"number"},null,8,["modelValue"])):(r(),c(a,{key:1,modelValue:e.order.discount_sum,"onUpdate:modelValue":o[25]||(o[25]=t=>e.order.discount_sum=t),type:"number",disabled:""},null,8,["modelValue"]))])])]),l("div",ze,[s(p,{type:"button",onClick:L},{default:I(()=>[Ne]),_:1}),(r(),c(j(M(A)),{item:n.value.item,size:"medium",onCloseModal:f,onSubmitItemForm:T},null,40,["item"]))]),s(H,{data:e.order.items,onEditOrderItem:R,onDestroyOrderItem:K},null,8,["data"]),l("div",Te,[l("div",Le,[Pe,l("p",Ke,U(e.order.total_count),1)]),l("div",Re,[We,l("p",Xe,U(d.$filters.formatMoney(e.order.total_price)),1)]),l("div",Ye,[qe,l("p",Ge,U(e.order.promo_code?e.order.promo_code:"\u0412\u0456\u0434\u0441\u0443\u0442\u043D\u0456\u0439"),1)])]),l("div",He,[s(p,{type:"button",onClick:z,class:"my-4"},{default:I(()=>[Je]),_:1}),e.order.invoices.length?(r(),c(Q,{key:0,data:e.order.invoices,statuses:e.invoiceStatuses,"can-destroy":M(w)("destroy-invoices"),onOnDestroy:D,onOnSendInvoiceSms:W},null,8,["data","statuses","can-destroy"])):h("",!0),(r(),c(j(M(B)),{item:n.value.invoiceItem,onCloseModal:x,onSubmitForm:N,onDeclineForm:x},null,40,["item"]))])])}}};export{no as default};
