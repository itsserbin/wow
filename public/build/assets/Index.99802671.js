import O from"./Modal.6765bd86.js";import U from"./OptionsLayout.46107609.js";import{u as L,z as T,D as z,A as J,U as f,R as l,Q as g,W as k,K,O as C,J as _,L as b,M as m,Y as r,bb as Q,v as w,V as d}from"./_plugin-vue_export-helper.80033396.js";import"./Form.6f6da4d0.js";import"./UploadBannersInput.555b9488.js";import"./Sidebar.3b7eddfa.js";import"./app.3d1b1164.js";const R=r(" \u0411\u0430\u043D\u0435\u0440\u0430 "),W={key:1},Y=r(" \u0414\u043E\u0434\u0430\u0442\u0438 "),q=["onClick"],G=["src","alt"],H=b("hr",{class:"my-1"},null,-1),X=["onClick"],ue={__name:"Index",setup(Z){const s=w("$swal"),u=w("$can"),h=L({title:{ua:null,ru:null},image_mobile:{ua:null,ru:null},image_table:{ua:null,ru:null},image_desktop:{ua:null,ru:null},link:{ua:null,ru:null},published:0}),x=w("$defaultLang"),e=T({data:[],currentPage:1,isLoading:!0,isActiveModal:!1,modalAction:"",item:h,activeLang:x});z(()=>{p(1)});const A=J(()=>e.value.isActiveModal?O:null),M=L([{label:"ID",key:"id"},{label:"\u0424\u043E\u0442\u043E",key:"image"},{label:"\u041D\u0430\u0437\u0432\u0430",key:"title"},{label:"\u0421\u0442\u0430\u0442\u0443\u0441",key:"published"},{label:"\u041F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F",key:"link"},{label:"\u041E\u043D\u043E\u0432\u043B\u0435\u043D\u043E<hr class='my-1'>\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043E",key:"timestamps"},{label:"#",key:"actions"}]);function $(a){e.value.activeLang=a}function p(a){e.value.isLoading=!0,a&&(e.value.currentPage=a),axios.get(route("api.banners.index",{page:e.value.currentPage})).then(n=>{Object.assign(e.value.data,n.data.result),e.value.isLoading=!1}).catch(n=>{console.log(n),e.value.isLoading=!1})}function y(a){u("destroy-banners")&&s({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(n=>{n.isConfirmed&&axios.delete(route("api.banners.destroy",a)).then(()=>{p(),e.value.isActiveModal&&c(),s({icon:"success",title:"Destroyed!"})}).catch(o=>{console.log(o),s({icon:"error",title:"Error!"})})})}function c(){e.value.isActiveModal=!e.value.isActiveModal}function D(a,n){u("edit-banners")&&axios.get(route("api.banners.edit",a)).then(({data:o})=>{e.value.item=o.result,e.value.modalAction="edit",e.value.item.index=n,c()}).catch(o=>console.log(o))}function V(){u("edit-banners")&&axios.put(route("api.banners.update",e.value.item.id),e.value.item).then(()=>{c(),p(),s({title:"Success!",icon:"success"})}).catch(a=>{console.log(a),s({title:"Error!",icon:"error"})})}function F(){u("create-banners")&&axios.post(route("api.banners.create"),e.value.item).then(()=>{c(),e.value.item=h,p(),s({title:"Success!",icon:"success"})}).catch(a=>{console.log(a),s({title:"Error!",icon:"error"})})}function S(){e.value.modalAction==="edit"&&u("edit-banners")?V():e.value.modalAction==="create"&&u("create-banners")&&F()}function j(){u("create-banners")&&(Object.assign(e.value.item,h),e.value.modalAction="create",c())}function B(a,n,o){let v=new FormData;v.append("type",n),v.append("banner",a),axios.post(route("api.banners.upload"),v,{headers:{"Content-Type":"multipart/form-data"}}).then(({data:i})=>{n==="mobile"&&(o==="ru"&&(e.value.item.image_mobile.ru=i.result),o==="ua"&&(e.value.item.image_mobile.ua=i.result)),n==="table"&&(o==="ru"&&(e.value.item.image_table.ru=i.result),o==="ua"&&(e.value.item.image_table.ua=i.result)),n==="desktop"&&(o==="ru"&&(e.value.item.image_desktop.ru=i.result),o==="ua"&&(e.value.item.image_desktop.ua=i.result))}).catch(i=>console.log(i))}return(a,n)=>{const o=d("loader-component"),v=d("button-component"),i=d("lang-tabs"),E=d("xcircle-component"),P=d("table-component"),I=d("paginate");return g(),f(U,{title:"\u0411\u0430\u043D\u0435\u0440\u0430"},{header:l(()=>[R]),default:l(()=>[e.value.isLoading?(g(),f(o,{key:0})):k("",!0),e.value.isLoading?k("",!0):(g(),K("div",W,[C(u)("create-banners")?(g(),f(v,{key:0,type:"btn",onClick:j},{default:l(()=>[Y]),_:1})):k("",!0),_(i,{onClickLang:$}),_(P,{headings:M,isSlotMode:!0,rows:e.value.data.data},{id:l(({data:t})=>[b("a",{href:"javascript:",onClick:N=>D(t.row.id,t.i)},m(t.row.id),9,q)]),image:l(({data:t})=>[b("img",{src:e.value.activeLang==="ua"?t.row.image_mobile.ua:e.value.activeLang==="ru"?t.row.image_mobile.ru:null,alt:e.value.activeLang==="ua"?t.row.title.ua:e.value.activeLang==="ru"?t.row.title.ru:null,class:"w-1/4 mx-auto"},null,8,G)]),title:l(({data:t})=>[r(m(e.value.activeLang==="ua"?t.row.title.ua:e.value.activeLang==="ru"?t.row.title.ru:null),1)]),published:l(({data:t})=>[r(m(a.$filters.publishedStatus(t.row.published)),1)]),link:l(({data:t})=>[r(m(e.value.activeLang==="ua"?t.row.link.ua:e.value.activeLang==="ru"?t.row.link.ru:null),1)]),timestamps:l(({data:t})=>[r(m(a.$filters.dateFormat(t.row.updated_at))+" ",1),H,r(" "+m(a.$filters.dateFormat(t.row.created_at)),1)]),actions:l(({data:t})=>[b("a",{href:"javascript:",onClick:N=>y(t.row.id)},[_(E)],8,X)]),_:1},8,["headings","rows"]),_(I,{pagination:e.value.data,"click-handler":p,modelValue:e.value.currentPage,"onUpdate:modelValue":n[0]||(n[0]=t=>e.value.currentPage=t)},null,8,["pagination","modelValue"]),(g(),f(Q(C(A)),{item:e.value.item,onCloseModal:c,onSubmitForm:S,onDeclineForm:y,onOnUploadImage:B},null,40,["item"]))]))]),_:1})}}};export{ue as default};
