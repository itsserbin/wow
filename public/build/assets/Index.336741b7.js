import M from"./Chart.030e8cdc.js";import C from"./StatisticLayout.ee69e03f.js";import D from"./LastParams.6786c2ed.js";import{y as _,z as N,G as F,ax as U,W as c,U as u,S as l,a0 as d,P as O,L as v,M as m,K as s,F as T,V as j,Z as p,O as f,D as h,Y as n}from"./moment.325cf309.js";import"./index.caa0c941.js";import"./app.6a44ab02.js";const z=p(" \u041C\u0430\u0440\u043A\u0435\u0442\u0438\u043D\u0433\u043E\u0432\u0430 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430 "),A={key:1},E={class:"grid grid-cols-1 gap-4 mt-5"},G={class:"block"},I={class:"grid grid-cols-2 md:grid-cols-4"},J={__name:"Index",setup(K){h("$swal");const k=h("$can"),t=_({data:[],chart:null,isLoading:!0}),a=_({date:[],filter:null,last:"one-month",currentPage:1}),g=N(()=>{const e={};return a.value.date.length===2&&(e.date_start=a.value.date[0],e.date_end=a.value.date[1]),a.value.last&&(e.last=a.value.last),e.page=a.value.currentPage,e});F(()=>r());const y=U([{label:"\u0414\u0430\u0442\u0430",key:"date"},{label:"\u0421\u0440. \u0446\u0456\u043D\u0430 \u0437\u0430\u044F\u0432\u043A\u0438",key:"average_application_price"},{label:"\u0421\u0440. \u0446\u0456\u043D\u0430 \u0430\u043F\u0440\u0443\u0432\u0430",key:"average_approve_application_price"},{label:"\u0421\u0440. \u0446\u0456\u043D\u0430 \u0432\u0438\u043A\u043E\u043D\u0430\u043D\u043E\u0457 \u0437\u0430\u044F\u0432\u043A\u0438",key:"average_done_application_price"},{label:"\u0421\u0440. \u0447\u0435\u043A",key:"average_check"},{label:"\u0421\u0440. \u043C\u0430\u0440\u0436\u0430",key:"average_marginality"},{label:"\u0421\u0440. \u043A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u0442\u043E\u0432\u0430\u0440\u0456\u0432",key:"average_items"}]);function b(e){e?a.value.last=e:a.value={date:[],filter:null,last:null,currentPage:1},r()}function V(){a.value.last="range",r()}function r(){t.value.isLoading=!0,axios.get(route("api.statistics.marketing.index",g.value)).then(({data:e})=>{t.value.data=e,t.value.isLoading=!1}).catch(e=>{console.log(e),t.value.isLoading=!1}),axios.get(route("api.statistics.marketing.chart",g.value)).then(({data:e})=>t.value.chart=e.result).catch(e=>console.log(e))}return(e,i)=>{const L=n("loader-component"),w=n("label-component"),P=n("Datepicker"),$=n("card-component"),x=n("table-component"),B=n("pagination");return l(),c(C,{title:"\u041C\u0430\u0440\u043A\u0435\u0442\u0438\u043D\u0433\u043E\u0432\u0430 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430"},{header:u(()=>[z]),default:u(()=>[t.value.isLoading?(l(),c(L,{key:0})):d("",!0),!t.value.isLoading&&O(k)("show-bookkeeping-marketing")?(l(),v("div",A,[m("div",E,[m("div",G,[s(w,{value:"\u0424\u0456\u043B\u044C\u0442\u0440 \u043F\u043E \u0434\u0430\u0442\u0456"}),s(P,{modelValue:a.value.date,"onUpdate:modelValue":[i[0]||(i[0]=o=>a.value.date=o),V],class:"w-100",locale:"ru",placeholder:"\u041E\u0431\u0435\u0440\u0456\u0442\u044C \u0434\u0430\u0442\u0443",autoApply:"",monthChangeOnScroll:!1,enableTimePicker:!1,range:"",utc:""},null,8,["modelValue"])])]),s(D,{"active-item":a.value.last,onSortByLast:b},null,8,["active-item"]),t.value.chart?(l(),c(M,{key:0,"chart-data":t.value.chart},null,8,["chart-data"])):d("",!0),m("div",I,[(l(!0),v(T,null,j(t.value.data.generalStatistics,(o,S)=>(l(),c($,{class:"text-center",title:S,description:e.$filters.formatMoney(o)},null,8,["title","description"]))),256))]),s(x,{headings:y,rows:t.value.data.result.data,isSlotMode:!0},{date:u(({data:o})=>[p(f(e.$filters.dateFormat(o.row.date)),1)]),costs:u(({data:o})=>[p(f(e.$filters.formatMoney(o.row.costs)),1)]),_:1},8,["headings","rows"]),s(B,{pagination:t.value.data.result,"click-handler":r,modelValue:a.value.currentPage,"onUpdate:modelValue":i[1]||(i[1]=o=>a.value.currentPage=o)},null,8,["pagination","modelValue"])])):d("",!0)]),_:1})}}};export{J as default};
