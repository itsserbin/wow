import{s as r}from"./swal-01ed9a07.js";import C from"./Modal-13238b93.js";import k from"./OptionsLayout-b2404bbf.js";import L from"./Table-ab4207f7.js";import{L as M}from"./Loader-8bf33617.js";import{_ as b}from"./Button-3f74bcad.js";import{_ as E}from"./Paginate-b71b7269.js";import{i as V,G as $,r as w,o as P,j,p as s,D as u,x as m,A as v,C as p,t as l,q as B,l as _,J as F}from"./app-f55448cf.js";import"./Modal-381c1367.js";import"./Form-89427fab.js";import"./Select-35904355.js";import"./Label-fa7af1d1.js";import"./Input-4fdb1b47.js";import"./vue-datepicker-3843f364.js";import"./AuthenticatedLayout-ecf8db9d.js";import"./index.esm-f21e1dfa.js";import"./Logo-edac3a30.js";import"./vue-i18n.esm-bundler-d070be13.js";import"./SidebarItem-eda03439.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Table-6800669f.js";import"./XCircle-78b15e67.js";const O={key:1},ne={__name:"Index",setup(N){const o=V("$can"),d=$({code:null,percent_discount:null,discount_in_hryvnia:null,end_date:null,published:0}),e=w({data:[],currentPage:1,isLoading:!0,isActiveModal:!1,modalAction:"",item:d});P(()=>{c(1)});const g=j(()=>e.value.isActiveModal?C:null);function c(t){e.value.isLoading=!0,t&&(e.value.currentPage=t),axios.get(route("api.promo-codes.index",{page:e.value.currentPage})).then(a=>{Object.assign(e.value.data,a.data.result),e.value.isLoading=!1}).catch(a=>{console.log(a),e.value.isLoading=!1})}function f(t){o("destroy-promo-codes")&&r({title:"Видалити?",icon:"warning",showCancelButton:!0}).then(a=>{a.isConfirmed&&axios.delete(route("api.promo-codes.destroy",t)).then(()=>{c(),e.value.isActiveModal&&n(),r({icon:"success",title:"Destroyed!"})}).catch(i=>{console.log(i),r({icon:"error",title:"Error!"})})})}function n(){e.value.isActiveModal=!e.value.isActiveModal}function h(t,a){o("edit-promo-codes")&&axios.get(route("api.promo-codes.edit",t)).then(({data:i})=>{e.value.item=i.result,e.value.modalAction="edit",e.value.item.index=a,n()}).catch(i=>console.log(i))}function y(){o("edit-promo-codes")&&axios.put(route("api.promo-codes.update",e.value.item.id),e.value.item).then(()=>{n(),c(),r({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),r({title:"Error!",icon:"error"})})}function x(){o("create-promo-codes")&&axios.post(route("api.promo-codes.create"),e.value.item).then(()=>{n(),e.value.item=d,c(),r({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),r({title:"Error!",icon:"error"})})}function A(){e.value.modalAction==="edit"&&o("edit-promo-codes")?y():e.value.modalAction==="create"&&o("create-promo-codes")&&x()}function D(){o("create-promo-codes")&&(Object.assign(e.value.item,d),e.value.modalAction="create",n())}return(t,a)=>(s(),u(k,{title:"Промо-коди"},{header:m(()=>[v(" Промо-коди ")]),default:m(()=>[e.value.isLoading?(s(),u(M,{key:0})):p("",!0),!e.value.isLoading&&l(o)("show-promo-codes")?(s(),B("div",O,[l(o)("create-promo-codes")?(s(),u(b,{key:0,type:"btn",onClick:D},{default:m(()=>[v(" Додати ")]),_:1})):p("",!0),_(L,{data:e.value.data.data,onOnEdit:h,onOnDestroy:f,canDestroy:l(o)("destroy-promo-codes")},null,8,["data","canDestroy"]),_(E,{pagination:e.value.data,"click-handler":c,modelValue:e.value.currentPage,"onUpdate:modelValue":a[0]||(a[0]=i=>e.value.currentPage=i)},null,8,["pagination","modelValue"]),(s(),u(F(l(g)),{item:e.value.item,onCloseModal:n,onSubmitForm:A,onDeclineForm:f,canDestroy:l(o)("destroy-promo-codes")},null,40,["item","canDestroy"]))])):p("",!0)]),_:1}))}};export{ne as default};
