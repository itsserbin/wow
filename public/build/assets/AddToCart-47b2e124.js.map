{"version":3,"file":"AddToCart-47b2e124.js","sources":["../../../resources/js/Pages/Public/Product/AddToCart.vue"],"sourcesContent":["<script setup>\nimport {ref} from \"vue\";\nimport {useStore} from \"vuex\";\nimport BuyIn1Click from '@/Pages/Public/Product/BuyIn1ClickModal.vue';\nimport {useGtm} from \"@gtm-support/vue-gtm\";\nimport Button from '@/Pages/Public/Components/Button.vue'\nimport {swal} from '@/Includes/swal';\nimport eventTracking from \"@/Includes/eventTracking\";\n\nconst gtm = useGtm();\nconst store = useStore();\n\nconst props = defineProps([\n    'product',\n    'eventIdAddToCard',\n    'eventIdPurchaseIn1Click',\n]);\n\n\nconst item = ref({\n    count: 1,\n    size: [],\n    color: [],\n    item_id: props.product.id,\n    // src: route(route().current(), route().params),\n    src: typeof window !== 'undefined' ? window.location.href : null,\n    event_id: props.eventIdAddToCard\n});\n\n\nconst state = ref({\n    product: {\n        id: null,\n        discount_price: null,\n        price: null,\n        h1: null,\n        sizes: [],\n        colors: [],\n    },\n    isActiveBuyIn1ClickModal: false,\n    isAddToCart: false,\n})\n\nfunction showBuyIn1ClickModal() {\n    state.value.isActiveBuyIn1ClickModal = !state.value.isActiveBuyIn1ClickModal;\n}\n\nfunction addToCart() {\n    if (!state.value.isAddToCart) {\n        axios.post(route('api.v1.cart.add', item.value))\n            .then(() => {\n                state.value.isAddToCart = true;\n                if (import.meta.env.MODE === 'production') {\n                    try {\n                        eventTracking(\n                            'AddToCart',\n                            {\n                                \"value\": props.product.discount_price ? props.product.discount_price : props.product.price,\n                                \"currency\": \"UAH\",\n                                \"content_type\": \"product\",\n                                \"content_ids\": [item.value.item_id],\n                                \"content_name\": props.product.h1\n                            },\n                            item.value.event_id\n                        );\n\n                        gtm.trackEvent({\n                            event: 'add_product_to_cart',\n                            ecommerce: {\n                                items: [{\n                                    item_name: props.product.h1,\n                                    item_id: item.value.item_id,\n                                    price: props.product.discount_price ? props.product.discount_price : props.product.price,\n                                    quantity: 1\n                                }]\n                            }\n                        });\n                    } catch (e) {\n                        console.log(e);\n                    }\n                }\n                store.commit('loadCart');\n                swal({\n                    icon: 'success',\n                    title: 'Товар додано до вашого кошика!',\n                    text: 'Ви можете оформити замовлення або продовжити покупки :)',\n                    showCancelButton: true,\n                    confirmButtonText: 'Оформити замовлення',\n                    cancelButtonText: 'Продовжити покупки',\n\n                }).then((result) => {\n                    if (result.isConfirmed && typeof window !== 'undefined') {\n                        window.location.href = route('checkout');\n                    }\n                })\n\n            })\n            .catch(() => {\n                swal({\n                    icon: 'error',\n                    title: 'Виникла помилка',\n                    text: 'Перевірте корректність данних'\n                })\n            });\n    }\n}\n</script>\n\n<template>\n    <div class=\"pt-[5%]\">\n        <hr class=\"mb-4\">\n        <div class=\"grid grid-cols-1 md:grid-cols-2 font-subheading\">\n            <div class=\"mb-4 mb-md-0 flex items-center justify-evenly flex-col\">\n                <div class=\"text-center\" v-if=\"product.discount_price\">\n                    <div class=\"text-lg font-medium text-[#A5A5A5] line-through\">\n                        {{ product.price }} грн.\n                    </div>\n                    <div class=\"font-bold text-[#ff0000] text-4xl\">{{ product.discount_price }} грн.</div>\n                </div>\n                <div class=\"text-center\" v-if=\"!product.discount_price\">\n                    <div class=\"text-lg font-bold font-medium text-[#A5A5A5] text-[2.5rem]\">\n                        {{ product.price }} грн.\n                    </div>\n                </div>\n            </div>\n            <div class=\"grid gap-4\">\n                <Button @click=\"addToCart\" type=\"button\">\n                    До кошика\n                </Button>\n                <Button @click=\"showBuyIn1ClickModal\" type=\"button\">\n                    Купити в 1 клік\n                </Button>\n            </div>\n        </div>\n        <hr class=\"mt-4\">\n    </div>\n    <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-5 font-subheading\">\n        <div v-if=\"product.sizes.length\">\n            <div class=\"w-full mb-2\">Доступні розміри</div>\n            <ul class=\"flex pb-[20px]\">\n                <li v-for=\"size in product.sizes\" class=\"mx-1\">\n                    <input type=\"checkbox\"\n                           :value=\"size.title\"\n                           :id=\"size.title\"\n                           class=\"hidden peer\"\n                           v-model=\"item.size\"\n                    >\n                    <label :for=\"size.title\"\n                           class=\"\n                                inline-flex\n                                justify-center\n                                items-center\n                                mx-auto\n                                text-gray-500\n                                bg-white rounded-lg border-2\n                                border-gray-200\n                                cursor-pointer\n                                peer-checked:border-blue-600\n                                hover:text-gray-600\n                                peer-checked:text-gray-600\n                                hover:bg-gray-50\n                                w-[40px]\n                                h-[40px]\n                            \"\n                    >\n                        {{ size.title }}\n                    </label>\n                </li>\n            </ul>\n        </div>\n        <div v-if=\"product.colors.length\">\n            <div class=\"w-100 mb-2\">Доступні кольори</div>\n            <div class=\"flex\">\n                <div v-for=\"color in product.colors\">\n                    <input type=\"checkbox\"\n                           :id=\"color.name\"\n                           :value=\"color.name\"\n                           class=\"hidden peer\"\n                           v-model=\"item.color\"\n                    >\n                    <label :for=\"color.name\"\n                           :style=\"'background-color:' + color.hex\"\n                           class=\"\n                                inline-flex\n                                justify-center\n                                items-center\n                                mx-auto\n                                text-black-500\n                                rounded-lg\n                                border-2\n                                border-gray-200\n                                cursor-pointer\n                                peer-checked:border-blue-600\n                                hover:text-black\n                                peer-checked:text-gray-600\n                                hover:bg-black\n                                w-[40px]\n                                h-[40px]\n                            \"\n                    >\n                    </label>\n                </div>\n            </div>\n        </div>\n    </div>\n    <BuyIn1Click v-if=\"state.isActiveBuyIn1ClickModal\"\n                 @closeModal=\"showBuyIn1ClickModal\"\n                 :item=\"item\"\n                 :product=\"product\"\n                 :cart=\"store.state.list\"\n                 :eventIdPurchaseIn1Click=\"props.eventIdPurchaseIn1Click\"\n                 :eventIdAddToCard=\"props.eventIdAddToCard\"\n                 :isAddToCart=\"state.isAddToCart\"\n    />\n</template>\n"],"names":["gtm","useGtm","store","useStore","item","ref","props","state","showBuyIn1ClickModal","addToCart","eventTracking","e","swal","result"],"mappings":"u9CASMA,EAAMC,EAAM,EACZC,EAAQC,EAAQ,EAShBC,EAAOC,EAAI,CACb,MAAO,EACP,KAAM,CAAE,EACR,MAAO,CAAE,EACT,QAASC,EAAM,QAAQ,GAEvB,IAAK,OAAO,OAAW,IAAc,OAAO,SAAS,KAAO,KAC5D,SAAUA,EAAM,gBACpB,CAAC,EAGKC,EAAQF,EAAI,CACd,QAAS,CACL,GAAI,KACJ,eAAgB,KAChB,MAAO,KACP,GAAI,KACJ,MAAO,CAAE,EACT,OAAQ,CAAE,CACb,EACD,yBAA0B,GAC1B,YAAa,EACjB,CAAC,EAED,SAASG,GAAuB,CAC5BD,EAAM,MAAM,yBAA2B,CAACA,EAAM,MAAM,wBACxD,CAEA,SAASE,GAAY,CACZF,EAAM,MAAM,aACb,MAAM,KAAK,MAAM,kBAAmBH,EAAK,KAAK,CAAC,EAC1C,KAAK,IAAM,CACRG,EAAM,MAAM,YAAc,GAEtB,GAAI,CACAG,EACI,YACA,CACI,MAASJ,EAAM,QAAQ,eAAiBA,EAAM,QAAQ,eAAiBA,EAAM,QAAQ,MACrF,SAAY,MACZ,aAAgB,UAChB,YAAe,CAACF,EAAK,MAAM,OAAO,EAClC,aAAgBE,EAAM,QAAQ,EACjC,EACDF,EAAK,MAAM,QACvC,EAEwBJ,EAAI,WAAW,CACX,MAAO,sBACP,UAAW,CACP,MAAO,CAAC,CACJ,UAAWM,EAAM,QAAQ,GACzB,QAASF,EAAK,MAAM,QACpB,MAAOE,EAAM,QAAQ,eAAiBA,EAAM,QAAQ,eAAiBA,EAAM,QAAQ,MACnF,SAAU,CAC9C,CAAiC,CACJ,CAC7B,CAAyB,CACJ,OAAQK,EAAP,CACE,QAAQ,IAAIA,CAAC,CAChB,CAELT,EAAM,OAAO,UAAU,EACvBU,EAAK,CACD,KAAM,UACN,MAAO,iCACP,KAAM,0DACN,iBAAkB,GAClB,kBAAmB,sBACnB,iBAAkB,oBAEtC,CAAiB,EAAE,KAAMC,GAAW,CACZA,EAAO,aAAe,OAAO,OAAW,MACxC,OAAO,SAAS,KAAO,MAAM,UAAU,EAE/D,CAAiB,CAEjB,CAAa,EACA,MAAM,IAAM,CACTD,EAAK,CACD,KAAM,QACN,MAAO,kBACP,KAAM,+BAC1B,CAAiB,CACjB,CAAa,CAEb"}