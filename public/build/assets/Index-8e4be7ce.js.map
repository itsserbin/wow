{"version":3,"file":"Index-8e4be7ce.js","sources":["../../../resources/js/Repositories/PagesRepository.js","../../../resources/js/Pages/Admin/Content/Pages/Index.vue"],"sourcesContent":["export default {\n    async fetch(params) {\n        try {\n            const response = await axios.get(route('api.pages.index', params));\n            return response.data;\n        } catch (error) {\n            throw new Error(error.response.data);\n        }\n    },\n    async destroy(id) {\n        try {\n            const response = await axios.delete(route('api.pages.destroy', id));\n            return response.data;\n        } catch (error) {\n            throw new Error(error.response.data);\n        }\n    },\n    async edit(id) {\n        try {\n            const response = await axios.get(route('api.pages.edit', id));\n            return response.data;\n        } catch (error) {\n            throw new Error(error.response.data);\n        }\n    },\n    async update(item) {\n        try {\n            const response = await axios.put(route('api.pages.update', item.id), item);\n            return response.data;\n        } catch (error) {\n            return error.response.data;\n        }\n    },\n    async create(item) {\n        try {\n            const response = await axios.post(route('api.pages.create'), item);\n            return response.data;\n        } catch (error) {\n            return error.response.data;\n        }\n    },\n};\n","<script setup>\nimport Loader from '@/Components/Loader.vue';\nimport Button from '@/Components/Button.vue';\nimport Paginate from '@/Components/Paginate.vue';\nimport Modal from '@/Pages/Admin/Content/Pages/Modal.vue';\nimport Table from '@/Pages/Admin/Content/Pages/Table.vue'\nimport ContentLayout from '@/Pages/Admin/Content/ContentLayout.vue'\nimport {swal} from \"@/Includes/swal\";\n\nimport {reactive, onMounted, inject, ref, computed} from \"vue\";\nimport PagesRepository from \"@/Repositories/PagesRepository\";\nimport {useI18n} from 'vue-i18n'\n\nconst can = inject('$can');\nconst {t} = useI18n();\n\nconst item = reactive({\n    slug: null,\n    published: 0,\n    heading: {\n        ru: null,\n        ua: null\n    },\n    h1: {\n        ru: null,\n        ua: null\n    },\n    content: {\n        ru: null,\n        ua: null\n    },\n    meta_title: {\n        ru: null,\n        ua: null\n    },\n    meta_description: {\n        ru: null,\n        ua: null\n    }\n})\n\nconst state = ref({\n    data: [],\n    currentPage: 1,\n    isLoading: true,\n    isActiveModal: false,\n    modalAction: '',\n    errors: [],\n    item: {},\n});\n\nonMounted(() => {\n    fetch(1);\n})\n\nconst activeModal = computed(() => state.value.isActiveModal ? Modal : null)\n\nconst fetch = async (page) => {\n    state.value.isLoading = true;\n    if (page) {\n        state.value.currentPage = page;\n    }\n    const data = await PagesRepository.fetch({'page': state.value.currentPage});\n    state.value.data = data.success ? data.result : [];\n    state.value.isLoading = false;\n}\n\nconst onDestroy = async (id) => {\n    if (can('destroy-pages')) {\n        const result = await swal({\n            title: t('swal.sure'),\n            icon: 'warning',\n            showCancelButton: true,\n        })\n        if (result.isConfirmed) {\n            const {success} = await PagesRepository.destroy(id);\n            if (success) {\n                await fetch();\n                if (state.value.isActiveModal) {\n                    modalFunction();\n                }\n                await swal({\n                    icon: 'success',\n                    title: t('swal.destroyed')\n                });\n            }\n        }\n    }\n}\n\nconst modalFunction = () => {\n    state.value.isActiveModal = !state.value.isActiveModal;\n}\n\nconst onEdit = async (id, i) => {\n    if (can('edit-pages')) {\n        const data = await PagesRepository.edit(id);\n        if (data.success) {\n            state.value.item = data.result;\n            state.value.modalAction = 'edit';\n            state.value.item.index = i;\n            modalFunction();\n        }\n    }\n}\n\nconst onUpdate = async () => {\n    if (can('edit-pages')) {\n        const data = await PagesRepository.update(state.value.item);\n        if (data.success) {\n            modalFunction();\n            await fetch();\n            await swal({\n                title: t('swal.updated'),\n                icon: 'success'\n            })\n        } else {\n            state.value.errors = data;\n            console.log(data);\n            await swal({\n                title: t('swal.error'),\n                icon: 'error',\n                text: t('swal.check_data')\n            })\n        }\n    }\n}\n\nconst onCreate = async () => {\n    if (can('create-pages')) {\n        const data = await PagesRepository.create(state.value.item);\n        if (data.success) {\n            modalFunction();\n            state.value.item = {};\n            await fetch();\n            await swal({\n                title: t('swal.created'),\n                icon: 'success'\n            });\n        } else {\n            state.value.errors = data;\n            console.log(data);\n            await swal({\n                title: t('swal.error'),\n                text: t('swal.check_data'),\n                icon: 'error'\n            })\n        }\n    }\n}\n\nconst submitForm = async () => {\n    if (state.value.modalAction === 'edit' && can('edit-pages')) {\n        await onUpdate();\n    } else if (state.value.modalAction === 'create' && can('create-pages')) {\n        await onCreate();\n    }\n}\n\nconst create = () => {\n    if (can('create-pages')) {\n        state.value.item = item;\n        state.value.modalAction = 'create';\n        modalFunction();\n    }\n}\n</script>\n\n<template>\n    <ContentLayout :title=\"$t('pages.page_title')\">\n        <template #header>{{ $t('pages.page_title') }}</template>\n\n        <Loader v-if=\"state.isLoading\"/>\n        <div v-if=\"!state.isLoading && can('show-pages')\" class=\"grid gap-4 grid-cols-1\">\n            <div>\n                <Button type=\"btn\" @click=\"create\" v-if=\"can('create-pages')\">\n                    {{ $t('add') }}\n                </Button>\n            </div>\n\n            <div>\n                <Table :data=\"state.data.data\"\n                       @onEdit=\"onEdit\"\n                       @onDestroy=\"onDestroy\"\n                       :canDestroy=\"can('destroy-pages')\"\n                />\n            </div>\n\n            <div class=\"text-center\">\n                <Paginate :pagination=\"state.data\"\n                          :click-handler=\"fetch\"\n                          v-model=\"state.currentPage\"\n                />\n            </div>\n        </div>\n        <component :is=\"activeModal\"\n                   :item=\"state.item\"\n                   @closeModal=\"modalFunction\"\n                   @submitForm=\"submitForm\"\n                   @declineForm=\"onDestroy\"\n                   :canDestroy=\"can('destroy-pages')\"\n        ></component>\n    </ContentLayout>\n</template>\n"],"names":["PagesRepository","params","error","id","item","can","inject","t","useI18n","reactive","state","ref","onMounted","fetch","activeModal","computed","Modal","page","data","onDestroy","swal","success","modalFunction","onEdit","i","onUpdate","onCreate","submitForm","create"],"mappings":"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"}