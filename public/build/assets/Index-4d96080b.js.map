{"version":3,"file":"Index-4d96080b.js","sources":["../../../resources/js/Pages/Public/Category/Index.vue"],"sourcesContent":["<script setup>\nimport {isLoading} from \"@/Pages/Public/load\";\nimport {computed, onMounted, ref} from \"vue\";\n\nimport Support from '../Components/Support.vue';\nimport Consultation from '../Components/Consultation.vue';\nimport Content from '../Components/Content.vue';\nimport Banners from '../Components/Banners.vue';\nimport Products from './Products.vue';\nimport Sort from './Sort.vue';\nimport Filter from './Filter.vue';\nimport ProductsRepository from \"@/Repositories/ProductsRepository\";\nimport Button from '@/Pages/Public/Components/Button.vue'\nimport MasterLayout from '@/Layouts/MasterLayout.vue'\nimport Breadcrumbs from './Breadcrumbs.vue'\nimport Head from './Head.vue';\n\ndefineOptions({layout: MasterLayout})\n\nconst props = defineProps([\n    'banners',\n    'lang',\n    'title',\n    'characteristics',\n    'text',\n    'consultation',\n    'products',\n    'categories',\n    'category',\n    'options',\n    'pages',\n    'eventIdPageView',\n]);\n\nconst state = ref({\n    products: [],\n    isLoadingMore: false,\n    isShowLoadMore: true,\n    isShowFilter: false\n});\n\nconst params = ref({\n    currentPage: 1,\n    sort: null,\n    filter: null,\n});\n\nconst getParams = computed(() => {\n    const {currentPage, sort, filter} = params.value;\n    return {\n        page: currentPage,\n        sort: sort,\n        filter: filter,\n        slug: (route().params).slug\n    };\n});\n\nonMounted(async () => {\n    state.value.products = props.products.data;\n    isLoading.value = false;\n})\n\nconst onSort = async () => {\n    params.value.currentPage = 0;\n    state.value.products = [];\n    await fetch();\n}\n\nconst filter = async (val) => {\n    params.value.filter = val;\n    params.value.currentPage = 0;\n    state.value.products = [];\n    if (state.value.isShowFilter) {\n        toggleFilter();\n    }\n    await fetch();\n}\n\nconst fetch = async () => {\n    params.value.currentPage += 1;\n    try {\n        const data = await ProductsRepository.v1().category(getParams.value);\n        if (data.success) {\n            params.value.currentPage = data.result.current_page;\n            state.value.products = state.value.products.concat(data.result.data);\n            state.value.isShowLoadMore = (data.result.to !== data.result.total);\n        }\n    } catch (e) {\n        console.error(e);\n        state.value.isLoading = false;\n    }\n}\n\nconst toggleFilter = () => {\n    state.value.isShowFilter = !state.value.isShowFilter;\n}\n\n</script>\n\n<template>\n    <Head :category=\"category\" :lang=\"lang\"/>\n\n    <Breadcrumbs :currentUrl=\"route().current\" :options=\"options\" :lang=\"lang\" :title=\"category.title[lang]\"/>\n\n    <div class=\"grid grid-cols-1 gap-4\">\n\n        <Banners v-if=\"banners.length\" :lang=\"lang\" :data=\"banners\"/>\n\n        <div class=\"flex justify-between md:justify-end items-center\">\n            <div class=\"block md:hidden mr-2\">\n                <Button type=\"button\" @click=\"toggleFilter\">Фільтрувати</Button>\n            </div>\n\n            <Sort v-model=\"params.sort\" @sort=\"onSort\"/>\n        </div>\n\n        <div class=\"grid grid-cols-12 gap-4\">\n            <div :class=\"{'!block fixed h-full w-full z-50 overflow-y-scroll top-0 right-0' : state.isShowFilter}\"\n                 class=\"filter hidden md:col-span-3 md:block\"\n            >\n                <Filter v-if=\"Object.keys(characteristics).length\"\n                        :characteristics=\"characteristics\"\n                        :lang=\"lang\"\n                        @fetch=\"filter\"\n                        @close=\"toggleFilter\"\n                        :isShow=\"state.isShowFilter\"\n                />\n            </div>\n            <div class=\"products col-span-12 md:col-span-9\">\n                <Products :lang=\"lang\"\n                          :title=\"title\"\n                          :data=\"state.products\"\n                          :isLoadingMore=\"state.isLoadingMore\"\n                          :isShowLoadMore=\"state.isShowLoadMore\"\n                          @fetch=\"fetch\"\n                          v-if=\"state.products.length\"\n                />\n            </div>\n        </div>\n\n        <Content v-if=\"text\" :data=\"text\"/>\n\n        <Consultation v-if=\"consultation\"/>\n        <Support v-if=\"!isLoading\"/>\n    </div>\n</template>\n"],"names":["__default__","__MACROS_defineComponent","MasterLayout","state","ref","params","getParams","computed","currentPage","sort","filter","onMounted","props","isLoading","onSort","fetch","val","toggleFilter","data","ProductsRepository","e"],"mappings":"6vDAiBcA,EAAAC,EAAA,CAAC,OAAQC,CAAY,CAAA,wMAiB7BC,EAAQC,EAAI,CACd,SAAU,CAAE,EACZ,cAAe,GACf,eAAgB,GAChB,aAAc,EAClB,CAAC,EAEKC,EAASD,EAAI,CACf,YAAa,EACb,KAAM,KACN,OAAQ,IACZ,CAAC,EAEKE,EAAYC,EAAS,IAAM,CAC7B,KAAM,CAAC,YAAAC,EAAa,KAAAC,EAAM,OAAAC,CAAM,EAAIL,EAAO,MAC3C,MAAO,CACH,KAAMG,EACN,KAAMC,EACN,OAAQC,EACR,KAAO,QAAQ,OAAQ,IAC/B,CACA,CAAC,EAEDC,EAAU,SAAY,CAClBR,EAAM,MAAM,SAAWS,EAAM,SAAS,KACtCC,EAAU,MAAQ,EACtB,CAAC,EAED,MAAMC,EAAS,SAAY,CACvBT,EAAO,MAAM,YAAc,EAC3BF,EAAM,MAAM,SAAW,GACvB,MAAMY,EAAK,CACf,EAEML,EAAS,MAAOM,GAAQ,CAC1BX,EAAO,MAAM,OAASW,EACtBX,EAAO,MAAM,YAAc,EAC3BF,EAAM,MAAM,SAAW,GACnBA,EAAM,MAAM,cACZc,IAEJ,MAAMF,EAAK,CACf,EAEMA,EAAQ,SAAY,CACtBV,EAAO,MAAM,aAAe,EAC5B,GAAI,CACA,MAAMa,EAAO,MAAMC,EAAmB,GAAI,EAAC,SAASb,EAAU,KAAK,EAC/DY,EAAK,UACLb,EAAO,MAAM,YAAca,EAAK,OAAO,aACvCf,EAAM,MAAM,SAAWA,EAAM,MAAM,SAAS,OAAOe,EAAK,OAAO,IAAI,EACnEf,EAAM,MAAM,eAAkBe,EAAK,OAAO,KAAOA,EAAK,OAAO,MAEpE,OAAQE,EAAP,CACE,QAAQ,MAAMA,CAAC,EACfjB,EAAM,MAAM,UAAY,EAC3B,CACL,EAEMc,EAAe,IAAM,CACvBd,EAAM,MAAM,aAAe,CAACA,EAAM,MAAM,YAC5C"}