import P from"./Chart.fc2503bc.js";import S from"./StatisticLayout.e6e4bd98.js";import{h as C}from"./app.2eb96d9f.js";import D from"./LastParams.454a7447.js";import{z as p,A as N,D as F,u as U,U as m,R as o,Q as n,W as _,K as v,L as f,J as i,F as A,S as R,Z as l,M as s,v as y,V as u}from"./_plugin-vue_export-helper.a5aa4da2.js";import"./index.ed0d22e8.js";import"./Sidebar.bac20e14.js";const T=l(" \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430 \u0437\u0430\u044F\u0432\u043E\u043A "),j={key:1},q={class:"grid grid-cols-1 gap-4 mt-5"},z={class:"block"},E={class:"grid grid-cols-2 md:grid-cols-4"},H={__name:"Index",setup(I){y("$swal"),y("$can");const r=p({orders:[],chart:null,isLoading:!0}),t=p({date:[],filter:null,last:"one-month",currentPage:1});p([]);const g=N(()=>{const a={};return t.value.date.length===2&&(a.date_start=t.value.date[0],a.date_end=t.value.date[1]),t.value.last&&(a.last=t.value.last),a.page=t.value.currentPage,a});F(()=>d());const h=U([{label:"\u0414\u0430\u0442\u0430",key:"date"},{label:"\u0412\u0441\u044C\u043E\u0433\u043E",key:"applications"},{label:"\u041F\u0435\u0440\u0435\u0434\u0430\u043D\u0456 \u043F\u043E\u0441\u0442\u0430\u0447\u0430\u043B\u044C\u043D\u0438\u043A\u0443",key:"transferred_to_supplier"},{label:"\u0412\u0438\u043C\u0430\u0433\u0430\u044E\u0442\u044C \u0443\u0442\u043E\u0447\u043D\u0435\u043D\u043D\u044F",key:"requires_clarification"},{label:"\u041E\u0447\u0456\u043A\u0443\u044E\u0442\u044C \u0432\u0456\u0434\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043D\u044F",key:"awaiting_dispatch"},{label:"\u041E\u0447\u0456\u043A\u0443\u044E\u0442\u044C \u043F\u0435\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0438",key:"awaiting_prepayment"},{label:"\u0412 \u0434\u043E\u0440\u043E\u0437\u0456",key:"on_the_road"},{label:"\u0412 \u043F\u0440\u043E\u0446\u0435\u0441\u0456",key:"in_process"},{label:"\u041D\u0430 \u043F\u043E\u0448\u0442\u0456",key:"at_the_post_office"},{label:"\u0412\u0438\u043A\u043E\u043D\u0430\u043D\u0456",key:"completed"},{label:"\u041F\u043E\u0432\u0435\u0440\u043D\u0435\u043D\u043D\u044F",key:"refunds"},{label:"\u0421\u043A\u0430\u0441\u043E\u0432\u0430\u043D\u0456",key:"cancel"},{label:"\u041D\u043E\u0432\u0456",key:"unprocessed"}]);function k(a){a?t.value.last=a:t.value={date:[],filter:null,last:null,currentPage:1},d()}function b(){t.value.last="range",d()}function d(){r.value.isLoading=!0,axios.get(route("api.statistics.orders.index",g.value)).then(({data:a})=>{r.value.orders=a,r.value.isLoading=!1}).catch(a=>{console.log(a),r.value.isLoading=!1}),axios.get(route("api.statistics.orders.chart",g.value)).then(({data:a})=>r.value.chart=a.result).catch(a=>console.log(a))}return(a,c)=>{const w=u("loader-component"),$=u("label-component"),M=u("Datepicker"),V=u("card-component"),L=u("table-component");return n(),m(S,{title:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430 \u0437\u0430\u044F\u0432\u043E\u043A"},{header:o(()=>[T]),default:o(()=>[r.value.isLoading?(n(),m(w,{key:0})):_("",!0),r.value.isLoading?_("",!0):(n(),v("div",j,[f("div",q,[f("div",z,[i($,{value:"\u0424\u0456\u043B\u044C\u0442\u0440 \u043F\u043E \u0434\u0430\u0442\u0456"}),i(M,{modelValue:t.value.date,"onUpdate:modelValue":[c[0]||(c[0]=e=>t.value.date=e),b],class:"w-100",locale:"ru",placeholder:"\u041E\u0431\u0435\u0440\u0456\u0442\u044C \u0434\u0430\u0442\u0443",autoApply:"",monthChangeOnScroll:!1,enableTimePicker:!1,range:"",utc:""},null,8,["modelValue"])])]),i(D,{"active-item":t.value.last,onSortByLast:k},null,8,["active-item"]),r.value.chart?(n(),m(P,{key:0,"chart-data":r.value.chart},null,8,["chart-data"])):_("",!0),f("div",E,[(n(!0),v(A,null,R(r.value.orders.generalStatistics,(e,B)=>(n(),m(V,{class:"text-center",title:B,description:e||0},null,8,["title","description"]))),256))]),i(L,{headings:h,rows:r.value.orders.result.data,isSlotMode:!0},{date:o(({data:e})=>[l(s(a.$filters.dateFormat(e.row.date)),1)]),costs:o(({data:e})=>[l(s(a.$filters.formatMoney(e.row.costs)),1)]),turnover:o(({data:e})=>[l(s(a.$filters.formatMoney(e.row.turnover)),1)]),marginality:o(({data:e})=>[l(s(a.$filters.formatMoney(e.row.marginality)),1)]),clear_profit:o(({data:e})=>[l(s(a.$filters.formatMoney(e.row.clear_profit)),1)]),average_marginality:o(({data:e})=>[l(s(a.$filters.formatMoney(e.row.average_marginality)),1)]),sale_of_air_sum:o(({data:e})=>[l(s(a.$filters.formatMoney(e.row.sale_of_air_sum)),1)]),debt_supplier:o(({data:e})=>[l(s(a.$filters.formatMoney(e.row.debt_supplier)),1)]),prepayment_sum:o(({data:e})=>[l(s(a.$filters.formatMoney(e.row.prepayment_sum)),1)]),refunds_sum:o(({data:e})=>[l(s(a.$filters.formatMoney(e.row.refunds_sum)),1)]),additional_sales_marginality_sum:o(({data:e})=>[l(s(a.$filters.formatMoney(e.row.additional_sales_marginality_sum)),1)]),additional_sales_sum:o(({data:e})=>[l(s(a.$filters.formatMoney(e.row.additional_sales_sum)),1)]),_:1},8,["headings","rows"]),i(C,{pagination:r.value.orders.result,"click-handler":d,modelValue:t.value.currentPage,"onUpdate:modelValue":c[1]||(c[1]=e=>t.value.currentPage=e)},null,8,["pagination","modelValue"])]))]),_:1})}}};export{H as default};
