import W from"./Modal.be7735c4.js";import X from"./Modal.bcb6c49f.js";import Y from"./Table.b2c803eb.js";import{y,z as x,G as Z,a0 as d,W as g,$ as r,S as n,Z as b,P as v,L as A,M as f,K as h,F as q,Y as H,X as D,O as J,bg as E,D as L}from"./___vite-browser-external_commonjs-proxy.bd54111c.js";import"./Form.5f5b258f.js";import"./ItemsTable.9c42cdf6.js";import"./Form.e7e466ef.js";import"./ItemsModal.a274fc2d.js";import"./ItemsForm.502137b5.js";import"./ItemsTable.4e89c5c3.js";import"./ClientOrders.9abf38b7.js";const Q=D(" \u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F "),R={key:1},ee={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},te={class:"md:col-span-1"},oe={class:"w-full md:col-span-4 grid gap-4 grid-cols-1"},ae={class:"text-center"},fe={__name:"Index",props:["statuses","payment_methods"],setup(S){const _=S,e=y({orders:[],currentPage:1,isLoading:!0,isActiveEditModal:!1,isActiveClientModal:!1,sidebarActive:"all",orderModal:{},clientModal:{},clientsStatuses:null,clientsSubStatuses:null}),p=y([]),a=L("$swal"),i=L("$can"),s=y({status:null,currentPage:1}),F=x(()=>{const t={};return t.page=s.value.currentPage,s.value.status&&(t.status=s.value.status),t});Z(()=>{u(),p.value.push({title:"\u0412\u0441\u0456 \u0437\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F",key:"all"});for(const[t,o]of Object.entries(_.statuses))p.value.push({title:o,key:t});route().params.id&&(e.value.isLoading=!0,k(route().params.id)),axios.get(route("api.clients.statuses")).then(({data:t})=>{e.value.clientsStatuses=t.statuses,e.value.clientsSubStatuses=t.subStatuses})});const P=x(()=>e.value.isActiveEditModal?X:null),w=x(()=>e.value.isActiveClientModal?W:null);function V(){axios.get(route("api.clients.edit",e.value.orderModal.client.id)).then(({data:t})=>{e.value.clientModal=t.result,M()}).catch(t=>console.log(t))}function M(){e.value.isActiveClientModal=!e.value.isActiveClientModal}function $(){axios.put(route("api.clients.update",e.value.clientModal.id),e.value.clientModal).then(()=>{M(),axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal).then(()=>{axios.get(route("api.orders.edit",e.value.orderModal.id)).then(({data:t})=>{e.value.orderModal=t.result,a({title:"Success!",icon:"success"})}).catch(t=>console.log(t))})}).catch(t=>{console.log(t),a({title:"Error!",icon:"error"})})}function B(){i("edit-orders")&&(axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal),axios.get(route("api.orders.edit",e.value.orderModal.id)).then(({data:t})=>e.value.orderModal=t.result).catch(t=>console.log(t)))}function O(t){e.value.sidebarActive=t,t==="all"?s.value.status=null:s.value.status=t,u()}function N(t){t&&(s.value.currentPage=t),u()}function z(t){axios.get(route("api.orders.search",t)).then(({data:o})=>{e.value.sidebarActive=null,s.value.currentPage=1,e.value.orders=o.result,e.value.isLoading=!1}).catch(o=>{console.log(o),e.value.isLoading=!1})}function u(){axios.get(route("api.orders.index",F.value)).then(({data:t})=>{e.value.orders=t.result,e.value.isLoading=!1}).catch(t=>{console.log(t),e.value.isLoading=!1})}function C(t){i("destroy-orders")&&a({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(o=>{o.isConfirmed&&axios.delete(route("api.orders.destroy",t)).then(()=>{e.value.isLoading=!1,u(),e.value.isActiveEditModal&&m(),a({title:"Success!",icon:"success"})}).catch(l=>{console.log(l),a({title:"Error!",icon:"error"})})})}function k(t,o){axios.get(route("api.orders.edit",t)).then(({data:l})=>{e.value.orderModal.index=o,e.value.orderModal=l.result,m(),e.value.isLoading=!1}).catch(l=>console.log(l))}function I(){i("edit-orders")&&axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal).then(()=>{m(),u(),a({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),a({title:"Error!",icon:"error"})})}function m(){e.value.isActiveEditModal=!e.value.isActiveEditModal}return(t,o)=>{const l=r("loader-component"),U=r("sidebar-item"),j=r("sidebar-component"),G=r("search-component"),K=r("pagination"),T=r("auth-layout");return n(),d(T,{title:"\u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F"},{header:g(()=>[Q]),default:g(()=>[e.value.isLoading?(n(),d(l,{key:0})):b("",!0),!e.value.isLoading&&v(i)("show-orders")?(n(),A("div",R,[f("div",ee,[f("div",te,[h(j,null,{default:g(()=>[p.value.length?(n(!0),A(q,{key:0},H(p.value,c=>(n(),d(U,{onClick:se=>O(c.key),active:e.value.sidebarActive===c.key},{default:g(()=>[D(J(c.title),1)]),_:2},1032,["onClick","active"]))),256)):b("",!0)]),_:1})]),f("div",oe,[h(G,{onSearch:z,clear:!0,placeholder:"\u0406\u043C\u02BC\u044F, \u043F\u0440\u0456\u0437\u0432\u0438\u0449\u0435, \u0442\u0435\u043B\u0435\u0444\u043E\u043D, \u043D\u0430\u043A\u043B\u0430\u0434\u043A\u0430, \u043A\u043E\u043C\u0435\u043D\u0442\u0430\u0440..."}),h(Y,{data:e.value.orders.data,onOnEdit:k,onOnDestroy:C,statuses:S.statuses,canDestroy:v(i)("destroy-orders")},null,8,["data","statuses","canDestroy"]),f("div",ae,[h(K,{pagination:e.value.orders,"click-handler":N,modelValue:e.value.currentPage,"onUpdate:modelValue":o[0]||(o[0]=c=>e.value.currentPage=c)},null,8,["pagination","modelValue"])])])]),(n(),d(E(v(P)),{order:e.value.orderModal,statuses:_.statuses,paymentMethods:_.payment_methods,size:"extralarge",onCloseModal:m,onDeclineForm:C,onSubmitForm:I,onSubmitItemForm:B,canDestroy:v(i)("destroy-orders"),onOnEditClient:V},null,40,["order","statuses","paymentMethods","canDestroy"])),(n(),d(E(v(w)),{item:e.value.clientModal,statuses:e.value.clientsStatuses,"sub-statuses":e.value.clientsSubStatuses,size:"extralarge",onCloseModal:M,onSubmitForm:$},null,40,["item","statuses","sub-statuses"]))])):b("",!0)]),_:1})}}};export{fe as default};
