/*!
 * maska v1.5.0
 * (c) 2019-2021 Alexander Shabunevich
 * Released under the MIT License.
 */function E(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function j(r,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function S(r,n,e){return n in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}function k(r,n){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),e.push.apply(e,t)}return e}function m(r){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?k(Object(e),!0).forEach(function(t){S(r,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):k(Object(e)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))})}return r}var b={"#":{pattern:/[0-9]/},X:{pattern:/[0-9a-zA-Z]/},S:{pattern:/[a-zA-Z]/},A:{pattern:/[a-zA-Z]/,uppercase:!0},a:{pattern:/[a-zA-Z]/,lowercase:!0},"!":{escape:!0},"*":{repeat:!0}};function h(r,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:b,t=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return w(n).length>1?A(n)(r,n,e,t):g(r,n,e,t)}function w(r){try{return JSON.parse(r)}catch{return[r]}}function A(r){var n=w(r).sort(function(t,a){return t.length-a.length});return function(t,a,s){var u=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],o=n.map(function(i){return g(t,i,s,!1)}),l=o.pop();for(var p in n)if(e(l,n[p],s))return g(t,n[p],s,u);return""};function e(t,a,s){for(var u in s)s[u].escape&&(a=a.replace(new RegExp(u+".{1}","g"),""));return a.split("").filter(function(o){return s[o]&&s[o].pattern}).length>=t.length}}function g(r,n,e){for(var t=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],a=0,s=0,u="",o="";a<n.length&&s<r.length;){var l=n[a],p=r[s],i=e[l];if(i&&i.pattern)i.pattern.test(p)&&(u+=V(p,i),a++,t&&n[a]&&(e[n[a]]?e[n[a]]&&e[n[a]].escape&&(u+=n[a+1],a+=2):(u+=n[a],a++))),s++;else if(i&&i.repeat){var c=e[n[a-1]];c&&!c.pattern.test(p)?a++:a--}else i&&i.escape&&(l=n[++a]),t&&(u+=l),p===l&&s++,a++}for(;t&&a<n.length;){var f=n[a];if(e[f]){o="";break}o+=f,a++}return u+o}function V(r,n){return n.transform&&(r=n.transform(r)),n.uppercase?r.toLocaleUpperCase():n.lowercase?r.toLocaleLowerCase():r}function y(r){return r instanceof HTMLInputElement?r:r.querySelector("input")||r}function d(r){return Object.prototype.toString.call(r)==="[object String]"}var O=function(){function r(t){var a=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(E(this,r),!t)throw new Error("Maska: no element for mask");if(s.preprocessor!=null&&typeof s.preprocessor!="function")throw new Error("Maska: preprocessor must be a function");if(s.tokens)for(var u in s.tokens)s.tokens[u]=m({},s.tokens[u]),s.tokens[u].pattern&&d(s.tokens[u].pattern)&&(s.tokens[u].pattern=new RegExp(s.tokens[u].pattern));this._opts={mask:s.mask,tokens:m(m({},b),s.tokens),preprocessor:s.preprocessor},this._el=d(t)?document.querySelectorAll(t):t.length?t:[t],this.inputEvent=function(o){return a.updateValue(o.target,o)},this.init()}var n,e;return n=r,(e=[{key:"init",value:function(){for(var t=this,a=function(u){var o=y(t._el[u]);!t._opts.mask||o.dataset.mask&&o.dataset.mask===t._opts.mask||(o.dataset.mask=t._opts.mask),setTimeout(function(){return t.updateValue(o)},0),o.dataset.maskInited||(o.dataset.maskInited=!0,o.addEventListener("input",t.inputEvent),o.addEventListener("beforeinput",t.beforeInput))},s=0;s<this._el.length;s++)a(s)}},{key:"destroy",value:function(){for(var t=0;t<this._el.length;t++){var a=y(this._el[t]);a.removeEventListener("input",this.inputEvent),a.removeEventListener("beforeinput",this.beforeInput),delete a.dataset.mask,delete a.dataset.maskInited}}},{key:"updateValue",value:function(t,a){if(t&&t.type){var s=t.type.match(/^number$/i)&&t.validity.badInput;if(!t.value&&!s||!t.dataset.mask)return t.dataset.maskRawValue="",void this.dispatch("maska",t,a);var u=t.selectionEnd,o=t.value,l=o[u-1];t.dataset.maskRawValue=h(t.value,t.dataset.mask,this._opts.tokens,!1);var p=t.value;this._opts.preprocessor&&(p=this._opts.preprocessor(p)),t.value=h(p,t.dataset.mask,this._opts.tokens),a&&a.inputType==="insertText"&&u===o.length&&(u=t.value.length),function(i,c,f){for(;c&&c<i.value.length&&i.value.charAt(c-1)!==f;)c++;(i.type?i.type.match(/^(text|search|password|tel|url)$/i):!i.type)&&i===document.activeElement&&(i.setSelectionRange(c,c),setTimeout(function(){i.setSelectionRange(c,c)},0))}(t,u,l),this.dispatch("maska",t,a),t.value!==o&&this.dispatch("input",t,a)}}},{key:"beforeInput",value:function(t){t&&t.target&&t.target.type&&t.target.type.match(/^number$/i)&&t.data&&isNaN(t.target.value+t.data)&&t.preventDefault()}},{key:"dispatch",value:function(t,a,s){a.dispatchEvent(function(u){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,l=document.createEvent("Event");return l.initEvent(u,!0,!0),o&&(l.inputType=o),l}(t,s&&s.inputType||null))}}])&&j(n.prototype,e),r}(),v,_=(v=new WeakMap,function(r,n){n.value&&(v.has(r)&&!function(e){return!(d(e.value)&&e.value===e.oldValue||Array.isArray(e.value)&&JSON.stringify(e.value)===JSON.stringify(e.oldValue)||e.value&&e.value.mask&&e.oldValue&&e.oldValue.mask&&e.value.mask===e.oldValue.mask)}(n)||v.set(r,new O(r,function(e){var t={};return e.mask?(t.mask=Array.isArray(e.mask)?JSON.stringify(e.mask):e.mask,t.tokens=e.tokens?m({},e.tokens):{},t.preprocessor=e.preprocessor):t.mask=Array.isArray(e)?JSON.stringify(e):e,t}(n.value))))});function P(r){r.directive("maska",_)}function I(r,n){return new O(r,n)}typeof window<"u"&&window.Vue&&window.Vue.use&&window.Vue.use(P);export{I as create,P as default,P as install,h as mask,_ as maska,b as tokens};
