import O from"./Modal.c438763c.js";import U from"./OptionsLayout.de073cbf.js";import{v as C,A as T,G,B as K,V as b,S as l,R as g,$ as k,P as w,L as R,K as f,M as _,O as m,Y as r,bc as X,x as y,X as d}from"./moment.e1708d83.js";import"./Form.f0f6e66a.js";import"./UploadBannersInput.8b6faeb2.js";const Y=r(" \u0411\u0430\u043D\u0435\u0440\u0430 "),q={key:1},z=r(" \u0414\u043E\u0434\u0430\u0442\u0438 "),H=["onClick"],J=["src","alt"],Q=_("hr",{class:"my-1"},null,-1),W=["onClick"],ie={__name:"Index",setup(Z){const u=y("$swal"),s=y("$can"),h=C({title:{ua:null,ru:null},image_mobile:{ua:null,ru:null},image_table:{ua:null,ru:null},image_desktop:{ua:null,ru:null},link:{ua:null,ru:null},published:0}),x=y("$defaultLang"),e=T({data:[],currentPage:1,isLoading:!0,isActiveModal:!1,modalAction:"",item:h,activeLang:x});G(()=>{p(1)});const A=K(()=>e.value.isActiveModal?O:null),$=C([{label:"ID",key:"id"},{label:"\u0424\u043E\u0442\u043E",key:"image"},{label:"\u041D\u0430\u0437\u0432\u0430",key:"title"},{label:"\u0421\u0442\u0430\u0442\u0443\u0441",key:"published"},{label:"\u041F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F",key:"link"},{label:"\u041E\u043D\u043E\u0432\u043B\u0435\u043D\u043E<hr class='my-1'>\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043E",key:"timestamps"},{label:"#",key:"actions"}]);function M(a){e.value.activeLang=a}function p(a){e.value.isLoading=!0,a&&(e.value.currentPage=a),axios.get(route("api.banners.index",{page:e.value.currentPage})).then(n=>{Object.assign(e.value.data,n.data.result),e.value.isLoading=!1}).catch(n=>{console.log(n),e.value.isLoading=!1})}function L(a){s("destroy-banners")&&u({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(n=>{n.isConfirmed&&axios.delete(route("api.banners.destroy",a)).then(()=>{p(),e.value.isActiveModal&&c(),u({icon:"success",title:"Destroyed!"})}).catch(o=>{console.log(o),u({icon:"error",title:"Error!"})})})}function c(){e.value.isActiveModal=!e.value.isActiveModal}function D(a,n){s("edit-banners")&&axios.get(route("api.banners.edit",a)).then(({data:o})=>{e.value.item=o.result,e.value.modalAction="edit",e.value.item.index=n,c()}).catch(o=>console.log(o))}function V(){s("edit-banners")&&axios.put(route("api.banners.update",e.value.item.id),e.value.item).then(()=>{c(),p(),u({title:"Success!",icon:"success"})}).catch(a=>{console.log(a),u({title:"Error!",icon:"error"})})}function F(){s("create-banners")&&axios.post(route("api.banners.create"),e.value.item).then(()=>{c(),e.value.item=h,p(),u({title:"Success!",icon:"success"})}).catch(a=>{console.log(a),u({title:"Error!",icon:"error"})})}function S(){e.value.modalAction==="edit"&&s("edit-banners")?V():e.value.modalAction==="create"&&s("create-banners")&&F()}function B(){s("create-banners")&&(Object.assign(e.value.item,h),e.value.modalAction="create",c())}function P(a,n,o){let v=new FormData;v.append("type",n),v.append("banner",a),axios.post(route("api.banners.upload"),v,{headers:{"Content-Type":"multipart/form-data"}}).then(({data:i})=>{n==="mobile"&&(o==="ru"&&(e.value.item.image_mobile.ru=i.result),o==="ua"&&(e.value.item.image_mobile.ua=i.result)),n==="table"&&(o==="ru"&&(e.value.item.image_table.ru=i.result),o==="ua"&&(e.value.item.image_table.ua=i.result)),n==="desktop"&&(o==="ru"&&(e.value.item.image_desktop.ru=i.result),o==="ua"&&(e.value.item.image_desktop.ua=i.result))}).catch(i=>console.log(i))}return(a,n)=>{const o=d("loader-component"),v=d("button-component"),i=d("lang-tabs"),j=d("xcircle-component"),E=d("table-component"),I=d("pagination");return g(),b(U,{title:"\u0411\u0430\u043D\u0435\u0440\u0430"},{header:l(()=>[Y]),default:l(()=>[e.value.isLoading?(g(),b(o,{key:0})):k("",!0),!e.value.isLoading&&w(s)("show-banners")?(g(),R("div",q,[w(s)("create-banners")?(g(),b(v,{key:0,type:"btn",onClick:B},{default:l(()=>[z]),_:1})):k("",!0),f(i,{onClickLang:M}),f(E,{headings:$,isSlotMode:!0,rows:e.value.data.data},{id:l(({data:t})=>[_("a",{href:"javascript:",onClick:N=>D(t.row.id,t.i)},m(t.row.id),9,H)]),image:l(({data:t})=>[_("img",{src:e.value.activeLang==="ua"?a.route("images.banners.mobile",t.row.image_mobile.ua):e.value.activeLang==="ru"?a.route("images.banners.mobile",t.row.image_mobile.ru):null,alt:e.value.activeLang==="ua"?t.row.title.ua:e.value.activeLang==="ru"?t.row.title.ru:null,class:"mx-auto"},null,8,J)]),title:l(({data:t})=>[r(m(e.value.activeLang==="ua"?t.row.title.ua:e.value.activeLang==="ru"?t.row.title.ru:null),1)]),published:l(({data:t})=>[r(m(a.$filters.publishedStatus(t.row.published)),1)]),link:l(({data:t})=>[r(m(e.value.activeLang==="ua"?t.row.link.ua:e.value.activeLang==="ru"?t.row.link.ru:null),1)]),timestamps:l(({data:t})=>[r(m(a.$filters.dateFormat(t.row.updated_at))+" ",1),Q,r(" "+m(a.$filters.dateFormat(t.row.created_at)),1)]),actions:l(({data:t})=>[_("a",{href:"javascript:",onClick:N=>L(t.row.id)},[f(j)],8,W)]),_:1},8,["headings","rows"]),f(I,{pagination:e.value.data,"click-handler":p,modelValue:e.value.currentPage,"onUpdate:modelValue":n[0]||(n[0]=t=>e.value.currentPage=t)},null,8,["pagination","modelValue"]),(g(),b(X(w(A)),{item:e.value.item,onCloseModal:c,onSubmitForm:S,onDeclineForm:L,onOnUploadImage:P},null,40,["item"]))])):k("",!0)]),_:1})}}};export{ie as default};
