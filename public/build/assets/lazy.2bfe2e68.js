import{$ as C,g as E}from"./create-element-if-not-defined.26147364.js";function M({swiper:a,extendParams:b,on:g,emit:x}){b({lazy:{checkInView:!1,enabled:!1,loadPrevNext:!1,loadPrevNextAmount:1,loadOnTransitionStart:!1,scrollingElement:"",elementClass:"swiper-lazy",loadingClass:"swiper-lazy-loading",loadedClass:"swiper-lazy-loaded",preloaderClass:"swiper-lazy-preloader"}}),a.lazy={};let I=!1,v=!1;function m(d,r=!0){const l=a.params.lazy;if(typeof d>"u"||a.slides.length===0)return;const s=a.virtual&&a.params.virtual.enabled?a.$wrapperEl.children(`.${a.params.slideClass}[data-swiper-slide-index="${d}"]`):a.slides.eq(d),n=s.find(`.${l.elementClass}:not(.${l.loadedClass}):not(.${l.loadingClass})`);s.hasClass(l.elementClass)&&!s.hasClass(l.loadedClass)&&!s.hasClass(l.loadingClass)&&n.push(s[0]),n.length!==0&&n.each(u=>{const t=C(u);t.addClass(l.loadingClass);const h=t.attr("data-background"),e=t.attr("data-src"),i=t.attr("data-srcset"),f=t.attr("data-sizes"),p=t.parent("picture");a.loadImage(t[0],e||h,i,f,!1,()=>{if(!(typeof a>"u"||a===null||!a||a&&!a.params||a.destroyed)){if(h?(t.css("background-image",`url("${h}")`),t.removeAttr("data-background")):(i&&(t.attr("srcset",i),t.removeAttr("data-srcset")),f&&(t.attr("sizes",f),t.removeAttr("data-sizes")),p.length&&p.children("source").each(o=>{const z=C(o);z.attr("data-srcset")&&(z.attr("srcset",z.attr("data-srcset")),z.removeAttr("data-srcset"))}),e&&(t.attr("src",e),t.removeAttr("data-src"))),t.addClass(l.loadedClass).removeClass(l.loadingClass),s.find(`.${l.preloaderClass}`).remove(),a.params.loop&&r){const o=s.attr("data-swiper-slide-index");if(s.hasClass(a.params.slideDuplicateClass)){const z=a.$wrapperEl.children(`[data-swiper-slide-index="${o}"]:not(.${a.params.slideDuplicateClass})`);m(z.index(),!1)}else{const z=a.$wrapperEl.children(`.${a.params.slideDuplicateClass}[data-swiper-slide-index="${o}"]`);m(z.index(),!1)}}x("lazyImageReady",s[0],t[0]),a.params.autoHeight&&a.updateAutoHeight()}}),x("lazyImageLoad",s[0],t[0])})}function y(){const{$wrapperEl:d,params:r,slides:l,activeIndex:c}=a,s=a.virtual&&r.virtual.enabled,n=r.lazy;let u=r.slidesPerView;u==="auto"&&(u=0);function t(e){if(s){if(d.children(`.${r.slideClass}[data-swiper-slide-index="${e}"]`).length)return!0}else if(l[e])return!0;return!1}function h(e){return s?C(e).attr("data-swiper-slide-index"):C(e).index()}if(v||(v=!0),a.params.watchSlidesProgress)d.children(`.${r.slideVisibleClass}`).each(e=>{const i=s?C(e).attr("data-swiper-slide-index"):C(e).index();m(i)});else if(u>1)for(let e=c;e<c+u;e+=1)t(e)&&m(e);else m(c);if(n.loadPrevNext)if(u>1||n.loadPrevNextAmount&&n.loadPrevNextAmount>1){const e=n.loadPrevNextAmount,i=Math.ceil(u),f=Math.min(c+i+Math.max(e,i),l.length),p=Math.max(c-Math.max(i,e),0);for(let o=c+i;o<f;o+=1)t(o)&&m(o);for(let o=p;o<c;o+=1)t(o)&&m(o)}else{const e=d.children(`.${r.slideNextClass}`);e.length>0&&m(h(e));const i=d.children(`.${r.slidePrevClass}`);i.length>0&&m(h(i))}}function $(){const d=E();if(!a||a.destroyed)return;const r=a.params.lazy.scrollingElement?C(a.params.lazy.scrollingElement):C(d),l=r[0]===d,c=l?d.innerWidth:r[0].offsetWidth,s=l?d.innerHeight:r[0].offsetHeight,n=a.$el.offset(),{rtlTranslate:u}=a;let t=!1;u&&(n.left-=a.$el[0].scrollLeft);const h=[[n.left,n.top],[n.left+a.width,n.top],[n.left,n.top+a.height],[n.left+a.width,n.top+a.height]];for(let i=0;i<h.length;i+=1){const f=h[i];if(f[0]>=0&&f[0]<=c&&f[1]>=0&&f[1]<=s){if(f[0]===0&&f[1]===0)continue;t=!0}}const e=a.touchEvents.start==="touchstart"&&a.support.passiveListener&&a.params.passiveListeners?{passive:!0,capture:!1}:!1;t?(y(),r.off("scroll",$,e)):I||(I=!0,r.on("scroll",$,e))}g("beforeInit",()=>{a.params.lazy.enabled&&a.params.preloadImages&&(a.params.preloadImages=!1)}),g("init",()=>{a.params.lazy.enabled&&(a.params.lazy.checkInView?$():y())}),g("scroll",()=>{a.params.freeMode&&a.params.freeMode.enabled&&!a.params.freeMode.sticky&&y()}),g("scrollbarDragMove resize _freeModeNoMomentumRelease",()=>{a.params.lazy.enabled&&(a.params.lazy.checkInView?$():y())}),g("transitionStart",()=>{a.params.lazy.enabled&&(a.params.lazy.loadOnTransitionStart||!a.params.lazy.loadOnTransitionStart&&!v)&&(a.params.lazy.checkInView?$():y())}),g("transitionEnd",()=>{a.params.lazy.enabled&&!a.params.lazy.loadOnTransitionStart&&(a.params.lazy.checkInView?$():y())}),g("slideChange",()=>{const{lazy:d,cssMode:r,watchSlidesProgress:l,touchReleaseOnEdges:c,resistanceRatio:s}=a.params;d.enabled&&(r||l&&(c||s===0))&&y()}),g("destroy",()=>{!a.$el||a.$el.find(`.${a.params.lazy.loadingClass}`).removeClass(a.params.lazy.loadingClass)}),Object.assign(a.lazy,{load:y,loadInSlide:m})}export{M as L};
