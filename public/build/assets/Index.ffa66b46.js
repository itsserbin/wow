import j from"./Modal.6491b171.js";import z from"./Table.6ae2d493.js";import"./app.7df5b4e5.js";import{y as h,z as k,G,W as p,U as v,Y as r,S as n,a0 as y,P as L,L as E,M as g,K as f,F as K,V as T,Z as C,O as W,be as Y,D as A}from"./moment.325cf309.js";import"./Form.325defdd.js";import"./ItemsModal.ff619ef7.js";import"./ItemsForm.ef7ad969.js";import"./ItemsTable.1e27adde.js";import"./ClientOrders.99d80344.js";const Z=C(" \u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F "),q={key:1},H={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},J={class:"md:col-span-1"},Q={class:"w-full md:col-span-4 grid gap-4 grid-cols-1"},R={class:"text-center"},de={__name:"Index",props:["statuses","payment_methods"],setup(M){const _=M,e=h({orders:[],currentPage:1,isLoading:!0,isActiveEditModal:!1,sidebarActive:"all",orderModal:{}}),u=h([]),i=A("$swal"),c=A("$can"),a=h({status:null,currentPage:1}),P=k(()=>{const t={};return t.page=a.value.currentPage,a.value.status&&(t.status=a.value.status),t});G(()=>{l(),u.value.push({title:"\u0412\u0441\u0456 \u0437\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F",key:"all"});for(const[t,o]of Object.entries(_.statuses))u.value.push({title:o,key:t});route().params.id&&(e.value.isLoading=!0,b(route().params.id))});const S=k(()=>e.value.isActiveEditModal?j:null);function V(t){c("edit-orders")&&(axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal),axios.get(route("api.orders.edit",t.order_id)).then(({data:o})=>e.value.orderModal=o.result).catch(o=>console.log(o)))}function w(t){e.value.sidebarActive=t,t==="all"?a.value.status=null:a.value.status=t,l()}function F(t){t&&(a.value.currentPage=t),l()}function B(t){axios.get(route("api.orders.search",t)).then(({data:o})=>{e.value.sidebarActive=null,a.value.currentPage=1,e.value.orders=o.result,e.value.isLoading=!1}).catch(o=>{console.log(o),e.value.isLoading=!1})}function l(){axios.get(route("api.orders.index",P.value)).then(({data:t})=>{e.value.orders=t.result,e.value.isLoading=!1}).catch(t=>{console.log(t),e.value.isLoading=!1})}function x(t){c("destroy-orders")&&i({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(o=>{o.isConfirmed&&axios.delete(route("api.orders.destroy",t)).then(()=>{e.value.isLoading=!1,l(),e.value.isActiveEditModal&&m(),i({title:"Success!",icon:"success"})}).catch(s=>{console.log(s),i({title:"Error!",icon:"error"})})})}function b(t,o){axios.get(route("api.orders.edit",t)).then(({data:s})=>{e.value.orderModal.index=o,e.value.orderModal=s.result,m(),e.value.isLoading=!1}).catch(s=>console.log(s))}function D(){c("edit-orders")&&axios.put(route("api.orders.update",e.value.orderModal.id),e.value.orderModal).then(()=>{m(),l(),i({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),i({title:"Error!",icon:"error"})})}function m(){e.value.isActiveEditModal=!e.value.isActiveEditModal}return(t,o)=>{const s=r("loader-component"),$=r("sidebar-item"),N=r("sidebar-component"),O=r("search-component"),I=r("pagination"),U=r("auth-layout");return n(),p(U,{title:"\u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F"},{header:v(()=>[Z]),default:v(()=>[e.value.isLoading?(n(),p(s,{key:0})):y("",!0),!e.value.isLoading&&L(c)("show-orders")?(n(),E("div",q,[g("div",H,[g("div",J,[f(N,null,{default:v(()=>[u.value.length?(n(!0),E(K,{key:0},T(u.value,d=>(n(),p($,{onClick:X=>w(d.key),active:e.value.sidebarActive===d.key},{default:v(()=>[C(W(d.title),1)]),_:2},1032,["onClick","active"]))),256)):y("",!0)]),_:1})]),g("div",Q,[f(O,{onSearch:B,clear:!0,placeholder:"\u0406\u043C\u02BC\u044F, \u043F\u0440\u0456\u0437\u0432\u0438\u0449\u0435, \u0442\u0435\u043B\u0435\u0444\u043E\u043D, \u043D\u0430\u043A\u043B\u0430\u0434\u043A\u0430, \u043A\u043E\u043C\u0435\u043D\u0442\u0430\u0440..."}),f(z,{data:e.value.orders.data,onOnEdit:b,onOnDestroy:x,statuses:M.statuses},null,8,["data","statuses"]),g("div",R,[f(I,{pagination:e.value.orders,"click-handler":F,modelValue:e.value.currentPage,"onUpdate:modelValue":o[0]||(o[0]=d=>e.value.currentPage=d)},null,8,["pagination","modelValue"])])])]),(n(),p(Y(L(S)),{order:e.value.orderModal,statuses:_.statuses,paymentMethods:_.payment_methods,size:"extralarge",onCloseModal:m,onDeclineForm:x,onSubmitForm:D,onSubmitItemForm:V},null,40,["order","statuses","paymentMethods"]))])):y("",!0)]),_:1})}}};export{de as default};
