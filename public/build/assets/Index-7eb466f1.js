import{l as p,m as y,p as n,P as k,O as h,s as j,a0 as B,t as P,v as b,a1 as R,y as m,n as l,A as z,F,ae,R as ne,k as le,g as re,o as ce,z as de,x as d,w,q as me,_ as ue}from"./index-a01126e2.js";import{s as g,a as pe,b as $}from"./column.esm-ad632756.js";import{s as E}from"./basecomponent.esm-bc6743c9.js";import{s as fe}from"./index.esm-73720709.js";import{p as ge}from"./app-741b04df.js";import{s as he}from"./dialog.esm-14660000.js";import{_ as ye}from"./Label-20131f4c.js";import be from"./StatisticLayout-af991e7b.js";import ve from"./Form-e8ffa6ad.js";import{a as Ce}from"./dropdown.esm-067e1b29.js";import{i as L,u as _e}from"./useConfirm-315b1e48.js";import{i as S}from"./isDark-c828c264.js";import"./focustrap.esm-94bc3b5f.js";import"./moment-fbc5633a.js";import"./AuthenticatedLayout-704e8f94.js";import"./index.esm-02fff71f.js";import"./Logo-83ffc10f.js";import"./SidebarItem-446a46b0.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./vue-datepicker-3bdc29fb.js";import"./index-2cbe9ca3.js";var V={name:"Toolbar",extends:E,props:{"aria-labelledby":{type:String,default:null}}};const ke=["aria-labelledby"];function we(o,r,u,f,c,s){return p(),y("div",h({class:"p-toolbar p-component",role:"toolbar","aria-labelledby":o.ariaLabelledby},o.ptm("root")),[n("div",h({class:"p-toolbar-group-start p-toolbar-group-left"},o.ptm("start")),[k(o.$slots,"start")],16),n("div",h({class:"p-toolbar-group-center"},o.ptm("center")),[k(o.$slots,"center")],16),n("div",h({class:"p-toolbar-group-end p-toolbar-group-right"},o.ptm("end")),[k(o.$slots,"end")],16)],16,ke)}function Le(o,r){r===void 0&&(r={});var u=r.insertAt;if(!(!o||typeof document>"u")){var f=document.head||document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",u==="top"&&f.firstChild?f.insertBefore(c,f.firstChild):f.appendChild(c),c.styleSheet?c.styleSheet.cssText=o:c.appendChild(document.createTextNode(o))}}var Se=`
.p-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
}
.p-toolbar-group-start,
.p-toolbar-group-center,
.p-toolbar-group-end {
    display: flex;
    align-items: center;
}
.p-toolbar-group-left,
.p-toolbar-group-right {
    display: flex;
    align-items: center;
}
`;Le(Se);V.render=we;var K={name:"Chip",extends:E,emits:["remove"],props:{label:{type:String,default:null},icon:{type:String,default:null},image:{type:String,default:null},removable:{type:Boolean,default:!1},removeIcon:{type:String,default:void 0}},data(){return{visible:!0}},methods:{onKeydown(o){(o.key==="Enter"||o.key==="Backspace")&&this.close(o)},close(o){this.visible=!1,this.$emit("remove",o)}},computed:{containerClass(){return["p-chip p-component",{"p-chip-image":this.image!=null}]}},components:{TimesCircleIcon:fe}};const je=["aria-label"],Me=["src"];function $e(o,r,u,f,c,s){return c.visible?(p(),y("div",h({key:0,class:s.containerClass,"aria-label":u.label},o.ptm("root")),[k(o.$slots,"default",{},()=>[u.image?(p(),y("img",h({key:0,src:u.image},o.ptm("image")),null,16,Me)):o.$slots.icon?(p(),j(B(o.$slots.icon),h({key:1,class:"p-chip-icon"},o.ptm("icon")),null,16)):u.icon?(p(),y("span",h({key:2,class:["p-chip-icon",u.icon]},o.ptm("icon")),null,16)):P("",!0),u.label?(p(),y("div",h({key:3,class:"p-chip-text"},o.ptm("label")),b(u.label),17)):P("",!0)]),u.removable?k(o.$slots,"removeicon",{key:0,onClick:s.close,onKeydown:s.onKeydown},()=>[(p(),j(B(u.removeIcon?"span":"TimesCircleIcon"),h({tabindex:"0",class:["p-chip-remove-icon",u.removeIcon],onClick:s.close,onKeydown:s.onKeydown},o.ptm("removeIcon")),null,16,["class","onClick","onKeydown"]))]):P("",!0)],16,je)):P("",!0)}function Pe(o,r){r===void 0&&(r={});var u=r.insertAt;if(!(!o||typeof document>"u")){var f=document.head||document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",u==="top"&&f.firstChild?f.insertBefore(c,f.firstChild):f.appendChild(c),c.styleSheet?c.styleSheet.cssText=o:c.appendChild(document.createTextNode(o))}}var xe=`
.p-chip {
    display: inline-flex;
    align-items: center;
}
.p-chip-text {
    line-height: 1.5;
}
.p-chip-icon.pi {
    line-height: 1.5;
}
.p-chip-remove-icon {
    line-height: 1.5;
    cursor: pointer;
}
.p-chip img {
    border-radius: 50%;
}
`;Pe(xe);K.render=$e;var D=ge(),H={name:"ConfirmDialog",extends:E,props:{group:String,breakpoints:{type:Object,default:null},draggable:{type:Boolean,default:!0}},confirmListener:null,closeListener:null,data(){return{visible:!1,confirmation:null}},mounted(){this.confirmListener=o=>{o&&o.group===this.group&&(this.confirmation=o,this.confirmation.onShow&&this.confirmation.onShow(),this.visible=!0)},this.closeListener=()=>{this.visible=!1,this.confirmation=null},D.on("confirm",this.confirmListener),D.on("close",this.closeListener)},beforeUnmount(){D.off("confirm",this.confirmListener),D.off("close",this.closeListener)},methods:{accept(){this.confirmation.accept&&this.confirmation.accept(),this.visible=!1},reject(){this.confirmation.reject&&this.confirmation.reject(),this.visible=!1},onHide(){this.confirmation.onHide&&this.confirmation.onHide(),this.visible=!1}},computed:{header(){return this.confirmation?this.confirmation.header:null},message(){return this.confirmation?this.confirmation.message:null},blockScroll(){return this.confirmation?this.confirmation.blockScroll:!0},position(){return this.confirmation?this.confirmation.position:null},iconClass(){return["p-confirm-dialog-icon",this.confirmation?this.confirmation.icon:null]},acceptLabel(){return this.confirmation?this.confirmation.acceptLabel||this.$primevue.config.locale.accept:null},rejectLabel(){return this.confirmation?this.confirmation.rejectLabel||this.$primevue.config.locale.reject:null},acceptIcon(){return this.confirmation?this.confirmation.acceptIcon:null},rejectIcon(){return this.confirmation?this.confirmation.rejectIcon:null},acceptClass(){return["p-confirm-dialog-accept",this.confirmation?this.confirmation.acceptClass:null]},rejectClass(){return["p-confirm-dialog-reject",this.confirmation?this.confirmation.rejectClass||"p-button-text":null]},autoFocusAccept(){return this.confirmation.defaultFocus===void 0||this.confirmation.defaultFocus==="accept"},autoFocusReject(){return this.confirmation.defaultFocus==="reject"},closeOnEscape(){return this.confirmation?this.confirmation.closeOnEscape:!0}},components:{CDialog:he,CDButton:g}};function De(o,r,u,f,c,s){const e=R("CDButton"),A=R("CDialog");return p(),j(A,{visible:c.visible,"onUpdate:visible":[r[2]||(r[2]=v=>c.visible=v),s.onHide],role:"alertdialog",class:"p-confirm-dialog",modal:!0,header:s.header,blockScroll:s.blockScroll,position:s.position,breakpoints:u.breakpoints,closeOnEscape:s.closeOnEscape,draggable:u.draggable,pt:o.pt},{footer:m(()=>[l(e,{label:s.rejectLabel,class:z(s.rejectClass),iconPos:"left",onClick:r[0]||(r[0]=v=>s.reject()),autofocus:s.autoFocusReject,pt:o.ptm("rejectButton")},{icon:m(v=>[k(o.$slots,"rejecticon",{},()=>[n("span",h({class:[s.rejectIcon,v.class]},o.ptm("rejectButton").icon),null,16)])]),_:3},8,["label","class","autofocus","pt"]),l(e,{label:s.acceptLabel,class:z(s.acceptClass),iconPos:"left",onClick:r[1]||(r[1]=v=>s.accept()),autofocus:s.autoFocusAccept,pt:o.ptm("acceptButton")},{icon:m(v=>[k(o.$slots,"accepticon",{},()=>[n("span",h({class:[s.acceptIcon,v.class]},o.ptm("acceptButton").icon),null,16)])]),_:3},8,["label","class","autofocus","pt"])]),default:m(()=>[o.$slots.message?(p(),j(B(o.$slots.message),{key:1,message:c.confirmation},null,8,["message"])):(p(),y(F,{key:0},[k(o.$slots,"icon",{class:"p-confirm-dialog-icon"},()=>[o.$slots.icon?(p(),j(B(o.$slots.icon),{key:0,class:"p-confirm-dialog-icon"})):c.confirmation.icon?(p(),y("span",h({key:1,class:s.iconClass},o.ptm("icon")),null,16)):P("",!0)]),n("span",h({class:"p-confirm-dialog-message"},o.ptm("message")),b(s.message),17)],64))]),_:3},8,["visible","header","blockScroll","position","breakpoints","closeOnEscape","draggable","onUpdate:visible","pt"])}H.render=De;const Be={class:"grid grid-cols-1 gap-4"},Ae={class:"flex gap-4 justify-center flex-col md:flex-row"},Ie={class:"p-4"},Fe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ee={class:"grid grid-cols-1 md:grid-cols-3 gap-2"},Oe={class:"flex flex-col p-4"},Te={class:"bg-primary border-circle w-2rem h-2rem flex align-items-center justify-content-center"},Ne={class:"ml-2 font-medium"},Re={class:"grid grid-cols-1"},ze={class:"grid grid-cols-1 md:grid-cols-9 gap-4"},Ve={class:"md:col-span-4 flex items-end"},Ke={class:"block w-full"},He={class:"md:col-span-4 flex items-end"},Ue={class:"block w-full"},qe={class:"md:col-span-1 flex items-end"},Je={class:"block w-full"},Ye=n("br",null,null,-1),Ge={class:"text-[0.7rem]"},Qe={key:0},We={key:0},Xe={key:1},Ze=n("br",null,null,-1),et={key:1},tt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ot={class:"flex items-center"},st={class:"flex justify-end"},it={class:"grid gap-y-4"},at={class:"block"},Mt={__name:"Index",setup(o){const{t:r}=ae(),u=ne(()=>ue(()=>import("./useConfirm-315b1e48.js").then(t=>t.M),["assets/useConfirm-315b1e48.js","assets/index-a01126e2.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/column.esm-ad632756.js","assets/app-741b04df.js","assets/moment-fbc5633a.js","assets/dropdown.esm-067e1b29.js","assets/basecomponent.esm-bc6743c9.js","assets/focustrap.esm-94bc3b5f.js"])),f=()=>{const t=new Date,a=t.getFullYear(),i=(t.getMonth()+1).toString().padStart(2,"0"),_=t.getDate().toString().padStart(2,"0"),oe=t.getHours().toString().padStart(2,"0"),se=t.getMinutes().toString().padStart(2,"0"),ie=t.getSeconds().toString().padStart(2,"0");return`${a}-${i}-${_} ${oe}:${se}:${ie}`},c={type:null,sum:null,date:null,category_id:null,comment:null},s=le({date:null,page:0,first:0,rows:15,sortField:null,sortOrder:null}),e=re({data:[],indicators:[],categories:[],isLoading:!1,isCategoriseModal:!1,isLoadingAddProfit:!1,isLoadingAddCost:!1,isLoadingCategoriesModal:!1,isLoadingModal:!1,showModal:!1,item:{id:null,category_id:null},file:null});ce(async()=>{await C()});const A=async(t,a,i)=>{try{await axios[t](a,i),await C(),M(),L.success(r(`swal.${t==="put"?"updated":"created"}`),{autoClose:3e3,theme:S?"dark":"light"})}catch(_){console.error(_),L.error(r("swal.error"),{autoClose:3e3,theme:S?"dark":"light"})}},v=async()=>{e.isLoadingModal=!0,e.item.category_id!==null&&typeof e.item.category_id=="object"&&(e.item.category_id=e.item.category_id.code);const t=e.item.id?route("api.statistics.bank-card-movements.update",e.item.id):route("api.statistics.bank-card-movements.create"),a=e.item.id?"put":"post";await A(a,t,e.item),e.isLoadingModal=!1},O=async t=>{e.isLoadingAddProfit=t===1,e.isLoadingAddCost=t===0,await I(t),e.item=JSON.parse(JSON.stringify(c)),e.item.type=t===0?0:1,e.item.date=f(),M()},U=async t=>{await axios.get(route("api.statistics.bank-card-movements.edit",t)).then(async({data:a})=>{await I(a.result.sum<0?0:1),e.item=a.result,e.isLoading=!1}).catch(a=>console.log(a)),M()},I=async t=>{try{const{data:a}=await axios.get(route("api.statistics.costs.categories.list"),{params:{type:t}});a.success&&(e.categories=a.result.map(i=>({code:i.id,name:i.title})))}catch(a){console.error(a),L.error(r("swal.error"),{autoClose:3e3,theme:S?"dark":"light"})}},M=()=>{e.showModal=!e.showModal,e.isLoadingAddProfit=!1,e.isLoadingAddCost=!1},q=()=>{document.location.href=route("admin.export.bank-card-movements")},x=()=>{e.isCategoriseModal=!e.isCategoriseModal},J=async()=>{try{e.isLoadingCategoriesModal=!0,e.item.category_id!==null&&typeof e.item.category_id=="object"&&(e.item.category_id=e.item.category_id.code);const{data:t}=await axios.post(route("api.statistics.bank-card-movements.category.update"),e.item);t.success&&(e.item={id:null,category_id:null},x(),await C(),L.success(r("swal.updated"),{autoClose:3e3,theme:S?"dark":"light"})),e.isLoadingCategoriesModal=!1}catch(t){e.isLoadingCategoriesModal=!1,console.error(t),L.error(r("swal.error"),{autoClose:3e3,theme:S?"dark":"light"})}},T=t=>{I(t.sum<0?0:1),x(),e.item.id=t.id},N=de(()=>{let t={};return s.value.sortField&&(t.sort=s.value.sortField,s.value.sortOrder===1?t.param="asc":s.value.sortOrder===-1&&(t.param="desc")),{perPage:s.value.rows||15,sort:t.sort&&t.param?t.sort:null,param:t.sort&&t.param?t.param:null,page:(s.value.page||0)+1,get:s.value.get||null}}),C=async()=>{e.isLoading=!0,await axios.get(route("api.statistics.bank-card-movements.index",N.value)).then(({data:t})=>{e.data=t.result.data,e.indicators=t.result.indicators}).catch(t=>console.log(t)),e.isLoading=!1},Y=async t=>{s.value=t,await C()},G=async t=>{s.value=t,await C()},Q=t=>{switch(t){case"balance":return"Баланс";case"profits":return"Надходження";case"costs":return"Витрати"}},W=async()=>{N.date={startDate:null,endDate:null},s.value.page=0,s.value.get="",await C()},X=async()=>{s.value.get="profits",s.value.page=0,await C()},Z=async()=>{s.value.get="costs",s.value.page=0,await C()},ee=t=>{e.isLoading=!0,U(t.data.id)},te=async t=>{await _e({message:r("swal.confirm_destroy"),header:r("swal.confirm_action"),icon:"pi pi-exclamation-triangle",accept:async()=>{try{const{data:a}=await axios.delete(route("api.statistics.bank-card-movements.destroy",t));a.success&&(await C(),L.success(r("swal.destroyed"),{autoClose:3e3,theme:S?"dark":"light"}))}catch(a){console.error(a),L.error(r("swal.error"),{autoClose:3e3,theme:S?"dark":"light"})}}})};return(t,a)=>(p(),y(F,null,[l(be,null,{header:m(()=>[w(" Рухи по картці ")]),default:m(()=>[n("div",Be,[l(d(V),{class:"mb-4"},{center:m(()=>[n("div",Ae,[l(d(g),{icon:"pi pi-plus",type:"button",onClick:a[0]||(a[0]=i=>O(1)),label:"Додати прибуток",loading:e.isLoadingAddProfit},null,8,["loading"]),l(d(g),{icon:"pi pi-minus",severity:"danger",type:"button",onClick:a[1]||(a[1]=i=>O(0)),label:"Додати витрату",loading:e.isLoadingAddCost},null,8,["loading"])])]),_:1}),l(d(pe),{resizableColumns:"",columnResizeMode:"expand",selectionMode:"single",onRowSelect:ee,ref:"dt",dataKey:"date",loading:e.isLoading,value:e.data.data,class:"p-datatable bank-card-movements-table",lazy:"",paginator:"",rows:e.data.per_page,totalRecords:e.data.total,onPage:a[2]||(a[2]=i=>Y(i)),onSort:a[3]||(a[3]=i=>G(i)),rowsPerPageOptions:[15,50,100,500],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},{header:m(()=>[n("div",Ie,[n("div",Fe,[n("div",Ee,[(p(!0),y(F,null,me(e.indicators,(i,_)=>(p(),j(d(K),{class:"pl-0 pr-3"},{default:m(()=>[n("div",Oe,[n("span",Te,b(Q(_)),1),n("span",Ne,b(t.$filters.formatMoney(i)),1)])]),_:2},1024))),256))]),n("div",Re,[n("div",ze,[n("div",Ve,[n("div",Ke,[l(d(g),{severity:"secondary",type:"button",onClick:X,class:"w-full justify-center",label:"Надходження"})])]),n("div",He,[n("div",Ue,[l(d(g),{severity:"secondary",type:"button",onClick:Z,class:"w-full justify-center",label:"Витрати"})])]),n("div",qe,[n("div",Je,[l(d(g),{icon:"pi pi-refresh",type:"button",onClick:W,class:"w-full justify-center"})])])])])])])]),footer:m(()=>[n("div",tt,[n("div",ot," Показано з "+b(e.data.from)+" по "+b(e.data.to)+" із "+b(e.data.total)+" записів ",1),n("div",st,[l(d(g),{icon:"pi pi-file-export",iconPos:"right",type:"button",label:"Експортувати",onClick:q})])])]),default:m(()=>[l(d($),{sortable:"",field:"date",header:"Дата"},{body:m(({data:i})=>[w(b(t.$filters.dateFormat(i.date))+" ",1),Ye,n("span",Ge,b(t.$filters.timeFormat(i.date)),1)]),_:1}),l(d($),{field:"category_id",header:"Категорія"},{body:m(({data:i})=>[i.category_id?(p(),y("div",Qe,[i.category?(p(),y("div",We,b(i.category.title),1)):(p(),y("div",Xe,[w(" Категорія видалена "),Ze,l(d(g),{text:"",rounded:"",type:"button",onClick:_=>T(i)},{default:m(()=>[w(" Обрати нову ")]),_:2},1032,["onClick"])]))])):(p(),y("div",et,[l(d(g),{text:"",rounded:"",type:"button",onClick:_=>T(i)},{default:m(()=>[w(" Обрати ")]),_:2},1032,["onClick"])]))]),_:1}),l(d($),{sortable:"",field:"sum",header:"Сума"},{body:m(({data:i})=>[w(b(t.$filters.formatMoney(i.sum)),1)]),_:1}),l(d($),{sortable:"",field:"comment",header:"Коментар",style:{width:"20px"}},{body:m(({data:i})=>[w(b(i.comment&&i.comment.length>30?i.comment.slice(0,30)+"...":i.comment),1)]),_:1}),l(d($),{field:"actions",header:""},{body:m(({data:i})=>[l(d(g),{text:"",rounded:"",icon:"pi pi-trash",type:"button",onClick:_=>te(i.id)},null,8,["onClick"])]),_:1})]),_:1},8,["loading","value","rows","totalRecords"])])]),_:1}),l(d(u),{show:e.isCategoriseModal,onClose:x},{body:m(()=>[n("div",it,[n("div",at,[l(ye,{value:"Оберіть категорію"}),l(d(Ce),{modelValue:e.item.category_id,"onUpdate:modelValue":a[4]||(a[4]=i=>e.item.category_id=i),showClear:"",options:e.categories,optionLabel:"name",placeholder:"Оберіть категорію",class:"w-full"},null,8,["modelValue","options"])])])]),footer:m(()=>[l(d(g),{label:"Скасувати",icon:"pi pi-times",onClick:x,text:""}),l(d(g),{label:"Зберегти",icon:"pi pi-check",onClick:J,autofocus:"",loading:e.isLoadingCategoriesModal},null,8,["loading"])]),_:1},8,["show"]),l(d(u),{show:e.showModal,onClose:M},{head:m(()=>[]),body:m(()=>[l(ve,{item:e.item,categories:e.categories},null,8,["item","categories"])]),footer:m(()=>[l(d(g),{label:"Скасувати",icon:"pi pi-times",onClick:M,text:""}),l(d(g),{label:"Зберегти",icon:"pi pi-check",onClick:v,autofocus:"",loading:e.isLoadingModal},null,8,["loading"])]),_:1},8,["show"]),l(d(H))],64))}};export{Mt as default};
