import j from"./Modal.7beafef8.js";import z from"./Table.0b0221c5.js";import{az as U,y as h,z as x,G,a0 as m,W as v,$ as d,S as u,Z as y,P as f,L as A,M as g,K as k,F as I,Y as K,X as M,O as T,bg as W,D as C}from"./___vite-browser-external_commonjs-proxy.bd54111c.js";import"./Form.aab2acf8.js";const X=M("Support"),Y={key:1},Z={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},q={class:"md:col-span-1"},H={class:"w-full md:col-span-4 grid gap-4 grid-cols-1"},J={class:"text-center"},oe={__name:"Index",props:["statuses"],setup(_){const L=_,n=C("$swal"),o=C("$can");U({name:null,phone:null,comment:null,status:null});const e=h({data:[],isLoading:!0,isActiveModal:!1,modalAction:"",item:{},sidebarActive:"all"}),p=h([]),s=h({status:null,currentPage:1}),P=x(()=>{const t={};return t.page=s.value.currentPage,s.value.status&&(t.status=s.value.status),t});G(()=>{l(1),p.value.push({title:"\u0412\u0441\u0456",key:"all"});for(const[t,a]of Object.entries(L.statuses))p.value.push({title:a,key:t})});const S=x(()=>e.value.isActiveModal?j:null);function w(t){e.value.sidebarActive=t,t==="all"?s.value.status=null:s.value.status=t,s.value.currentPage=1,l()}function l(t){e.value.isLoading=!0,t&&(e.value.currentPage=t),axios.get(route("api.supports.index",P.value)).then(({data:a})=>{e.value.data=a.result,e.value.isLoading=!1}).catch(a=>{console.log(a),e.value.isLoading=!1})}function b(t){o("destroy-callbacks")&&n({title:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438?",icon:"warning",showCancelButton:!0}).then(a=>{a.isConfirmed&&axios.delete(route("api.supports.destroy",t)).then(()=>{l(),e.value.isActiveModal&&c(),n({icon:"success",title:"Destroyed!"})}).catch(i=>{console.log(i),n({icon:"error",title:"Error!"})})})}function c(){e.value.isActiveModal=!e.value.isActiveModal}function D(t,a){o("edit-supports")&&axios.get(route("api.supports.edit",t)).then(({data:i})=>{e.value.item=i.result,e.value.modalAction="edit",e.value.item.index=a,c()}).catch(i=>console.log(i))}function V(){o("edit-supports")&&axios.put(route("api.supports.update",e.value.item.id),e.value.item).then(()=>{c(),l(),n({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),n({title:"Error!",icon:"error"})})}function B(){o("create-supports")&&axios.post(route("api.supports.create"),e.value.item).then(({data:t})=>{c(),e.value.item={},l(),n({title:"Success!",icon:"success"})}).catch(t=>{console.log(t),n({title:"Error!",icon:"error"})})}function E(){e.value.modalAction==="edit"&&o("edit-supports")?V():e.value.modalAction==="create"&&o("create-supports")&&B()}return(t,a)=>{const i=d("loader-component"),F=d("sidebar-item"),$=d("sidebar-component"),N=d("pagination"),O=d("auth-layout");return u(),m(O,{title:"Support"},{header:v(()=>[X]),default:v(()=>[e.value.isLoading?(u(),m(i,{key:0})):y("",!0),!e.value.isLoading&&f(o)("show-supports")?(u(),A("div",Y,[g("div",Z,[g("div",q,[k($,null,{default:v(()=>[p.value.length?(u(!0),A(I,{key:0},K(p.value,r=>(u(),m(F,{onClick:Q=>w(r.key),active:e.value.sidebarActive===r.key},{default:v(()=>[M(T(r.title),1)]),_:2},1032,["onClick","active"]))),256)):y("",!0)]),_:1})]),g("div",H,[k(z,{data:e.value.data.data,statuses:_.statuses,onOnEdit:D,onOnDestroy:b,"can-destroy":f(o)("destroy-supports")},null,8,["data","statuses","can-destroy"]),g("div",J,[k(N,{pagination:e.value.data,"click-handler":l,modelValue:s.value.currentPage,"onUpdate:modelValue":a[0]||(a[0]=r=>s.value.currentPage=r)},null,8,["pagination","modelValue"])])])]),(u(),m(W(f(S)),{item:e.value.item,onCloseModal:c,onSubmitForm:E,onDeclineForm:b,statuses:_.statuses,"can-destroy":f(o)("destroy-supports")},null,40,["item","statuses","can-destroy"]))])):y("",!0)]),_:1})}}};export{oe as default};
